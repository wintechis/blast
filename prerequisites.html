<!DOCTYPE html>
<html lang="en" xml:lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BLAST - Prerequisites</title>
    <style>
        code {
        padding: .2em .4em;
        margin: 0;
        font-size: 85%;
        background-color: var(--color-neutral-muted);
        border-radius: 6px;
        }
        table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        }

        td, th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
        }

        tr:nth-child(even) {
        background-color: #dddddd;
        }
    </style>
</head>
<body>
    <h1>Your platform is not fully supported.</h1>
    Please use Google Chrome on Windows 10,
    <br>
    and enable experimental web platform features.
    <br>
    To do so, go to <code>chrome://flags/#enable-experimental-web-platform-features</code> and click enable.
    <br>
    <br>
    <a href="index.html?skipCheck=true">Click here to continue anyway.</a>
    <br>
    <br>
    Below is a list of the missing prerequisites:
    <br>
    <br>
    <table>
        <thead>
            <tr>
                <th>Feature</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="prerequisites">
        </tbody>
    </table>
    <script>
        // fill prerequisites table with url parameters
        const tBody = document.getElementById('prerequisites');
        const isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);
        const isWindows = navigator.platform.toLowerCase().indexOf('win') >= 0;
        const isAndroid = navigator.userAgent.toLowerCase().indexOf('android') >= 0;
        const supportsWebBluetooth = 'bluetooth' in navigator;
        const platform = new Map();
        platform.set('using Google Chrome', isChrome);
        platform.set('on Windows or Android', isWindows || isAndroid);
        platform.set('experimental web platform features enabled', supportsWebBluetooth);

        if(isChrome && (isWindows || isAndroid) && supportsWebBluetooth) {
            // redirect to index.html
            window.location.href = 'index.html';
        }
            
        for (const [key, value] of platform) {
            if (value) {
                const tr = document.createElement('tr');
                const tdFeature = document.createElement('td');
                const tdStatus = document.createElement('td');
                tdFeature.innerText = key;
                tdStatus.innerText = value === true ? '✅' : '❌';
                tr.appendChild(tdFeature);
                tr.appendChild(tdStatus);
                tBody.appendChild(tr);
            }
        }


    </script>
</body>