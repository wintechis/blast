/*
 https://www.gnu.org/licenses/agpl-3.0.de.html AGPLv3
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var h=a[d];if(!(h in c))return;c=c[h]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var h=a.split(".");a=1===h.length;d=h[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<h.length-1;g++){var m=h[g];if(!(m in d))return;d=d[m]}h=h[h.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[h]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,h,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[h]&&($jscomp.propertyToPolyfillSymbol[h]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(h):
$jscomp.POLYFILL_PREFIX+h),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[h],{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(h,g){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(h){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(h||"")+"_"+c++,h)};return d},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.getConstructImplementation=function(){function a(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(c,d,h){c=b(c,d);h&&Reflect.setPrototypeOf(c,h.prototype);return c}}return function(c,d,h){void 0===h&&(h=c);h=$jscomp.objectCreate(h.prototype||Object.prototype);return Function.prototype.apply.call(c,h,d)||
h}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(c){return{value:c,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var h=d.value}catch(g){return this.context_.yieldAllIterator_=null,this.context_.throw_(g),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,h);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,h){function g(m){m.done?d(m.value):Promise.resolve(m.value).then(b,c).then(g,h)}g(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(c,d){try{return b(c,d),!0}catch(h){return!1}}}return null},"es6","es5");
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(m){return m instanceof h?m:new h(function(p,l){p(m)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(m){if(null==this.batch_){this.batch_=[];var p=this;this.asyncExecuteFunction(function(){p.executeBatch_()})}this.batch_.push(m)};
var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(m){d(m,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var m=this.batch_;this.batch_=[];for(var p=0;p<m.length;++p){var l=m[p];m[p]=null;try{l()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};b.prototype.asyncThrow_=function(m){this.asyncExecuteFunction(function(){throw m;})};var h=function(m){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var p=this.createResolveAndReject_();
try{m(p.resolve,p.reject)}catch(l){p.reject(l)}};h.prototype.createResolveAndReject_=function(){function m(n){return function(q){l||(l=!0,n.call(p,q))}}var p=this,l=!1;return{resolve:m(this.resolveTo_),reject:m(this.reject_)}};h.prototype.resolveTo_=function(m){if(m===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(m instanceof h)this.settleSameAsPromise_(m);else{a:switch(typeof m){case "object":var p=null!=m;break a;case "function":p=!0;break a;default:p=!1}p?this.resolveToNonPromiseObj_(m):
this.fulfill_(m)}};h.prototype.resolveToNonPromiseObj_=function(m){var p=void 0;try{p=m.then}catch(l){this.reject_(l);return}"function"==typeof p?this.settleSameAsThenable_(p,m):this.fulfill_(m)};h.prototype.reject_=function(m){this.settle_(2,m)};h.prototype.fulfill_=function(m){this.settle_(1,m)};h.prototype.settle_=function(m,p){if(0!=this.state_)throw Error("Cannot settle("+m+", "+p+"): Promise already settled in state"+this.state_);this.state_=m;this.result_=p;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};h.prototype.scheduleUnhandledRejectionCheck_=function(){var m=this;d(function(){if(m.notifyUnhandledRejection_()){var p=$jscomp.global.console;"undefined"!==typeof p&&p.error(m.result_)}},1)};h.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var m=$jscomp.global.CustomEvent,p=$jscomp.global.Event,l=$jscomp.global.dispatchEvent;if("undefined"===typeof l)return!0;"function"===typeof m?m=new m("unhandledrejection",{cancelable:!0}):
"function"===typeof p?m=new p("unhandledrejection",{cancelable:!0}):(m=$jscomp.global.document.createEvent("CustomEvent"),m.initCustomEvent("unhandledrejection",!1,!0,m));m.promise=this;m.reason=this.result_;return l(m)};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var m=0;m<this.onSettledCallbacks_.length;++m)g.asyncExecute(this.onSettledCallbacks_[m]);this.onSettledCallbacks_=null}};var g=new b;h.prototype.settleSameAsPromise_=function(m){var p=this.createResolveAndReject_();
m.callWhenSettled_(p.resolve,p.reject)};h.prototype.settleSameAsThenable_=function(m,p){var l=this.createResolveAndReject_();try{m.call(p,l.resolve,l.reject)}catch(n){l.reject(n)}};h.prototype.then=function(m,p){function l(w,z){return"function"==typeof w?function(C){try{n(w(C))}catch(D){q(D)}}:z}var n,q,t=new h(function(w,z){n=w;q=z});this.callWhenSettled_(l(m,n),l(p,q));return t};h.prototype.catch=function(m){return this.then(void 0,m)};h.prototype.callWhenSettled_=function(m,p){function l(){switch(n.state_){case 1:m(n.result_);
break;case 2:p(n.result_);break;default:throw Error("Unexpected state: "+n.state_);}}var n=this;null==this.onSettledCallbacks_?g.asyncExecute(l):this.onSettledCallbacks_.push(l);this.isRejectionHandled_=!0};h.resolve=c;h.reject=function(m){return new h(function(p,l){l(m)})};h.race=function(m){return new h(function(p,l){for(var n=$jscomp.makeIterator(m),q=n.next();!q.done;q=n.next())c(q.value).callWhenSettled_(p,l)})};h.all=function(m){var p=$jscomp.makeIterator(m),l=p.next();return l.done?c([]):new h(function(n,
q){function t(C){return function(D){w[C]=D;z--;0==z&&n(w)}}var w=[],z=0;do w.push(void 0),z++,c(l.value).callWhenSettled_(t(w.length-1),q),l=p.next();while(!l.done)})};return h},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,h){return c==a&&"q"==d&&h==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var n=Object.seal({}),q=Object.seal({}),t=new a([[n,2],[q,3]]);if(2!=t.get(n)||3!=t.get(q))return!1;t.delete(n);t.set(q,4);return!t.has(n)&&4==t.get(q)}catch(w){return!1}}function c(){}function d(n){var q=typeof n;return"object"===q&&null!==n||"function"===q}function h(n){if(!$jscomp.owns(n,m)){var q=new c;$jscomp.defineProperty(n,m,{value:q})}}function g(n){if(!$jscomp.ISOLATE_POLYFILLS){var q=Object[n];q&&(Object[n]=
function(t){if(t instanceof c)return t;Object.isExtensible(t)&&h(t);return q(t)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var m="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var p=0,l=function(n){this.id_=(p+=Math.random()+1).toString();if(n){n=$jscomp.makeIterator(n);for(var q;!(q=n.next()).done;)q=q.value,this.set(q[0],q[1])}};l.prototype.set=function(n,q){if(!d(n))throw Error("Invalid WeakMap key");
h(n);if(!$jscomp.owns(n,m))throw Error("WeakMap key fail: "+n);n[m][this.id_]=q;return this};l.prototype.get=function(n){return d(n)&&$jscomp.owns(n,m)?n[m][this.id_]:void 0};l.prototype.has=function(n){return d(n)&&$jscomp.owns(n,m)&&$jscomp.owns(n[m],this.id_)};l.prototype.delete=function(n){return d(n)&&$jscomp.owns(n,m)&&$jscomp.owns(n[m],this.id_)?delete n[m][this.id_]:!1};return l},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var l=Object.seal({x:4}),n=new a($jscomp.makeIterator([[l,"s"]]));if("s"!=n.get(l)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var q=n.entries(),t=q.next();if(t.done||t.value[0]!=l||"s"!=t.value[1])return!1;t=q.next();return t.done||4!=t.value[0].x||"t"!=t.value[1]||!q.next().done?!1:!0}catch(w){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var c=new WeakMap,d=function(l){this.data_={};this.head_=m();this.size=0;if(l){l=$jscomp.makeIterator(l);for(var n;!(n=l.next()).done;)n=n.value,this.set(n[0],n[1])}};d.prototype.set=function(l,n){l=0===l?0:l;var q=h(this,l);q.list||(q.list=this.data_[q.id]=[]);q.entry?q.entry.value=n:(q.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:l,value:n},q.list.push(q.entry),
this.head_.previous.next=q.entry,this.head_.previous=q.entry,this.size++);return this};d.prototype.delete=function(l){l=h(this,l);return l.entry&&l.list?(l.list.splice(l.index,1),l.list.length||delete this.data_[l.id],l.entry.previous.next=l.entry.next,l.entry.next.previous=l.entry.previous,l.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=m();this.size=0};d.prototype.has=function(l){return!!h(this,l).entry};d.prototype.get=function(l){return(l=
h(this,l).entry)&&l.value};d.prototype.entries=function(){return g(this,function(l){return[l.key,l.value]})};d.prototype.keys=function(){return g(this,function(l){return l.key})};d.prototype.values=function(){return g(this,function(l){return l.value})};d.prototype.forEach=function(l,n){for(var q=this.entries(),t;!(t=q.next()).done;)t=t.value,l.call(n,t[1],t[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var h=function(l,n){var q=n&&typeof n;"object"==q||"function"==q?c.has(n)?q=c.get(n):
(q=""+ ++p,c.set(n,q)):q="p_"+n;var t=l.data_[q];if(t&&$jscomp.owns(l.data_,q))for(l=0;l<t.length;l++){var w=t[l];if(n!==n&&w.key!==w.key||n===w.key)return{id:q,list:t,index:l,entry:w}}return{id:q,list:t,index:-1,entry:void 0}},g=function(l,n){var q=l.head_;return $jscomp.iteratorPrototype(function(){if(q){for(;q.head!=l.head_;)q=q.previous;for(;q.next!=q.head;)return q=q.next,{done:!1,value:n(q)};q=null}return{done:!0,value:void 0}})},m=function(){var l={};return l.previous=l.next=l.head=l},p=0;
return d},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var h=d.length;c=c||0;for(0>c&&(c=Math.max(c+h,0));c<h;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,h=0;h<d;h++){var g=a[h];if(b.call(c,g,h,a))return{i:h,v:g}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,h={next:function(){if(!d&&c<a.length){var g=c++;return{value:b(g,a[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).i}},"es6","es3");$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}},"es6","es3");
$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(c,b-d.length)+d}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(b,c,d){var h=this.length||0;0>c&&(c=Math.max(0,h+c));if(null==d||d>h)d=h;d=Number(d);0>d&&(d=Math.max(0,h+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(b){return"number"===typeof b&&isNaN(b)}},"es6","es3");$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var h in d)$jscomp.owns(d,h)&&(a[h]=d[h])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(b,c,d){c=null!=c?c:function(p){return p};var h=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof g){b=g.call(b);for(var m=0;!(g=b.next()).done;)h.push(c.call(d,g.value,m++))}else for(g=b.length,m=0;m<g;m++)h.push(c.call(d,b[m],m));return h}},"es6","es3");var Blast={States:{}};Blast.States.Interpreter=null;Blast.States.runner_=null;Blast.States.latestCode="";Blast.States.eventCode=new Map;
Blast.States.eventValues=new Map;Blast.States.eventChecker=function(a,b){var c=Blast.States.eventValues.get(a);Blast.States.eventValues.set(a,b);return void 0!=c?!c&&b:!1};Blast.States.addEventCode=function(a,b){Blast.States.eventCode.set(a,b)};Blast.States.removeEventCode=function(a){Blast.States.eventCode.delete(a)};
Blast.States.generateCode=function(){for(var a="while (true) {\n \n}",b=Blast.workspace.getBlocksByType("event",!1).map(function(g){return g.id}),c=$jscomp.makeIterator(Blast.States.eventCode),d=c.next();!d.done;d=c.next()){var h=$jscomp.makeIterator(d.value);d=h.next().value;h=h.next().value;b.includes(d)&&(a=a.slice(0,-2)+h+"\n"+a.slice(-1))}Blast.States.latestCode=Blockly.JavaScript.finish(a)};
Blast.States.startEventChecker=function(){Blast.States.Interpreter=null;Blast.States.Interpreter=new Interpreter("");Blast.States.Interpreter.stateStack[0].scope=Blast.Interpreter.globalScope;Blast.States.Interpreter.appendCode(Blast.States.latestCode);Blast.States.runner_=function(){if(Blast.States.Interpreter)try{Blast.States.Interpreter.step(),setTimeout(Blast.States.runner_,5)}catch(a){Blockly.alert("Error executing program:\n%e".replace("%e",a)),Blast.setStatus(Blast.status.ERROR),Blast.resetInterpreter(),
console.error(a)}};Blast.States.runner_()};Blast.States.allStates=function(a){return a.getBlocksByType("state_definition",!1).map(function(b){return b.getStateDef()[0]})};Blast.States.findLegalName=function(a,b){if(b.isInFlyout)return a;for(a=a||Blockly.Msg.UNNAMED_KEY||"unnamed";!Blast.States.isLegalName_(a,b.workspace,b);){var c=a.match(/^(.*?)(\d+)$/);a=c?c[1]+(parseInt(c[2],10)+1):a+"2"}return a};Blast.States.isLegalName_=function(a,b,c){return!Blast.States.isNameUsed(a,b,c)};
Blast.States.isNameUsed=function(a,b,c){b=b.getAllBlocks(!1);b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())if(d=d.value,d!=c&&d.getStateDef&&(d=d.getStateDef()[0],Blockly.Names.equals(d,a)))return!0;return!1};
Blast.States.rename=function(a){a=a.trim();var b=Blast.States.findLegalName(a,this.getSourceBlock()),c=this.getValue();if(c!=a&&c!=b){a=this.getSourceBlock().workspace.getAllBlocks(!1);a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,d.renameState&&d.renameState(c,b)}return b};
Blast.States.flyoutCategory=function(a){var b=[];if(Blockly.Blocks.state_definition){var c=Blockly.utils.xml.createElement("block");c.setAttribute("type","state_definition");c.setAttribute("gap",16);var d=Blockly.utils.xml.createElement("field");d.setAttribute("name","NAME");d.appendChild(Blockly.utils.xml.createTextNode("state name"));c.appendChild(d);b.push(c)}b.length&&b[b.length-1].setAttribute("gap",24);a=Blast.States.allStates(a);0==a.length&&(c=Blockly.utils.xml.createElement("block"),c.setAttribute("type",
"event"),c.setAttribute("gap",16),c.setAttribute("disabled",!0),d=Blockly.utils.xml.createElement("mutation"),d.setAttribute("name","state name"),c.appendChild(d),b.push(c));a=$jscomp.makeIterator(a);for(c=a.next();!c.done;c=a.next()){c=c.value;d=Blockly.utils.xml.createElement("block");d.setAttribute("type","event");d.setAttribute("gap",16);var h=Blockly.utils.xml.createElement("mutation");h.setAttribute("name",c);d.appendChild(h);b.push(d)}if(a=Blast.Toolbox.getCategory("States and Events"))for(a=
$jscomp.makeIterator(a.contents),c=a.next();!c.done;c=a.next())c=c.value,d=Blockly.utils.xml.createElement("block"),d.setAttribute("type",c.type),d.setAttribute("gap",16),b.push(d);return b};Blast.States.getEvents=function(a,b){var c=[];b=b.getAllBlocks(!1);b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())if(d=d.value,d.getStateName){var h=d.getStateName();h&&Blockly.Names.equals(h,a)&&c.push(d)}return c};
Blast.States.getDefinition=function(a,b){b=b.getTopBlocks(!1);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,c.getStateDef){var d=c.getStateDef()[0];if(d&&Blockly.Names.equals(d,a))return c}return null};Blast.Ui={};Blast.Ui.TABS_=["workspace","javascript","xml"];Blast.Ui.selected_="workspace";Blast.Ui.playIcon_='<span class="icon material-icons">play_arrow</span>';Blast.Ui.stopIcon_='<span class="icon material-icons">stop</span>';Blast.Ui.messageCounter_=0;Blast.Ui.messageOutputContainer=null;Blast.Ui.statusContainer=null;Blast.Ui.uriInput=null;Blast.Ui.runButton=null;
Blast.Ui.addElementToOutputContainer=function(a){100<Blast.Ui.messageCounter_&&Blast.Ui.messageOutputContainer.firstChild.remove();Blast.Ui.messageOutputContainer.appendChild(a,Blast.Ui.messageOutputContainer.firstChild);Blast.Ui.messageOutputContainer.scrollTop=Blast.Ui.messageOutputContainer.scrollHeight};
Blast.Ui.addMessage=function(a,b){var c="media/logo-512x512.png";window.location.href.includes("mobile")&&(c="../"+c);document.hasFocus()||navigator.serviceWorker.ready.then(function(h){h.showNotification("Blast",{body:a,icon:c,vibrate:[200,100,200,100,200,100,200]})});var d=document.createElement("div");d.classList.add("message");b&&d.classList.add(b+"-message");d.id="message-"+Blast.Ui.messageCounter_++;b=document.createTextNode(a);d.appendChild(b);b=document.createElement("span");b.classList.add("time");
b.innerHTML=(new Date).toLocaleTimeString();d.appendChild(b);Blast.Ui.addElementToOutputContainer(d)};
Blast.Ui.tabClick_=function(a){for(var b=$jscomp.makeIterator(Blast.Ui.TABS_),c=b.next();!c.done;c=b.next()){c=c.value;var d=document.getElementById("tab_"+c);d.classList.add("taboff");d.classList.remove("tabon");document.getElementById("content_"+c).style.visibility="hidden"}Blast.Ui.selected_=a;b=document.getElementById("tab_"+a);b.classList.remove("taboff");b.classList.add("tabon");document.getElementById("content_"+a).style.visibility="visible";Blockly.svgResize(Blast.workspace)};
Blast.Ui.renderContent_=function(){var a=document.getElementById("content_xml"),b=Blockly.Xml.workspaceToDom(Blast.workspace);b=Blockly.Xml.domToPrettyText(b);a.value=b;a.focus();a=document.getElementById("content_javascript");a.textContent=Blast.latestCode.replace(/highlightBlock\('.*'\);\n/gm,"");a.className=a.className.replace("prettyprinted","");"object"==typeof PR&&PR.prettyPrint()};
Blast.Ui.setStatus=function(a){if(a===Blast.status.RUNNING){var b=Blast.stopJS;var c=Blast.Ui.stopIcon_;var d="Stop the execution"}else b=Blast.runJS,c=Blast.Ui.playIcon_,d="Run block program";Blast.Ui.runButton.onclick=b;Blast.Ui.runButton.title=d;Blast.Ui.runButton.innerHTML=c;Blast.Ui.statusContainer.innerHTML=a};
Blast.Ui.init=function(){Blast.Ui.uriInput=document.getElementById("loadWorkspace-input");Blast.Ui.runButton=document.getElementById("runButton");Blast.Ui.messageOutputContainer=document.getElementById("msgOutputContainer");Blast.Ui.statusContainer=document.getElementById("statusContainer");if(!window.location.href.includes("mobile")){Blast.Ui.tabClick_(Blast.Ui.selected_);for(var a=$jscomp.makeIterator(Blast.Ui.TABS_),b=a.next();!b.done;b=a.next())b=b.value,Blast.bindClick("tab_"+b,function(c){return function(){Blast.Ui.tabClick_(c)}}(b));
Blast.bindClick("UriLoadButton",Blast.Storage.load);Blast.bindClick("UriSaveButton",Blast.Storage.link);Blast.bindClick("saveButton",function(){Blast.Storage.link(!0)});Blast.Ui.uriInput.addEventListener("keyup",function(c){13===c.keyCode&&Blast.Storage.load()})}};Blast.Toolbox={};
var defaultToolbox={kind:"categoryToolbox",contents:[{kind:"CATEGORY",contents:[],name:"Things and Resources",custom:"THINGS",colour:"60"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[],name:"Properties",colour:"255"},{kind:"CATEGORY",contents:[],name:"Actions",colour:"0"},{kind:"CATEGORY",contents:[],name:"States and Events",custom:"STATES",colour:"180"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[],name:"Requests and Queries",colour:"0"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[{kind:"BLOCK",
type:"while_until"},{kind:"BLOCK",type:"break_continue"},{kind:"BLOCK",type:"conditional_statement"}],name:"Control Flow",colour:"120"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"logic_compare"},{kind:"BLOCK",type:"logic_operation"},{kind:"BLOCK",type:"logic_negate"}],name:"Boolean Expressions",colour:"210"},{kind:"CATEGORY",contents:[],name:"Functions",colour:"290",custom:"PROCEDURE"},{kind:"CATEGORY",contents:[],name:"Variables",custom:"VARIABLE",colour:"330"},{kind:"sep",gap:"32"},{kind:"CATEGORY",
contents:[{kind:"BLOCK",type:"string"},{kind:"BLOCK",type:"string_join"},{kind:"BLOCK",type:"string_length"},{kind:"BLOCK",type:"string_indexOf"},{kind:"BLOCK",type:"string_charAt"},{kind:"BLOCK",type:"string_getSubstring"},{kind:"BLOCK",type:"string_changeCase"},{kind:"BLOCK",type:"string_replace"},{kind:"BLOCK",type:"string_showPrompt"}],name:"Strings",colour:"160"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"number_value"},{kind:"BLOCK",type:"number_infinity"},{kind:"BLOCK",type:"number_arithmetic"},
{kind:"BLOCK",type:"number_modulo"},{kind:"BLOCK",type:"number_random"}],name:"Numbers",colour:"230"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"logic_boolean"}],name:"Booleans",colour:"210"}]};Blast.Toolbox.currentToolbox=defaultToolbox;Blast.Toolbox.init=function(){Blast.workspace.registerToolboxCategoryCallback("STATES",Blast.States.flyoutCategory);Blast.workspace.registerToolboxCategoryCallback("THINGS",Blast.Things.flyoutCategory)};
Blast.Toolbox.getCategory=function(a){return Blast.Toolbox.currentToolbox.contents.find(function(b){return b.name?b.name.toLowerCase()===a.toLowerCase():!1})};Blast.Toolbox.addBlock=function(a,b,c){a={kind:"BLOCK",type:a,blockxml:c};(b=Blast.Toolbox.getCategory(b))&&b.contents.push(a)};Blast.config={};Blast.workspace=null;Blast.highlightPause=!1;Blast.apiFunctions=[];Blast.asyncApiFunctions=[];Blast.latestCode="";Blast.Interpreter=null;Blast.Interrupted=!1;Blast.eventInWorkspace=[];Blast.deviceEventHandlers=[];Blast.cleanUpFunctions=[];Blast.runner_=null;Blast.status={READY:"ready",RUNNING:"running",STOPPED:"stopped",ERROR:"error"};Blast.bindClick=function(a,b){"string"==typeof a&&(a=document.getElementById(a));a.addEventListener("click",b,!0);a.addEventListener("touchend",b,!0)};
Blast.importPrettify=function(){var a=document.createElement("script");a.setAttribute("src","https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js");document.head.appendChild(a)};Blast.getBBox_=function(a){var b=a.offsetHeight,c=a.offsetWidth,d=0,h=0;do d+=a.offsetLeft,h+=a.offsetTop,a=a.offsetParent;while(a);return{height:b,width:c,x:d,y:h}};
Blast.init=function(){if(!window.location.href.includes("mobile")){var a=function(){for(var b=$jscomp.makeIterator(Blast.Ui.TABS_),c=b.next();!c.done;c=b.next())c=document.getElementById("content_"+c.value),c.style.top="35px",c.style.left="0px",c.style.height=window.innerHeight-35+"px",c.style.width=window.innerWidth-450+"px";Blast.workspace&&Blast.workspace.getToolbox().width&&(document.getElementById("tab_workspace").style.minWidth=Blast.workspace.getToolbox().width-38+"px")};window.addEventListener("resize",
a,!1);Blast.workspace=Blockly.inject("content_workspace",{media:"media/",toolbox:Blast.Toolbox.currentToolbox,zoom:{controls:!0,wheel:!0}});Blast.Toolbox.init();a();Blockly.svgResize(Blast.workspace);Blast.Ui.init();Blast.Ui.setStatus(Blast.status.READY);Blast.generateCode();Blast.workspace.addChangeListener(function(b){b instanceof Blockly.Events.Ui||(Blast.generateCode(),Blast.States.generateCode(),Blast.Ui.renderContent_())});Blast.Ui.addMessage("Actionblock output will be displayed here","info");
window.setTimeout(Blast.importPrettify,1)}};Blast.highlightBlock=function(a){Blast.workspace.highlightBlock(a);Blast.highlightPause=!0};Blast.resetUi=function(a){Blast.workspace.highlightBlock(null);Blast.highlightPause=!1;Blast.Ui.setStatus(a)};Blast.generateCode=function(){Blockly.JavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n";Blockly.JavaScript.addReservedWords("highlightBlock");Blast.latestCode="";Blast.latestCode=Blockly.JavaScript.workspaceToCode(Blast.workspace)};
Blast.resetInterpreter=function(){Blast.Interpreter=null;Blast.runner_&&(clearTimeout(Blast.runner_),Blast.runner_=null);Blast.Bluetooth.tearDown();Blast.removeDeviceHandlers();for(var a=$jscomp.makeIterator(Blast.cleanUpFunctions),b=a.next();!b.done;b=a.next())b=b.value,b()};Blast.removeDeviceHandlers=function(){for(var a=$jscomp.makeIterator(Blast.deviceEventHandlers),b=a.next();!b.done;b=a.next())b=b.value,b.device.removeEventListener(b.type,b.fn);Blast.deviceEventHandlers=[]};
Blast.runJS=function(){Blast.resetUi(Blast.status.RUNNING);Blast.Ui.addMessage("execution started","info");null==Blast.Interpreter&&(Blast.highlightPause=!1,Blast.Interpreter=new Interpreter(Blast.latestCode,initApi),Blast.runner_=function(){if(Blast.Interpreter)try{Blast.Interrupted?setTimeout(Blast.runner_,5):Blast.Interpreter.step()?setTimeout(Blast.runner_,5):Blast.States.Interpreter||0<Blast.eventInWorkspace.length||(Blast.resetUi(Blast.status.READY),Blast.Ui.addMessage("execution completed",
"info"),Blast.resetInterpreter())}catch(a){Blast.throwError(a),Blast.Ui.setStatus(Blast.status.ERROR),Blast.resetInterpreter(),console.error(a)}},Blast.runner_())};Blast.stopJS=function(){Blast.resetInterpreter();Blast.States.Interpreter&&(clearTimeout(Blast.States.runner_),Blast.States.runner_=null);Blast.resetUi(Blast.status.STOPPED)};
Blast.throwError=function(a){a||(a="Error executing program - See console for details.");Blast.Ui.addMessage(a,"error");Blast.Ui.setStatus(Blast.status.ERROR);Blast.resetInterpreter();Blast.Ui.addMessage("Execution stopped","info")};Blast.handleFetchErrors=function(a,b){a.ok||(b?Blast.throwError(b):Blast.throwError("Error processing HTTP Request."));return a};window.addEventListener("load",Blast.init);Blast.Storage={};Blast.Storage.HTTPREQUEST_ERROR="There was a problem with the request.\n";Blast.Storage.LINK_ALERT="Load your blocks with this link:\n\n%1";Blast.Storage.NOT_FOUND_ERROR='Sorry, couldn\'t find "%1".';Blast.Storage.XML_ERROR="Could not load your saved file.\nPerhaps it was created with a different version of Blast?";Blast.Storage.filename="BLAST.xml";
Blast.Storage.link=function(a){var b=Blast.workspace,c=Blockly.Xml.workspaceToDom(b,!0);1==b.getTopBlocks(!1).length&&c.querySelector&&(b=c.querySelector("block"))&&(b.removeAttribute("x"),b.removeAttribute("y"));c=Blast.Storage.removeDeviceId_(c);c=Blockly.Xml.domToPrettyText(c);!0===a?(c=new Blob([c],{type:"text/xml"}),saveAs(c,Blast.Storage.filename)):((a=document.getElementById("loadWorkspace-input").value)&&0!=a.length||(a="storage/"+Blast.Storage.generatePath()),c=Blockly.Xml.domToText(c),Blast.Storage.saveXML_(a,
c))};
Blast.Storage.removeDeviceId_=function(a){var b=a.querySelectorAll("block");b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next()){c=c.value;var d=c.getAttribute("type");if("things_webBluetooth"==d||"things_webHID"==d)if(c=c.firstElementChild){var h=c.textContent,g="things_webBluetooth"==d?Blast.Things.getWebBluetoothDevices():Blast.Things.getWebHIDDevices();d=void 0;g=$jscomp.makeIterator(g);for(var m=g.next();!m.done;m=g.next()){m=$jscomp.makeIterator(m.value);var p=m.next().value;if(m.next().value===
h){d=p;break}}c.textContent=d}}return a};Blast.Storage.saveXML_=function(a,b){Blockly.hideChaff();fetch(a,{method:"PUT",body:b}).then(function(c){c.ok?(location.hash=a,Blockly.alert(Blast.Storage.LINK_ALERT.replace("%1",window.location.href))):Blast.throwError(Blast.Storage.HTTPREQUEST_ERROR)})};
Blast.Storage.load=function(){var a=document.getElementById("loadWorkspace-input").value;if(""==a)Blockly.alert("Enter a URI first.");else{var b=a.split("/").pop();-1<b.indexOf(".")&&(Blast.Storage.filename=b);Blast.Storage.retrieveXML_(a)}};
Blast.Storage.loadXMLFromFile=function(a){return new Promise(function(b,c){var d=a.target.files[0].name;-1<d.indexOf(".")&&(Blast.Storage.filename=d);d=new FileReader;d.onload=function(h){Blast.Storage.loadXML(h.target.result);b()};d.onerror=function(h){c(h.target.error)};d.readAsText(a.target.files[0])})};Blast.Storage.resetFileInput=function(){var a=document.getElementById("file-selector");a&&(a.value="");Blast.Storage.filename="BLAST.xml"};
Blast.Storage.retrieveXML_=function(a){return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){Blockly.hideChaff();Blast.resetInterpreter();Blast.resetUi(Blast.status.READY);Blast.Things.webHidDevices=new Map;Blast.Things.webHidNames=new Map;Blast.Things.webBluetoothDevices=new Map;Blast.Storage.resetFileInput();fetch(a).then(function(c){if(c.ok)return c.text();Blast.throwError(Blast.Storage.NOT_FOUND_ERROR.replace("%1",a))}).then(Blast.Storage.loadXML);b.jumpToEnd()})};
Blast.Storage.loadXML=function(a){Blast.workspace.clear();try{var b=Blockly.Xml.textToDom(a)}catch(c){Blast.throwError(Blast.Storage.XML_ERROR+"\nXML: "+b);return}b.querySelector('block[type="things_webBluetooth"]')||b.querySelector('block[type="things_webHID"]')?(Blast.Storage.generatePairButtons(b),document.getElementById("rcModal")&&(document.getElementById("rcModal").style.display="block")):(Blockly.Xml.domToWorkspace(b,Blast.workspace),Blast.Storage.monitorChanges_(Blast.workspace))};
Blast.Storage.generatePairButtons=function(a){window.location.href.includes("mobile")?(window.app.openReconnectDialog(),this.generatePairButtonsMobile_(a)):this.generatePairButtonsDesktop_(a)};
Blast.Storage.generatePairButtonsDesktop_=function(a){for(var b=a.querySelectorAll("block"),c=document.getElementById("rc-tbody");c.firstChild;)c.removeChild(c.firstChild);var d=[],h={};b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;h={$jscomp$loop$prop$type$61:h.$jscomp$loop$prop$type$61,$jscomp$loop$prop$name$62:h.$jscomp$loop$prop$name$62,$jscomp$loop$prop$block$63:h.$jscomp$loop$prop$block$63},g=b.next()){h.$jscomp$loop$prop$block$63=g.value;h.$jscomp$loop$prop$type$61=h.$jscomp$loop$prop$block$63.getAttribute("type");
if("things_webBluetooth"==h.$jscomp$loop$prop$type$61||"things_webHID"==h.$jscomp$loop$prop$type$61){h.$jscomp$loop$prop$name$62=h.$jscomp$loop$prop$block$63.firstElementChild.textContent;if(d.includes(h.$jscomp$loop$prop$name$62))continue;g=document.createElement("tr");var m=document.createElement("td");m.appendChild(document.createTextNode(h.$jscomp$loop$prop$name$62));var p=document.createElement("td"),l=document.createElement("input");l.setAttribute("type","button");l.setAttribute("id","pairButton-"+
h.$jscomp$loop$prop$name$62);l.setAttribute("value","Pair");var n=document.createElement("td"),q=document.createElement("span");q.setAttribute("id","pairStatus-"+h.$jscomp$loop$prop$name$62);q.innerHTML="&#x2718;";q.style.color="red";q.style.fontSize="20px";q.style.fontWeight="bold";q.style.marginRight="10px";n.appendChild(q);l.addEventListener("click",function(t){return function(){var w,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(C){if(1==C.nextAddress)return"things_webBluetooth"!=
t.$jscomp$loop$prop$type$61?("things_webHID"==t.$jscomp$loop$prop$type$61&&(w=[],navigator.hid.requestDevice({filters:w}).then(function(D){0===D.length&&Blast.throwError("Connection failed or cancelled by User.");var B=Date.now().toString(36)+Math.random().toString(36).substr(2);Blast.Things.webHidDevices.set(B,D[0]);Blast.Things.addWebHidDevice(B,t.$jscomp$loop$prop$name$62);document.getElementById("pairStatus-"+t.$jscomp$loop$prop$name$62).innerHTML="&#x2714;";document.getElementById("pairStatus-"+
t.$jscomp$loop$prop$name$62).style.color="green";t.$jscomp$loop$prop$block$63.firstElementChild.textContent=B;Blast.Storage.allConnectedDesktop_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").getAttribute("data-hasEvent")||(document.getElementById("rc-done").setAttribute("data-hasEvent",!0),document.getElementById("rc-done").addEventListener("click",function(){return Blast.Storage.reconnectDoneHandler_(a)})))}).catch(function(D){Blast.throwError("Connection failed or cancelled by User.");
console.error(D)})),C.jumpTo(0)):C.yield(Blast.Bluetooth.requestDevice(),3);z=C.yieldResult;document.getElementById("pairStatus-"+t.$jscomp$loop$prop$name$62).innerHTML="&#x2714;";document.getElementById("pairStatus-"+t.$jscomp$loop$prop$name$62).style.color="green";t.$jscomp$loop$prop$block$63.firstElementChild.textContent=z.id;Blast.Storage.allConnectedDesktop_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").getAttribute("data-hasEvent")||(document.getElementById("rc-done").setAttribute("data-hasEvent",
!0),document.getElementById("rc-done").addEventListener("click",function(){return Blast.Storage.reconnectDoneHandler_(a)})));C.jumpToEnd()})}}(h));p.appendChild(l);g.appendChild(m);g.appendChild(p);g.appendChild(n);c.appendChild(g);d.push(h.$jscomp$loop$prop$name$62)}document.getElementById("rc-cancel").addEventListener("click",function(){return Blast.Storage.reconnectCancelHandler_()})}};
Blast.Storage.generatePairButtonsMobile_=function(a){for(var b=a.querySelectorAll("block"),c=document.getElementById("rc-list");c.firstChild;)c.removeChild(c.firstChild);var d=[],h={};b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;h={$jscomp$loop$prop$type$65:h.$jscomp$loop$prop$type$65,$jscomp$loop$prop$name$66:h.$jscomp$loop$prop$name$66,$jscomp$loop$prop$block$67:h.$jscomp$loop$prop$block$67},g=b.next())if(h.$jscomp$loop$prop$block$67=g.value,h.$jscomp$loop$prop$type$65=h.$jscomp$loop$prop$block$67.getAttribute("type"),
"things_webBluetooth"==h.$jscomp$loop$prop$type$65||"things_webHID"==h.$jscomp$loop$prop$type$65)if(h.$jscomp$loop$prop$name$66=h.$jscomp$loop$prop$block$67.firstElementChild.textContent,!d.includes(h.$jscomp$loop$prop$name$66)){g=document.createElement("li");g.setAttribute("id","rc-item-"+h.$jscomp$loop$prop$name$66);g.setAttribute("class","mdc-list-item");var m=document.createElement("span");m.setAttribute("id","rc-icon-"+h.$jscomp$loop$prop$name$66);m.setAttribute("class","mdc-list-item__graphic material-icons");
m.setAttribute("aria-hidden","true");m.innerHTML="things_webBluetooth"==h.$jscomp$loop$prop$type$65?"bluetooth_disabled":"usb_off";g.appendChild(m);m=document.createElement("span");m.setAttribute("class","mdc-list-item__text");var p=document.createElement("span");p.setAttribute("class","mdc-list-item__primary-text");p.innerHTML=h.$jscomp$loop$prop$name$66;m.appendChild(p);p=document.createElement("span");p.setAttribute("class","mdc-list-item__secondary-text");p.setAttribute("id","rc-status-"+h.$jscomp$loop$prop$name$66);
p.innerHTML="disconnected";m.appendChild(p);g.appendChild(m);g.addEventListener("click",function(l){return function(){var n,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){if(1==t.nextAddress)return"things_webBluetooth"!=l.$jscomp$loop$prop$type$65?("things_webHID"==l.$jscomp$loop$prop$type$65&&(n=[],navigator.hid.requestDevice({filters:n}).then(function(w){0===w.length&&Blast.throwError("Connection failed or cancelled by User.");var z=Date.now().toString(36)+Math.random().toString(36).substr(2);
Blast.Things.webHidDevices.set(z,w[0]);Blast.Things.addWebHidDevice(z,l.$jscomp$loop$prop$name$66);document.getElementById("rc-status-"+l.$jscomp$loop$prop$name$66).innerHTML="connected";document.getElementById("rc-icon-"+l.$jscomp$loop$prop$name$66).innerHTML="usb";document.getElementById("rc-icon-"+l.$jscomp$loop$prop$name$66).style.color="#0d30b1";l.$jscomp$loop$prop$block$67.firstElementChild.textContent=z;Blast.Storage.allConnectedDesktop_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").getAttribute("data-hasEvent")||
(document.getElementById("rc-done").setAttribute("data-hasEvent",!0),document.getElementById("rc-done").addEventListener("click",function(){return Blast.Storage.reconnectDoneHandler_(a)})))}).catch(function(w){Blast.throwError("Connection failed or cancelled by User.");console.error(w)})),t.jumpTo(0)):t.yield(Blast.Bluetooth.requestDevice(),3);q=t.yieldResult;Blast.Things.addWebBluetoothDevice(q.id,l.$jscomp$loop$prop$name$66);document.getElementById("rc-status-"+l.$jscomp$loop$prop$name$66).innerHTML=
"connected";document.getElementById("rc-icon-"+l.$jscomp$loop$prop$name$66).innerHTML="bluetooth";document.getElementById("rc-icon-"+l.$jscomp$loop$prop$name$66).style.color="#0d30b1";l.$jscomp$loop$prop$block$67.firstElementChild.textContent=q.id;Blast.Storage.allConnectedMobile_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").getAttribute("data-hasEvent")||(document.getElementById("rc-done").setAttribute("data-hasEvent",!0),document.getElementById("rc-done").addEventListener("click",
function(){return Blast.Storage.reconnectDoneHandler_(a)})));t.jumpToEnd()})}}(h));c.appendChild(g);d.push(h.$jscomp$loop$prop$name$66)}window.app.initLists()};Blast.Storage.allConnectedDesktop_=function(){var a=document.getElementById("rc-tbody").querySelectorAll("tr");a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if("\u2718"==document.getElementById("pairStatus-"+b.value.firstElementChild.textContent).innerHTML)return!1;return!0};
Blast.Storage.allConnectedMobile_=function(){var a=document.getElementById("rc-list").querySelectorAll("[id=rc-status-]");a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if("disconnected"==document.getElementById("rc-status-"+b.value.textContent).innerHTML)return!1;return!0};
Blast.Storage.reconnectDoneHandler_=function(a){window.location.href.includes("mobile")?document.getElementById("rc-dialog").style.display="none":document.getElementById("rcModal").style.display="none";Blockly.Xml.domToWorkspace(a,Blast.workspace);Blast.Storage.monitorChanges_(Blast.workspace)};Blast.Storage.reconnectCancelHandler_=function(){document.getElementById("rcModal").style.display="none"};
Blast.Storage.monitorChanges_=function(a){function b(){var h=Blockly.Xml.workspaceToDom(a);h=Blockly.Xml.domToText(h);d!=h&&(window.location.hash="",a.removeChangeListener(b))}var c=Blockly.Xml.workspaceToDom(a),d=Blockly.Xml.domToText(c);a.addChangeListener(b)};Blast.Storage.generatePath=function(){for(var a=[],b=0;12>b;b++)a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())));return a.join("")};
window.addEventListener("load",function(){var a=window.location.hash;if(a){a=a.substring(1);try{Blast.Storage.retrieveXML_(a)}catch(b){Blast.throwError("Could not load file."),console.error(b)}}});Blast.Things={};Blast.Things.webBluetoothDevices=new Map;Blast.Things.webHidNames=new Map;Blast.Things.webHidDevices=new Map;
Blast.Things.flyoutCategory=function(a){var b=[],c=document.createElement("label");c.setAttribute("text","WebBluetooth Blocks");b.push(c);c=document.createElement("button");c.setAttribute("text","connect via webBluetooth");c.setAttribute("callbackKey","CREATE_WEBBLUETOOTH");a.registerButtonCallback("CREATE_WEBBLUETOOTH",function(g){Blast.Things.createWebBluetoothButtonHandler()});b.push(c);c=Blast.Things.flyoutCategoryBlocksWB(a);b=b.concat(c);c=document.createElement("label");c.setAttribute("text",
"WebHID Blocks");b.push(c);c=document.createElement("button");c.setAttribute("text","connect via webHID");c.setAttribute("callbackKey","CREATE_WEBHID");a.registerButtonCallback("CREATE_WEBHID",function(g){Blast.Things.createWebHidButtonHandler()});b.push(c);a=Blast.Things.flyoutCategoryBlocksWHid(a);b=b.concat(a);a=document.createElement("label");a.setAttribute("text","additional identifiers");b.push(a);a=Blockly.utils.xml.createElement("block");a.setAttribute("type","uri");b.push(a);a=document.createElement("label");
a.setAttribute("text","example audio URIs");b.push(a);a=$jscomp.makeIterator(["https://studio.code.org/blockly/media/skins/dance/win.mp3","https://studio.code.org/blockly/media/click.mp3","https://upload.wikimedia.org/wikipedia/commons/2/25/243020_plasterbrain_game-start.ogg","https://upload.wikimedia.org/wikipedia/commons/d/d9/Wilhelm_Scream.ogg"]);for(c=a.next();!c.done;c=a.next()){c=c.value;var d=Blockly.utils.xml.createElement("block");d.setAttribute("type","uri");var h=Blockly.utils.xml.createElement("field");
h.setAttribute("name","URI");h.textContent=c;d.appendChild(h);b.push(d)}return b};Blast.Things.flyoutCategoryBlocksWHid=function(){var a=[];if(0<Blast.Things.webHidDevices.size&&Blockly.Blocks.things_webHID){var b=Blockly.utils.xml.createElement("block");b.setAttribute("type","things_webHID");b.setAttribute("gap",8);a.push(b)}return a};
Blast.Things.flyoutCategoryBlocksWB=function(){var a=[];if(0<Blast.Things.webBluetoothDevices.size&&Blockly.Blocks.things_webBluetooth){var b=Blockly.utils.xml.createElement("block");b.setAttribute("type","things_webBluetooth");b.setAttribute("gap",8);a.push(b)}return a};
Blast.Things.getWebBluetoothDevices=function(){var a=[].concat($jscomp.arrayFromIterable(Blast.Things.webBluetoothDevices.keys())).sort();if(0===a.legnth)return[];var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=Blast.Things.webBluetoothDevices.get(c);b.push([c,d])}return b};
Blast.Things.getWebHIDDevices=function(){var a=[].concat($jscomp.arrayFromIterable(Blast.Things.webHidNames.keys())).sort();if(0===a.legnth)return[];var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=Blast.Things.webHidNames.get(c);b.push([c,d])}return b};Blast.Things.createWebBluetoothButtonHandler=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){return a.yield(Blast.Bluetooth.requestDevice(),0)})};
Blast.Things.addWebBluetoothDevice=function(a,b){var c=function(d,h){Blockly.Variables.promptName("Pair successful! Now give your device a name.",d,function(g){if(g)if(Blast.Things.webBluetoothDevices.has(g)){var m="Name %1 already exists".replace("%1",g);Blockly.alert(m,function(){c(g,h)})}else Blast.Things.webBluetoothDevices.set(g,h);else Blockly.alert("Name cannot be empty",function(){c(g,h)})})};c(b,a)};
Blast.Things.createWebHidButtonHandler=function(){navigator.hid.requestDevice({filters:[]}).then(function(a){if(0===a.length)Blast.throwError("Connection failed or cancelled by User.");else{var b=Date.now().toString(36)+Math.random().toString(36).substr(2);Blast.Things.webHidDevices.set(b,a[0]);Blast.Things.addWebHidDevice(b,a[0].productName);Blast.workspace.refreshToolboxSelection()}}).catch(function(a){Blast.throwError(a)})};
Blast.Things.addWebHidDevice=function(a,b){var c=function(d,h){Blockly.Variables.promptName("Connection established! Now give your device a name.",d,function(g){if(g)if(Blast.Things.webHidNames.has(g)){var m="Name %1 already exists".replace("%1",g);Blockly.alert(m,function(){c(g,h)})}else Blast.Things.webHidNames.set(g,h);else Blockly.alert("Name cannot be empty",function(){c(g,h)})})};c(b,a)};Blast.Bluetooth={};Blast.Bluetooth.optionalServices=[];Blast.Bluetooth.scanBlocks=[];Blast.Bluetooth.LEScanResults={};Blast.Bluetooth.isLEScanRunning=!1;Blast.Bluetooth.eventListeners=[];Blast.Bluetooth.charEventListeners={};
Blast.Bluetooth.requestDevice=function(a,b){var c,d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress){if(!navigator.bluetooth)return g.jumpTo(0);a||(a={acceptAllDevices:!0},a.optionalServices=Blast.Bluetooth.optionalServices);g.setCatchFinallyBlocks(3);return g.yield(navigator.bluetooth.requestDevice(a),5)}if(3!=g.nextAddress)return c=g.yieldResult,d=b||c.name,Blast.Things.addWebBluetoothDevice(c.id,d),Blast.workspace.refreshToolboxSelection(),g.return(c);h=g.enterCatchBlock();
Blast.throwError(h);g.jumpToEnd()})};Blast.Bluetooth.getDeviceById=function(a){var b,c,d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(navigator.bluetooth.getDevices(),2);b=g.yieldResult;c=$jscomp.makeIterator(b);for(d=c.next();!d.done;d=c.next())if(h=d.value,h.id==a)return g.return(h);Blast.throwError("Bluetooth device "+a+" wasn't found in paired devices.");g.jumpToEnd()})};
Blast.Bluetooth.connect=function(a){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return d.setCatchFinallyBlocks(2),d.yield(Blast.Bluetooth.getDeviceById(a),4);case 4:return b=d.yieldResult,d.yield(b.gatt.connect(),5);case 5:return d.return(d.yieldResult);case 2:c=d.enterCatchBlock(),Blast.throwError("Error connecting to Bluetooth device "+a),console.error(c),d.jumpToEnd()}})};
Blast.Bluetooth.disconnect=function(a){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return d.setCatchFinallyBlocks(2),d.yield(Blast.Bluetooth.getDeviceById(a),4);case 4:return b=d.yieldResult,d.yield(b.gatt.disconnect(),5);case 5:return d.return(d.yieldResult);case 2:c=d.enterCatchBlock(),Blast.throwError("Error disconnecting from Bluetooth device "+a),console.error(c),d.jumpToEnd()}})};
Blast.Bluetooth.gatt_writeWithoutResponse=function(a,b,c,d){function h(p){p=p.replace(/^0x/,"");0!=p.length%2&&(p="0"+p);var l=p.match(/[G-Z\s]/i);l&&console.log("WARNING: found non-hex characters",l);p=p.match(/[\dA-F]{2}/gi).map(function(n){return parseInt(n,16)});return(new Uint8Array(p)).buffer}var g,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:return p.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:g=p.yieldResult;if(!g)return p.return();
d=h(d);p.setCatchFinallyBlocks(3);return p.yield(g.writeValueWithoutResponse(d),5);case 5:p.leaveTryBlock(0);break;case 3:m=p.enterCatchBlock(),console.error(m),Blast.throwError("Error writing to Bluetooth device.\nMake sure the device is compatible with the connected block."),p.jumpToEnd()}})};
Blast.Bluetooth.getPrimaryService=function(a,b){var c,d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.connect(a),2);case 2:return c=g.yieldResult,g.setCatchFinallyBlocks(3),g.yield(c.getPrimaryService(b),5);case 5:d=g.yieldResult;g.leaveTryBlock(4);break;case 3:h=g.enterCatchBlock(),console.error(h),Blast.throwError("The device is not compatible with the connected block.");case 4:return g.return(d)}})};
Blast.Bluetooth.getCharacteristic=function(a,b,c){var d,h,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){switch(m.nextAddress){case 1:return m.yield(Blast.Bluetooth.getPrimaryService(a,b),2);case 2:d=m.yieldResult;if(!d)return m.return();m.setCatchFinallyBlocks(3);return m.yield(d.getCharacteristic(c),5);case 5:h=m.yieldResult;m.leaveTryBlock(4);break;case 3:g=m.enterCatchBlock(),console.error(g),Blast.throwError("The device is not compatible with the connected block.");case 4:return m.return(h)}})};
Blast.Bluetooth.gatt_read=function(a,b,c){var d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return d=Blast.Bluetooth.getCharacteristic(a,b,c),g.setCatchFinallyBlocks(2),g.yield(d.readValue(),4);if(2!=g.nextAddress)return g.return(g.yieldResult);h=g.enterCatchBlock();console.error(h);Blast.throwError("Error reading from Bluetooth device "+a);g.jumpToEnd()})};
Blast.Bluetooth.gatt_read_text=function(a,b,c){var d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=g.yieldResult;h=(new TextDecoder).decode(d);return g.return(h)})};Blast.Bluetooth.gatt_read_number=function(a,b,c){var d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=g.yieldResult;h=(new DataView(d)).getUint8(0);return g.return(h)})};
Blast.Bluetooth.gatt_read_hex=function(a,b,c){var d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=g.yieldResult;h=(new Uint8Array(d)).reduce(function(m,p){return m+("0"+p.toString(16)).slice(-2)},"");return g.return(h)})};
Blast.Bluetooth.gatt_subscribe=function(a,b,c,d){var h,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){switch(m.nextAddress){case 1:return m.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:return h=m.yieldResult,h.addEventListener("characteristicvaluechanged",d),Blast.Bluetooth.charEventListeners[c]=[h,"characteristicvaluechanged",d],m.setCatchFinallyBlocks(3),m.yield(h.startNotifications(),5);case 5:m.leaveTryBlock(0);break;case 3:g=m.enterCatchBlock(),console.error(g),
Blast.throwError("Error subscribing to Bluetooth device "+a),m.jumpToEnd()}})};
Blast.Bluetooth.startLEScan=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){if(Blast.Bluetooth.isLEScanRunning)return a.return();Blast.Bluetooth.cacheLEScanResults();Blast.Bluetooth.isLEScanRunning=!0;Blockly.alert("Please click allow on the LE Scan prompt now, then close this dialog.",navigator.bluetooth.requestLEScan({acceptAllAdvertisements:!0,keepRepeatedDevices:!0}));setTimeout(Blast.Bluetooth.stopLEScan,3E4);a.jumpToEnd()})};
Blast.Bluetooth.stopLEScan=function(){Blast.Bluetooth.isLEScanRunning&&(navigator.bluetooth.stopLEScan(),Blast.Bluetooth.isLEScanRunning=!1)};Blast.Bluetooth.cacheLEScanResults=function(){Blast.Bluetooth.addEventListener("advertisementreceived",function(a){var b=a.device.id;Blast.Bluetooth.LEScanResults[b]||(Blast.Bluetooth.LEScanResults[b]=[]);Blast.Bluetooth.LEScanResults[b].unshift(a)})};
Blast.Bluetooth.addEventListener=function(a,b){Blast.Bluetooth.eventListeners.push([a,b]);navigator.bluetooth.addEventListener(a,b)};Blast.Bluetooth.removeEventListener=function(a,b){var c=Blast.Bluetooth.eventListeners.findIndex(function(d){return d[0]===a&&d[1]===b});-1!==c&&Blast.Bluetooth.eventListeners.splice(c,1);navigator.bluetooth.removeEventListener(a,b)};
Blast.Bluetooth.tearDown=function(){Blast.Bluetooth.isLEScanRunning&&(Blast.Bluetooth.isLEScanRunning=!1);if(Blast.Bluetooth.eventListeners){for(var a=$jscomp.makeIterator(Blast.Bluetooth.eventListeners),b=a.next();!b.done;b=a.next())b=b.value,Blast.Bluetooth.removeEventListener(b[0],b[1]);Blast.Bluetooth.eventListeners=[]}if(Blast.Bluetooth.charEventListeners){a=$jscomp.makeIterator(Object.keys(Blast.Bluetooth.charEventListeners));for(b=a.next();!b.done;b=a.next()){var c=Blast.Bluetooth.charEventListeners[b.value];
b=c[0];var d=c[1];c=c[2];b.stopNotifications();b.removeEventListener(d,c)}Blast.Bluetooth.charEventListeners={}}Blast.Bluetooth.LEScanResults={}};function initApi(a,b){Blockly.JavaScript.addReservedWords("highlightBlock","eventChecker");var c=function(h){h=h?h.toString():"";return Blast.highlightBlock(h)};a.setProperty(b,"highlightBlock",a.createNativeFunction(c));c=function(h){Blast.Interrupted=h};a.setProperty(b,"setInterrupt",a.createNativeFunction(c));c=$jscomp.makeIterator(Blast.apiFunctions);for(var d=c.next();!d.done;d=c.next())d=d.value,a.setProperty(b,d[0],a.createNativeFunction(d[1]));c=$jscomp.makeIterator(Blast.asyncApiFunctions);
for(d=c.next();!d.done;d=c.next())d=d.value,a.setProperty(b,d[0],a.createAsyncFunction(d[1]));c=function(h,g){return Blast.States.eventChecker(h,g)};a.setProperty(b,"eventChecker",a.createNativeFunction(c));a.setProperty(b,"startEventChecker",a.createNativeFunction(function(){return Blast.States.startEventChecker()}));c=function(h){return prompt(h)};a.setProperty(b,"prompt",a.createNativeFunction(c))};Blockly.Blocks.repeat=Blockly.Blocks.controls_repeat_ext;Blockly.Blocks["for"]=Blockly.Blocks.controls_for;Blockly.Blocks.while_until=Blockly.Blocks.controls_whileUntil;Blockly.Blocks.break_continue=Blockly.Blocks.controls_flow_statements;Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.push("repeat","while_until","for");var REPEAT_XML='\n<block type="repeat">\n  <value name="TIMES">\n    <block type="math_number">\n      <field name="NUM">10</field>\n    </block>\n  </value>\n</block>';
Blast.Toolbox.addBlock("repeat","Control Flow",REPEAT_XML);var FOR_XML='\n<block type="for">\n  <value name="FROM">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="TO">\n    <block type="math_number">\n      <field name="NUM">5</field>\n    </block>\n  </value>\n  <value name="BY">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>';Blast.Toolbox.addBlock("for","Control Flow",FOR_XML);
Blockly.Blocks.conditional_statement={init:function(){this.appendValueInput("IF0").appendField("%{BKY_CONTROLS_IF_MSG_IF}").setCheck("Boolean");this.appendStatementInput("DO0").appendField("%{BKY_CONTROLS_IF_MSG_THEN}");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setHelpUrl("%{BKY_CONTROLS_IF_HELPURL}");this.setColour(120);this.setMutator(new Blockly.Mutator(["controls_if_elseif","controls_if_else"]));this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&
this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_4}else return Blockly.Msg.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))},elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var a=Blockly.utils.xml.createElement("mutation");this.elseifCount_&&a.setAttribute("elseif",
this.elseifCount_);this.elseCount_&&a.setAttribute("else",1);return a},domToMutation:function(a){this.elseifCount_=parseInt(a.getAttribute("elseif"),10)||0;this.elseCount_=parseInt(a.getAttribute("else"),10)||0;this.rebuildShape_()},decompose:function(a){var b=a.newBlock("controls_if_if");b.initSvg();for(var c=b.nextConnection,d=1;d<=this.elseifCount_;d++){var h=a.newBlock("controls_if_elseif");h.initSvg();c.connect(h.previousConnection);c=h.nextConnection}this.elseCount_&&(a=a.newBlock("controls_if_else"),
a.initSvg(),c.connect(a.previousConnection));return b},compose:function(a){a=a.nextConnection.targetBlock();this.elseCount_=this.elseifCount_=0;for(var b=[null],c=[null],d=null;a&&!a.isInsertionMarker();){switch(a.type){case "controls_if_elseif":this.elseifCount_++;b.push(a.valueConnection_);c.push(a.statementConnection_);break;case "controls_if_else":this.elseCount_++;d=a.statementConnection_;break;default:throw new TypeError("Unknown block type: "+a.type);}a=a.nextConnection&&a.nextConnection.targetBlock()}this.updateShape_();
this.reconnectChildBlocks_(b,c,d)},saveConnections:function(a){a=a.nextConnection.targetBlock();for(var b=1;a;){switch(a.type){case "controls_if_elseif":var c=this.getInput("IF"+b),d=this.getInput("DO"+b);a.valueConnection_=c&&c.connection.targetConnection;a.statementConnection_=d&&d.connection.targetConnection;b++;break;case "controls_if_else":d=this.getInput("ELSE");a.statementConnection_=d&&d.connection.targetConnection;break;default:throw new TypeError("Unknown block type: "+a.type);}a=a.nextConnection&&
a.nextConnection.targetBlock()}},rebuildShape_:function(){var a=[null],b=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(var d=1;this.getInput("IF"+d);){var h=this.getInput("IF"+d),g=this.getInput("DO"+d);a.push(h.connection.targetConnection);b.push(g.connection.targetConnection);d++}this.updateShape_();this.reconnectChildBlocks_(a,b,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var a=1;this.getInput("IF"+a);)this.removeInput("IF"+
a),this.removeInput("DO"+a),a++;for(a=1;a<=this.elseifCount_;a++)this.appendValueInput("IF"+a).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+a).appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(a,b,c){for(var d=1;d<=this.elseifCount_;d++)Blockly.Mutator.reconnect(a[d],this,"IF"+d),Blockly.Mutator.reconnect(b[d],this,"DO"+
d);Blockly.Mutator.reconnect(c,this,"ELSE")}};Blockly.Blocks.wait_seconds={init:function(){this.appendValueInput("SECONDS").appendField("wait").setCheck("Number");this.appendDummyInput().appendField("seconds");this.setColour(120);this.setTooltip("Wait x seconds before executing the next block.");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setHelpUrl("")}};var WAIT_SECONDS_XML='\n<block type="wait_seconds">\n  <value name="SECONDS">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>\n';
Blast.Toolbox.addBlock("wait_seconds","Control Flow",WAIT_SECONDS_XML);Blockly.Blocks.controls_if_if={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_IF_TITLE_IF}");this.setNextStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_IF_TOOLTIP}")}};
Blockly.Blocks.controls_if_elseif={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}")}};Blockly.Blocks.controls_if_else={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}");this.setPreviousStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_ELSE_TOOLTIP}")}};Blockly.Blocks.state_definition={init:function(){var a=Blast.States.findLegalName("",this);a=new Blockly.FieldTextInput(a,Blast.States.rename);a.setSpellcheck(!1);this.appendValueInput("state_condition").setCheck("Boolean").appendField("define state").appendField(a,"NAME");this.setColour(180);this.setTooltip("");this.setHelpUrl("")},getStateDef:function(){var a=this.getFieldValue("state_condition");return[this.getFieldValue("NAME"),a]},getConditions:function(){return this.getFieldValue("state_condition")}};
Blockly.Blocks.event={init:function(){this.appendDummyInput().appendField("when blast").appendField(new Blockly.FieldDropdown([["enters","ENTERS"],["exits","EXITS"]]),"entersExits").appendField("state").appendField(new Blockly.FieldLabelSerializable(""),"NAME");this.appendStatementInput("statements").setCheck(null);this.setColour(180);this.setTooltip("");this.setHelpUrl("")},getStateName:function(){return this.getFieldValue("NAME")},renameState:function(a,b){Blockly.Names.equals(a,this.getStateName())&&
this.setFieldValue(b,"NAME")},mutationToDom:function(){var a=Blockly.utils.xml.createElement("mutation");a.setAttribute("name",this.getStateName());return a},domToMutation:function(a){a=a.getAttribute("name");this.renameState(this.getStateName(),a)},onchange:function(a){if(this.workspace&&!this.workspace.isFlyout&&a.recordUndo)if(a.type==Blockly.Events.BLOCK_CREATE&&-1!=a.ids.indexOf(this.id)){var b=this.getStateName();(b=Blast.States.getDefinition(b,this.workspace))&&b.type!=this.defType_&&(b=null);
if(!b){Blockly.Events.setGroup(a.group);a=Blockly.utils.xml.createElement("xml");b=Blockly.utils.xml.createElement("block");b.setAttribute("type",this.defType_);var c=this.getRelativeToSurfaceXY(),d=c.y+2*Blockly.SNAP_RADIUS;b.setAttribute("x",c.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1));b.setAttribute("y",d);c=this.mutationToDom();b.appendChild(c);c=Blockly.utils.xml.createElement("field");c.setAttribute("name","NAME");d=this.getStateName();d||(d=Blast.States.findLegalName("",this),this.renameState("",
d));c.appendChild(Blockly.utils.xml.createTextNode(d));b.appendChild(c);a.appendChild(b);Blockly.Xml.domToWorkspace(a,this.workspace);Blockly.Events.setGroup(!1)}}else a.type==Blockly.Events.BLOCK_DELETE?(b=this.getStateName(),Blast.States.getDefinition(b,this.workspace)||(Blockly.Events.setGroup(a.group),this.dispose(!0),Blockly.Events.setGroup(!1))):a.type==Blockly.Events.CHANGE&&"disabled"==a.element&&(b=this.getStateName(),(b=Blast.States.getDefinition(b,this.workspace))&&b.id==a.blockId&&((b=
Blockly.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),Blockly.Events.setGroup(a.group),a.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),Blockly.Events.setGroup(b)))},defType_:"state_definition"};Blockly.Blocks.mac={init:function(){this.appendDummyInput().appendField("mac").appendField(new Blockly.FieldTextInput("deadbeef"),"MAC");this.setOutput(!0,"mac");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};Blockly.Blocks.uri={init:function(){this.appendDummyInput().appendField("URI").appendField(new Blockly.FieldTextInput("https://example.com"),"URI");this.setOutput(!0,"URI");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};Blockly.Blocks.number_value=Blockly.Blocks.math_number;Blockly.Blocks.number_random=Blockly.Blocks.math_random_int;Blockly.Blocks.number_arithmetic=Blockly.Blocks.math_arithmetic;Blockly.Blocks.number_modulo=Blockly.Blocks.math_modulo;Blockly.Blocks.number_infinity={init:function(){this.appendDummyInput().appendField("infinity");this.setOutput(!0,"Number");this.setColour(230);this.setTooltip("");this.setHelpUrl("")}};Blockly.Blocks.string=Blockly.Blocks.text;Blockly.Blocks.string_join=Blockly.Blocks.text_join;Blockly.Blocks.string_length=Blockly.Blocks.text_length;Blockly.Blocks.string_indexOf=Blockly.Blocks.text_indexOf;Blockly.Blocks.string_charAt=Blockly.Blocks.text_charAt;Blockly.Blocks.string_getSubstring=Blockly.Blocks.text_getSubstring;Blockly.Blocks.string_changeCase=Blockly.Blocks.text_changeCase;Blockly.Blocks.string_replace=Blockly.Blocks.text_replace;Blockly.Blocks.string_showPrompt=Blockly.Blocks.text_prompt_ext;
Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH="concatenate text";Blockly.Blocks.things_webBluetooth={init:function(){this.appendDummyInput().appendField("webBluetooth device").appendField(new Blockly.FieldDropdown(Blast.Things.getWebBluetoothDevices),"id");this.setOutput(!0,"Thing");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};
Blockly.Blocks.things_webHID={init:function(){this.appendDummyInput().appendField("HID device").appendField(new Blockly.FieldDropdown(Blast.Things.getWebHIDDevices),"id");this.setOutput(!0,"Thing");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};Blockly.JavaScript.repeat=Blockly.JavaScript.controls_repeat_ext;Blockly.JavaScript.while_until=Blockly.JavaScript.controls_whileUntil;Blockly.JavaScript["for"]=Blockly.JavaScript.controls_for;Blockly.JavaScript.break_continue=Blockly.JavaScript.controls_flow_statements;Blockly.JavaScript.conditional_statement=Blockly.JavaScript.controls_if;Blockly.JavaScript.wait_seconds=function(a){return"waitForSeconds("+Number(a.getFieldValue("SECONDS"))+");\n"};
var waitForSeconds=function(a,b){setTimeout(b,1E3*a)};Blast.asyncApiFunctions.push(["waitForSeconds",waitForSeconds]);Blockly.JavaScript.state_definition=function(a){return null};
Blockly.JavaScript.event=function(a){var b=a.getFieldValue("entersExits"),c=a.getFieldValue("NAME"),d=Blockly.JavaScript.statementToCode(a,"statements");Blockly.JavaScript.definitions_.eventChecker="startEventChecker()";if(c=Blast.States.getDefinition(c,Blast.workspace))c=Blockly.JavaScript.valueToCode(c,"state_condition",Blockly.JavaScript.ORDER_NONE),"ENTERS"!=b&&(c="!("+c+")"),Blast.States.addEventCode(a.id,'if(eventChecker("'+a.id+'", '+c+")) {\n        setInterrupt(true);\n        "+d+" \n        setInterrupt(false);\n      }");
return null};Blockly.JavaScript.uri=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("URI")),Blockly.JavaScript.ORDER_NONE]};Blockly.JavaScript.mac=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("MAC")),Blockly.JavaScript.ORDER_NONE]};Blockly.JavaScript.number_value=Blockly.JavaScript.math_number;Blockly.JavaScript.number_infinity=function(a){return[Infinity,Blockly.JavaScript.ORDER_NONE]};
Blockly.JavaScript.number_arithmetic=function(a){var b={ADD:[" + ",Blockly.JavaScript.ORDER_ADDITION],MINUS:[" - ",Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",Blockly.JavaScript.ORDER_DIVISION],MODULO:[" % ",Blockly.JavaScript.ORDER_DIVISION],POWER:[null,Blockly.JavaScript.ORDER_NONE]}[a.getFieldValue("OP")],c=b[0];b=b[1];var d=Blockly.JavaScript.valueToCode(a,"A",b)||"0";a=Blockly.JavaScript.valueToCode(a,"B",b)||"0";return c?[d+c+
a,b]:["Math.pow("+d+", "+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]};Blockly.JavaScript.number_random=function(a){var b=Blockly.JavaScript.valueToCode(a,"FROM",Blockly.JavaScript.ORDER_NONE)||"0";a=Blockly.JavaScript.valueToCode(a,"TO",Blockly.JavaScript.ORDER_NONE)||"0";return["numberRandom("+b+", "+a+")",Blockly.JavaScript.ORDER_NONE]};
Blockly.JavaScript.number_modulo=function(a){var b=Blockly.JavaScript.valueToCode(a,"DIVIDEND",Blockly.JavaScript.ORDER_MODULUS)||"0";a=Blockly.JavaScript.valueToCode(a,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0";return[b+" % "+a,Blockly.JavaScript.ORDER_MODULUS]};var numberRandom=function(a,b){if(a>b){var c=a;a=b;b=c}return Math.floor(Math.random()*(b-a+1)+a)};Blast.asyncApiFunctions.push(["numberRandom",numberRandom]);Blockly.JavaScript.string=Blockly.JavaScript.text;Blockly.JavaScript.string_join=Blockly.JavaScript.text_join;Blockly.JavaScript.string_length=Blockly.JavaScript.text_length;Blockly.JavaScript.string_indexOf=Blockly.JavaScript.text_indexOf;Blockly.JavaScript.string_charAt=Blockly.JavaScript.text_charAt;Blockly.JavaScript.string_getSubstring=Blockly.JavaScript.text_getSubstring;Blockly.JavaScript.string_changeCase=Blockly.JavaScript.text_changeCase;Blockly.JavaScript.string_replace=Blockly.JavaScript.text_replace;
Blockly.JavaScript.string_showPrompt=Blockly.JavaScript.text_prompt;Blockly.JavaScript.things_webBluetooth=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("id")),Blockly.JavaScript.ORDER_NONE]};Blockly.JavaScript.things_webHID=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("id")),Blockly.JavaScript.ORDER_NONE]};Blockly.Blocks.huskylens_choose_algo={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("write algorithm property").appendField(new Blockly.FieldDropdown([["Face Recognition","face_recognition"],["Object Tracking","object_tracking"],["Object Recognition","object_recognition"],["Line Tracking","line_tracking"],["Color Recognition","color_recognition"],["Tag Recognition","tag_recognition"],["Object Classification","object_classification"]]),"Algorithms").appendField("to Huskyduino");
this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Choose the algorithm of a HuskyDuino");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};Blast.Toolbox.addBlock("huskylens_choose_algo","Properties");
Blockly.Blocks.huskylens_write_face_id={init:function(){this.appendValueInput("ID").setCheck("Number").appendField("write face ID property");this.appendValueInput("Thing").setCheck("Thing").appendField("to HuskyDuino");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Sets the ID of the face currently on camera. ID shoud be a value between 1 and 255");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&
this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};var HUSKYLENS_WRITE_FACE_ID_XML='\n<block type="huskylens_write_face_id">\n  <value name="ID">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>\n';Blast.Toolbox.addBlock("huskylens_write_face_id","Properties",HUSKYLENS_WRITE_FACE_ID_XML);
Blockly.Blocks.huskylens_write_forget_flag={init:function(){this.appendValueInput("forgetFlag").setCheck("Boolean").appendField("write forget flag property");this.appendValueInput("Thing").setCheck("Thing").appendField("to HuskyDuino");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("forget all values of the currently selected algorithm");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&
(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};var HUSKYLENS_FORGET_FLAG_XML='\n<block type="huskylens_write_forget_flag">\n  <value name="forgetFlag">\n    <block type="logic_boolean">\n      <field name="BOOL">TRUE</field>\n    </block>\n  </value>\n</block>\n';Blast.Toolbox.addBlock("huskylens_write_forget_flag","Properties",HUSKYLENS_FORGET_FLAG_XML);
Blockly.Blocks.huskylens_read_id={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read face IDs property of HuskyDuino");this.setOutput(!0,"String");this.setColour(255);this.setTooltip("returns up to 5 IDs of the faces currently visible to the HuskyLens");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),
this.dispose()))}};Blast.Toolbox.addBlock("huskylens_read_id","Properties");Blockly.JavaScript.huskylens_choose_algo=function(a){var b=a.getFieldValue("Algorithms");return"chooseAlgo("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '"+{face_recognition:"0x01",object_tracking:"0x02",object_recognition:"0x03",line_tracking:"0x04",color_recognition:"0x05",tag_recognition:"0x06",object_classification:"0x07"}[b]+"');\n"};
Blockly.JavaScript.huskylens_write_face_id=function(a){var b="0x"+Blockly.JavaScript.valueToCode(a,"ID",Blockly.JavaScript.ORDER_ATOMIC).toString(16);return"learnID("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '"+b+"');\n"};
Blockly.JavaScript.huskylens_write_forget_flag=function(a){var b=Blockly.JavaScript.valueToCode(a,"forgetFlag",Blockly.JavaScript.ORDER_ATOMIC);return"forgetAll("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '0x"+(b?"01":"00")+"');\n"};Blockly.JavaScript.huskylens_read_id=function(a){return["readID("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+")",Blockly.JavaScript.ORDER_NONE]};var HuskyServiceUUID="5be35d20-f9b0-11eb-9a03-0242ac130003";
Blast.Bluetooth.optionalServices.push(HuskyServiceUUID);var chooseAlgo=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be35d26-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};Blast.asyncApiFunctions.push(["chooseAlgo",chooseAlgo]);
var learnID=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be35eca-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};Blast.asyncApiFunctions.push(["learnID",learnID]);
var forgetAll=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be361b8-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};Blast.asyncApiFunctions.push(["forgetAll",forgetAll]);
var readID=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_read_text(a,HuskyServiceUUID,"5be3628a-f9b0-11eb-9a03-0242ac130003"),2);c=d.yieldResult;b(c);d.jumpToEnd()})};Blast.asyncApiFunctions.push(["readID",readID]);Blockly.Blocks.switch_lights_rgb={init:function(){this.appendValueInput("red").setCheck("Number").appendField("write color properties: red ");this.appendValueInput("green").setCheck("Number").appendField("green");this.appendValueInput("blue").setCheck("Number").appendField("blue");this.appendValueInput("thing").setCheck("Thing").appendField("to LED controller");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Switches checked lights on and unchecked ones off.");
this.setHelpUrl("");this.firstTime=!0},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later and enable Experimental Web Platform features."),this.dispose()))}};var SWITCH_LIGHTS_RGB_XML='\n<block type="switch_lights_rgb">\n  <value name="red">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="green">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="blue">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n</block>';
Blast.Toolbox.addBlock("switch_lights_rgb","Properties",SWITCH_LIGHTS_RGB_XML);
Blockly.Blocks.switch_lights_ryg={init:function(){this.appendValueInput("red").setCheck("Number").appendField("write color properties: red ");this.appendValueInput("yellow").setCheck("Number").appendField("yellow");this.appendValueInput("green").setCheck("Number").appendField("green");this.appendValueInput("thing").setCheck("Thing").appendField("to LED controller");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Swichtes checked lights on and unchecked ones off.");
this.setHelpUrl("");this.firstTime=!0},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later and enable Experimental Web Platform features."),this.dispose()))}};var SWITCH_LIGHTS_RYG_XML='\n<block type="switch_lights_ryg">\n  <value name="red">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="yellow">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="green">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n</block>';
Blast.Toolbox.addBlock("switch_lights_ryg","Properties",SWITCH_LIGHTS_RYG_XML);Blockly.JavaScript.switch_lights_rgb=function(a){var b=Blockly.JavaScript.valueToCode(a,"red",Blockly.JavaScript.ORDER_ATOMIC)||"0",c=Blockly.JavaScript.valueToCode(a,"green",Blockly.JavaScript.ORDER_ATOMIC)||"0",d=Blockly.JavaScript.valueToCode(a,"blue",Blockly.JavaScript.ORDER_ATOMIC)||"0";return"switchLights("+(Blockly.JavaScript.valueToCode(a,"thing",Blockly.JavaScript.ORDER_NONE)||"null")+", "+b+", "+c+", "+d+");\n"};
Blockly.JavaScript.switch_lights_ryg=function(a){var b=Blockly.JavaScript.valueToCode(a,"red",Blockly.JavaScript.ORDER_ATOMIC)||"0",c=Blockly.JavaScript.valueToCode(a,"yellow",Blockly.JavaScript.ORDER_ATOMIC)||"0",d=Blockly.JavaScript.valueToCode(a,"green",Blockly.JavaScript.ORDER_ATOMIC)||"0";return"switchLights("+(Blockly.JavaScript.valueToCode(a,"thing",Blockly.JavaScript.ORDER_NONE)||"null")+", "+b+", "+c+", "+d+");\n"};var LEDServiceUUID="0000fff0-0000-1000-8000-00805f9b34fb";Blast.Bluetooth.optionalServices.push(LEDServiceUUID);
var switchLights=function(a,b,c,d,h){var g,m,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress){if(!a)return Blast.throwError("No LED Controller is set."),h(),n.return();g=parseInt(b).toString(16).padStart(2,"0");m=parseInt(c).toString(16).padStart(2,"0");p=parseInt(d).toString(16).padStart(2,"0");l="7e000503"+g+m+p+"00ef";return n.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,LEDServiceUUID,"0000fff3-0000-1000-8000-00805f9b34fb",l),2)}h();n.jumpToEnd()})};
Blast.asyncApiFunctions.push(["switchLights",switchLights]);Blockly.Blocks.http_request={init:function(){this.appendValueInput("uri").appendField("send HTTP request to URI").setCheck("URI");this.appendDummyInput().appendField("output").appendField(new Blockly.FieldDropdown([["status","status"],["response","body"]]),"OUTPUT");this.appendDummyInput().appendField("method").appendField(new Blockly.FieldDropdown([["GET","GET"],["PUT","PUT"],["POST","POST"],["DELETE","DELETE"]],this.httpRequestValidator),"METHOD");this.appendDummyInput().appendField("headers (comma separated)");
this.appendDummyInput().appendField(new Blockly.FieldTextInput('"Content-Type": "application/json", "Accept": "application/json"'),"HEADERS");this.setOutput(!0,"String");this.setTooltip("Invokes a HTTP request.");this.setColour(0)},httpRequestValidator:function(a){this.getSourceBlock().updateInputs(a);return a},updateInputs:function(a){this.removeInput("BODYINPUT",!0);"GET"!=a&&this.appendDummyInput("BODYINPUT").appendField("body").appendField(new Blockly.FieldMultilineInput('{\n     "object": {\n       "a": "b",\n       "c": "d",\n       "e": "f"\n     },\n     "array": [\n       1,\n       2\n     ],\n     "string": "Hello World"\n     }'),
"BODY")}};Blast.Toolbox.addBlock("http_request","Requests and Queries");Blockly.Blocks.sparql_query={init:function(){this.appendValueInput("uri").appendField("run SPARQL Query from URI").setCheck("URI");this.appendDummyInput().appendField(new Blockly.FieldMultilineInput("SELECT *\n       WHERE { \n         ?s ?p ?o\n       }"),"query");this.setInputsInline(!1);this.setColour(0);this.setOutput(!0,"table");this.setTooltip("Executes a sparql query")}};Blast.Toolbox.addBlock("sparql_query","Requests and Queries");
Blockly.Blocks.sparql_ask={init:function(){this.appendValueInput("uri").appendField("run SPARQL ASK Query from URI").setCheck("URI");this.appendDummyInput().appendField(new Blockly.FieldMultilineInput("PREFIX sosa: <http://www.w3.org/ns/sosa/>\n     ASK \n     WHERE {\n       ?node sosa:hasSimpleResult ?rssiValue \n       FILTER (?rssiValue > -40)\n     }"),"query");this.setInputsInline(!1);this.setOutput(!0,"Boolean");this.setTooltip("executes a sparql ASK query");this.setColour(0)}};
Blast.Toolbox.addBlock("sparql_ask","Requests and Queries");Blockly.Blocks.display_text={init:function(){this.appendValueInput("text").setCheck(["String","Number","Boolean","URI","Thing"]).appendField("display text:");this.setColour(0);this.setTooltip("Add text output to the container on the right.");this.setHelpUrl("");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)}};Blast.Toolbox.addBlock("display_text","Actions");
Blockly.Blocks.display_table={init:function(){this.appendValueInput("table").setCheck(["table"]).appendField("display table:");this.setColour(0);this.setTooltip("Add data output to the container on the right.");this.setHelpUrl("");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)}};Blast.Toolbox.addBlock("display_table","Actions");
Blockly.Blocks.play_audio={init:function(){this.appendValueInput("URI").appendField("play audio from URI").setCheck("URI");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("Plays an audio file from URI.");this.setHelpUrl("")}};Blast.Toolbox.addBlock("play_audio","Actions");
Blockly.Blocks.get_signal_strength_wb={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read signal-strength property of bluetooth device");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads the strength of the signal (rssiValue property) sent by a ble device, measured at the at the BLAST client.");this.setHelpUrl("");this.firstTime=!0;this.requested=!1;this.deviceId=""},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&
(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later."),this.dispose()))}};Blast.Toolbox.addBlock("get_signal_strength_wb","Properties");Blockly.JavaScript.http_request=function(a){var b=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE)||null,c=a.getFieldValue("METHOD"),d=a.getFieldValue("HEADERS"),h=a.getFieldValue("OUTPUT");a=JSON.stringify(a.getFieldValue("BODY"))||null;return["sendHttpRequest("+b+",'"+c+"', \n      '{"+d+"}', "+a+", '"+h+"')\n",Blockly.JavaScript.ORDER_NONE]};
var sendHttpRequest=function(a,b,c,d,h,g){var m,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){null!=a&&void 0!=a&&""!=a||Blast.throwError("URI input of HttpRequest blocks must not be empty");m=JSON.parse(c);p={method:b,headers:new Headers(m)};d&&(p.body=d);fetch(a,p).then(Blast.handleFetchErrors).then(function(n){var q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){if(1==t.nextAddress)return"status"==h&&g(n.status),t.yield(n.text(),2);q=t.yieldResult;g(q);t.jumpToEnd()})}).catch(function(n){Blast.throwError(n.message+
"\nSee console for details.")});l.jumpToEnd()})};Blast.asyncApiFunctions.push(["sendHttpRequest",sendHttpRequest]);Blockly.JavaScript.sparql_query=function(a){var b=a.getFieldValue("query");a=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE);b=b.replace(/"/g,'\\"').replace(/[\n\r]/g," ");return["urdfQueryWrapper("+a+", '"+b+"')",Blockly.JavaScript.ORDER_NONE]};
Blockly.JavaScript.sparql_ask=function(a){var b=a.getFieldValue("query");a=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE);b=b.replace(/"/g,'\\"').replace(/[\n\r]/g," ");return["urdfQueryWrapper("+a+', "'+b+'")',Blockly.JavaScript.ORDER_NONE]};
var urdfQueryWrapper=function(a,b,c){var d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){urdf.clear();d="\n FROM <"+a+">\n";b=b.slice(0,b.indexOf("WHERE"))+d+b.slice(b.indexOf("WHERE"));urdf.query(b).then(function(g){c(g)}).catch(function(g){console.error(g);Blast.throwError(g.message+"\nSee console for details.")});h.jumpToEnd()})};Blast.asyncApiFunctions.push(["urdfQueryWrapper",urdfQueryWrapper]);
Blockly.JavaScript.display_text=function(a){return"displayText("+(Blockly.JavaScript.valueToCode(a,"text",Blockly.JavaScript.ORDER_NONE)||"''")+");\n"};var displayText=function(a){Blast.Ui.addMessage(a)};Blast.apiFunctions.push(["displayText",displayText]);Blockly.JavaScript.display_table=function(a){return"displayTable("+Blockly.JavaScript.valueToCode(a,"table",Blockly.JavaScript.ORDER_NONE)+");\n"};
var displayTable=function(a){if(0==a.length)Blast.Ui.addMessage("empty table");else{var b=a.reduce(function(d,h){for(var g in h)-1===d.indexOf(g)&&d.push(g);return d},[]),c="<tr>";b.forEach(function(d){return c+="<th>"+d+"</th>"});c+="</tr>";a.forEach(function(d){c+="<tr>";b.forEach(function(h){return c+="<td>"+(d[h]?d[h].value:"")+"</td>"});c+="</tr>"});a=document.createElement("table");a.classList.add("output_table");a.innerHTML=c;Blast.Ui.addElementToOutputContainer(a)}};
Blast.apiFunctions.push(["displayTable",displayTable]);Blockly.JavaScript.play_audio=function(a){return"playAudio("+Blockly.JavaScript.valueToCode(a,"URI",Blockly.JavaScript.ORDER_NONE)+");\n"};
var playAudio=function(a,b){return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(new Promise(function(d,h){var g=new Audio(a);g.preload="auto";g.autoplay=!0;g.onerror=function(m){Blast.throwError("Error trying to play audio from \n"+a+"\n See console for details");console.error(m);h(m)};g.onended=d}),2);b();c.jumpToEnd()})};Blast.asyncApiFunctions.push(["playAudio",playAudio]);
Blockly.JavaScript.get_signal_strength_wb=function(a){return["getRSSIWb("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)+")",Blockly.JavaScript.ORDER_NONE]};
var getRSSIWb=function(a,b){var c,d,h,g,m,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(navigator.bluetooth.getDevices(),2);c=l.yieldResult;d=null;h=$jscomp.makeIterator(c);for(g=h.next();!g.done;g=h.next())if(m=g.value,m.id===a){d=m;break}null==d&&Blast.throwError("Error pairing with Bluetooth device.");p=new AbortController;d.addEventListener("advertisementreceived",function(n){return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){p.abort();
b(n.rssi);q.jumpToEnd()})});return l.yield(d.watchAdvertisements({signal:p.signal}),0)})};Blast.asyncApiFunctions.push(["getRSSIWb",getRSSIWb]);Blockly.Blocks.blinkstick_set_colors={init:function(){this.appendValueInput("index").setCheck("Number").appendField("write color properties of LED");this.appendValueInput("red").appendField("red");this.appendValueInput("green").setCheck("Number").appendField("green");this.appendValueInput("blue").setCheck("Number").appendField("blue");this.appendValueInput("thing").setCheck("Thing").appendField("to BlinkStick");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);
this.setColour(255);this.setTooltip("Set the color properties of a tulogic BlinkStick.");this.setHelpUrl("https://www.blinkstick.com/")}};var BLINKSTICK_SET_COLORS_XML='\n<block type="blinkstick_set_colors">\n  <value name="index">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="red">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="green">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="blue">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n</block>\n';
Blast.Toolbox.addBlock("blinkstick_set_colors","Properties",BLINKSTICK_SET_COLORS_XML);Blockly.JavaScript.blinkstick_set_colors=function(a){var b=Blockly.JavaScript.valueToCode(a,"red",Blockly.JavaScript.ORDER_ATOMIC)||"0",c=Blockly.JavaScript.valueToCode(a,"green",Blockly.JavaScript.ORDER_ATOMIC)||"0",d=Blockly.JavaScript.valueToCode(a,"blue",Blockly.JavaScript.ORDER_ATOMIC)||"0",h=Blockly.JavaScript.valueToCode(a,"index",Blockly.JavaScript.ORDER_ATOMIC)||"0";return"blinkstickSetColors("+(Blockly.JavaScript.valueToCode(a,"thing",Blockly.JavaScript.ORDER_ATOMIC)||"''")+", "+h+", "+
b+", "+c+", "+d+")\n;"};
var blinkstickSetColors=function(a,b,c,d,h,g){var m,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:if(0>b||7<b)return Blast.throwError("BlinkStick index must be between 0 and 7."),g(),n.return();if(!a)return Blast.throwError("No BlinkStick block set."),g(),n.return();m=Blast.Things.webHidDevices.get(a);if(!m)return Blast.throwError("Connected device is not a HID device.\nMake sure you are connecting the Blinkstick via webHID."),g(),n.return();if(m.opened){n.jumpTo(2);
break}n.setCatchFinallyBlocks(3);return n.yield(m.open(),5);case 5:n.leaveTryBlock(2);break;case 3:n.enterCatchBlock(),Blast.throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(8352!==m.vendorId||16869!==m.productId)return Blast.throwError("The connected device is not a BlinkStick."),g(),n.return();p=Int8Array.from([5,b,c,d,h]);l=function(q){var t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){if(1==w.nextAddress)return w.setCatchFinallyBlocks(2),
w.yield(m.sendFeatureReport(5,p),4);if(2!=w.nextAddress)return w.leaveTryBlock(0);t=w.enterCatchBlock();return 0<q?w.yield(l(--q),0):(console.error(t),Blast.throwError("Failed to set BlinkStick colors, please check its connection."),w.jumpTo(0))})};return n.yield(l(5),6);case 6:g(),n.jumpToEnd()}})};Blast.asyncApiFunctions.push(["blinkstickSetColors",blinkstickSetColors]);Blockly.Blocks.joycon_read_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read").appendField(new Blockly.FieldDropdown([["accelerometers","accelerometers"],["actual accelerometer","actualAccelerometer"],["actual gyroscope","actualGyroscope"],["actual orientation","actualOrientation"],["actual orientation quaternion","actualOrientationQuaternion"],["gyroscopes","gyroscopes"],["quaternion","quaternion"]],this.propertyValidator),"property").appendField("property of Nintendo JoyCon");
this.setInputsInline(!1);this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads a property of a Nintendo JoyCon controller.");this.setHelpUrl("");this.firstTime=!0},propertyValidator:function(a){this.getSourceBlock().updateInputs(a);return a},updateInputs:function(a){this.removeInput("propertySubValue",!0);this.removeInput("propertySubValue2",!0);this.removeInput("propertySubValue3",!0);"accelerometers"===a&&(this.appendDummyInput("propertySubValue").appendField("accelerometer").appendField(new Blockly.FieldDropdown([["0",
"0"],["1","1"],["2","2"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue2"));"actualAccelerometer"===a&&this.appendDummyInput("propertySubValue").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue");"actualGyroscope"===a&&(this.appendDummyInput("propertySubValue").appendField("unit").appendField(new Blockly.FieldDropdown([["rps",
"rps"],["dps","dps"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue2"));"actualOrientation"===a&&this.appendDummyInput("propertySubValue").appendField("degrees").appendField(new Blockly.FieldDropdown([["alpa","alpha"],["beta","beta"],["gamma","gamma"]]),"propertySubValue");"actualOrientationQuaternion"===a&&this.appendDummyInput("propertySubValue").appendField("degrees").appendField(new Blockly.FieldDropdown([["alpa",
"alpha"],["beta","beta"],["gamma","gamma"]]),"propertySubValue");"gyroscopes"===a&&(this.appendDummyInput("propertySubValue").appendField("gyroscope").appendField(new Blockly.FieldDropdown([["0","0"],["1","1"],["2","2"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","0"],["y","1"],["z","2"]]),"propertySubValue2"),this.appendDummyInput("propertySubValue3").appendField("unit").appendField(new Blockly.FieldDropdown([["dps",
"dps"],["rps","rps"]]),"propertySubValue3"));"quaternion"===a&&this.appendDummyInput("propertySubValue").appendField("axis").appendField(new Blockly.FieldDropdown([["w","w"],["x","x"],["y","y"],["z","z"]]),"propertySubValue")}};Blast.Toolbox.addBlock("joycon_read_property","Properties");
Blockly.Blocks.joycon_button_events={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("Nintendo JoyCon");this.appendDummyInput().appendField("When").appendField(new Blockly.FieldDropdown([["A","a"],["B","b"],["X","x"],["Y","y"],["up","up"],["left","left"],["down","down"],["right","right"],["R","r"],["L","l"],["ZR","zr"],["ZL","zl"]]),"button").appendField("pressed");this.appendStatementInput("statements").setCheck(null);this.setInputsInline(!1);this.setColour(180);this.setTooltip("");
this.setHelpUrl("");this.requested=!1},addEvent:function(){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){Blast.eventInWorkspace.push(a.id);Blast.workspace.addChangeListener(function(c){return a.onDispose(c)});b.jumpToEnd()})},onchange:function(){this.isInFlyout||this.requested||!this.rendered||this.addEvent()},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==a.ids.indexOf(this.id)&&this.removeFromEvents()},removeFromEvents:function(){var a=
Blast.eventInWorkspace.indexOf(this.id);-1!==a&&Blast.eventInWorkspace.splice(a,1)}};Blast.Toolbox.addBlock("joycon_button_events","States and Events");Blockly.JavaScript.joycon_read_property=function(a){var b=a.getFieldValue("property"),c=a.getFieldValue("propertySubValue")||"",d=a.getFieldValue("propertySubValue2")||"",h=a.getFieldValue("propertySubValue3")||"";return["readJoyConProperty("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)+", '"+b+"', '"+c+"', '"+d+"', '"+h+"')",Blockly.JavaScript.ORDER_NONE]};
var readJoyConProperty=function(a,b,c,d,h,g){var m,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:if(!a)return Blast.throwError("No Joy-Con block set."),g(),n.return();m=Blast.Things.webHidDevices.get(a);if(!m)return Blast.throwError("Connected device is not a HID device.\nMake sure you are connecting the JoyCon via webHID"),g(),n.return();if(m.opened){n.jumpTo(2);break}n.setCatchFinallyBlocks(3);return n.yield(m.open(),5);case 5:n.leaveTryBlock(2);
break;case 3:n.enterCatchBlock(),Blast.throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(1406!==m.vendorId||8198!==m.productId&&8199!==m.productId)return Blast.throwError("The connected device is not a Joy-Con."),g(),n.return();8198===m.productId?p=new JoyConLeft(m):8199===m.productId&&(p=new JoyConRight(m));return n.yield(p.open(),6);case 6:return n.yield(p.enableStandardFullMode(),7);case 7:return n.yield(p.enableIMUMode(),8);case 8:l=function(q){var t;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){t=q.detail;if(!t||!t.actualOrientation)return w.return();p.removeEventListener("hidinput",l);""!==d?"accelerometers"===b?g(t[b][c][d].acc):"gyroscopes"===b?g(t[b][c][d][h]):g(t[b][c][d]):g(t[b][c]);w.jumpToEnd()})};if(p.eventListenerAttached){n.jumpTo(0);break}return n.yield(p.open(),10);case 10:return n.yield(p.enableStandardFullMode(),11);case 11:return n.yield(p.enableIMUMode(),12);case 12:return n.yield(p.enableVibration(),13);case 13:p.addEventListener("hidinput",
l),p.eventListenerAttached=!0,n.jumpToEnd()}})};Blast.asyncApiFunctions.push(["readJoyConProperty",readJoyConProperty]);
Blockly.JavaScript.joycon_button_events=function(a){var b=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE),c=Blockly.JavaScript.quote_(a.getFieldValue("button"));a=Blockly.JavaScript.quote_(Blockly.JavaScript.statementToCode(a,"statements"));Blockly.JavaScript.definitions_.eventHandlers=(Blockly.JavaScript.definitions_.eventHandlers||"")+("handleJoyConButtons("+b+", "+c+", "+a+");\n");return""};
var handleJoyConButtons=function(a,b,c,d){var h,g,m,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){switch(l.nextAddress){case 1:if(!a)return Blast.throwError("No Joy-Con block set."),d(),l.return();h=Blast.Things.webHidDevices.get(a);if(!h)return Blast.throwError("Connected device is not a HID device.\nMake sure you are connecting the JoyCon via webHID"),d(),l.return();if(h.opened){l.jumpTo(2);break}l.setCatchFinallyBlocks(3);return l.yield(h.open(),5);case 5:l.leaveTryBlock(2);
break;case 3:l.enterCatchBlock(),Blast.throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(1406!==h.vendorId||8198!==h.productId&&8199!==h.productId)return Blast.throwError("The connected device is not a Joy-Con."),d(),l.return();8198===h.productId?g=new JoyConLeft(h):8199===h.productId&&(g=new JoyConRight(h));return l.yield(g.open(),6);case 6:return l.yield(g.enableStandardFullMode(),7);case 7:return l.yield(g.enableIMUMode(),8);case 8:m=!1;p=function(n){var q,
t,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(z){q=n.detail;if(!q||!q.actualOrientation)return z.return();q.buttonStatus[b]?m||(m=!0,Blast.Interrupted=!1,t=new Interpreter(""),t.stateStack[0].scope=Blast.Interpreter.globalScope,t.appendCode(c),w=function(){try{t.step()?setTimeout(w,5):Blast.Interrupted=!1}catch(C){Blast.throwError("Error executing program:\n "+e),console.error(C)}},w()):m=!1;z.jumpToEnd()})};Blast.deviceEventHandlers.push({device:g,type:"hidinput",fn:p});if(g.eventListenerAttached){l.jumpTo(0);
break}return l.yield(g.open(),10);case 10:return l.yield(g.enableStandardFullMode(),11);case 11:return l.yield(g.enableIMUMode(),12);case 12:return l.yield(g.enableVibration(),13);case 13:g.addEventListener("hidinput",p),g.eventListenerAttached=!0,l.jumpToEnd()}})};Blast.apiFunctions.push(["handleJoyConButtons",handleJoyConButtons]);Blockly.Blocks.mirobot_pickup={init:function(){this.appendDummyInput().appendField("Robot-arm, pick up").appendField(new Blockly.FieldDropdown([["blue","BLUE"],["red","RED"],["yellow","YELLOW"],["green","GREEN"]]),"box").appendField("box");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("Invokes pick-up action for the selected box.");this.setHelpUrl("")}};Blast.Toolbox.addBlock("mirobot_pickup","actions");Blockly.JavaScript.mirobot_pickup=function(a){return"mirobotPickUpBox("+Blockly.JavaScript.quote_(a.getFieldValue("box").toLowerCase())+");\n"};
var mirobotPickUp=function(a,b){var c,d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){c="https://bot.rapidthings.eu/thing/action/grab_"+a.toLowerCase();d={"Content-Type":"application/json",Accept:"application/json"};h={method:"POST",headers:new Headers(d)};fetch(c,h).then(Blast.handleFetchErrors).then(function(m){b(m.status)}).catch(function(m){Blast.throwError(m.message+"\nSee console for details.")});g.jumpToEnd()})};Blast.asyncApiFunctions.push(["mirobot_pickup",mirobotPickUp]);Blockly.Blocks.read_ruuvi_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read").appendField(new Blockly.FieldDropdown([["temperature","temperature"],["humidity","humidity"],["pressure","pressure"],["acceleration X","accelerationX"],["acceleration Y","accelerationY"],["acceleration Z","accelerationZ"],["battery voltage","batteryVoltage"],["txPower","txPower"],["movement counter","movementCounter"],["measurement sequence number","measurementSequenceNumber"]]),
"measurement").appendField("property of RuuviTag");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads a property of a Ruuvi Tag.");this.setHelpUrl("");this.firstTime=!0},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later."),this.dispose()))}};Blast.Toolbox.addBlock("read_ruuvi_property","Properties");
Blast.Bluetooth.scanBlocks.push("read_ruuvi_property");Blockly.JavaScript.read_ruuvi_property=function(a){var b=Blockly.JavaScript.quote_(a.getFieldValue("measurement"));a=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC);return["getRuuviProperty("+b+", "+a+")",Blockly.JavaScript.ORDER_NONE]};
var getRuuviProperty=function(a,b,c){var d,h,g,m,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return d=function(q){var t={},w=q[0]&255,z=q[1]<<8|q[2]&255;32767<z&&(z-=65535);var C=((q[3]&255)<<8|q[4]&255)/400,D=((q[5]&255)<<8|q[6]&255)+5E4,B=(q[7]<<8|q[8]&255)/1E3,v=(q[9]<<8|q[10]&255)/1E3,x=(q[11]<<8|q[12]&255)/1E3,y=(q[13]&255)<<8|q[14]&255,E=q[15]&255;q=(q[16]&255)<<8|q[17]&255;t.destination_endpoint=w;t.temperature=z/200;t.humidity=C;t.pressure=D;t.accelerationX=
B;t.accelerationY=v;t.accelerationZ=x;t.batteryVoltage=(y>>>5)/1E3+1.6;t.txPower=2*(y&31)-40;t.movementCounter=E;t.measurementSequenceNumber=q;return t},h=function(q){if(30>q){var t=Blast.Bluetooth.LEScanResults[b];if(t){t=$jscomp.makeIterator(t);for(var w=t.next();!w.done;w=t.next())if((w=w.value.manufacturerData.get(1177))&&5==w.getUint8(0))return w}return new Promise(function(z){setTimeout(function(){z(h(q+1))},1E3)})}},Blast.Bluetooth.startLEScan(b),n.yield(h(0),2);(g=n.yieldResult)||Blast.throwError("Timed out. No BLE advertising data found for "+
b);m=[];for(p=0;p<g.byteLength;p++)m.push("0x"+("00"+g.getUint8(p).toString(16)).slice(-2));l=d(m);c(l[a]);n.jumpToEnd()})};Blast.asyncApiFunctions.push(["getRuuviProperty",getRuuviProperty]);Blockly.Blocks.streamdeck_buttons={init:function(){var a=this;this.appendValueInput("id").setCheck("Thing").appendField("Streamdeck mini");this.appendDummyInput().appendField("on button").appendField(new Blockly.FieldDropdown([["up","up"],["down","down"]]),"upDown");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button1")}),"button1").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,
"button2")}),"button2").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button3")}),"button3");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button4")}),"button4").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button5")}),"button5").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,
"button6")}),"button6");this.appendDummyInput().appendField("do");this.appendStatementInput("statements").setCheck(null);this.setColour(180);this.setTooltip("");this.setHelpUrl("");this.requested=!1;this.keyState=Array(6).fill(!1)},uncheckAllOtherCheckboxes:function(a,b){if("TRUE"===a)for(a=1;6>=a;a++)"button"+a!=b&&this.setFieldValue("FALSE","button"+a)},addEvent:function(){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){Blast.eventInWorkspace.push(a.id);Blast.workspace.addChangeListener(function(c){return a.onDispose(c)});
b.jumpToEnd()})},onchange:function(){this.isInFlyout||this.requested||!this.rendered||this.addEvent()},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==a.ids.indexOf(this.id)&&this.removeFromEvents()},removeFromEvents:function(){var a=Blast.eventInWorkspace.indexOf(this.id);-1!==a&&Blast.eventInWorkspace.splice(a,1)}};Blast.Toolbox.addBlock("streamdeck_buttons","States and Events");Blockly.JavaScript.streamdeck_buttons=function(a){var b="TRUE"==a.getFieldValue("button1")?1:0,c="TRUE"==a.getFieldValue("button2")?1:0,d="TRUE"==a.getFieldValue("button3")?1:0,h="TRUE"==a.getFieldValue("button4")?1:0,g="TRUE"==a.getFieldValue("button5")?1:0,m="TRUE"==a.getFieldValue("button6")?1:0,p=Blockly.JavaScript.quote_(a.getFieldValue("upDown")),l=Blockly.JavaScript.valueToCode(a,"id",Blockly.JavaScript.ORDER_NONE)||null;b=Blockly.JavaScript.quote_(""+b+c+d+h+g+m);a=Blockly.JavaScript.quote_(Blockly.JavaScript.statementToCode(a,
"statements"));Blockly.JavaScript.definitions_.eventHandlers=(Blockly.JavaScript.definitions_.eventHandlers||"")+("handleStreamdeck("+l+", "+b+", "+p+", "+a+");\n");return""};
var handleStreamdeck=function(a,b,c,d){var h,g,m,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:if(null===a)return Blast.throwError("No streamdeck block set."),callback(),n.return();h=Blast.Things.webHidDevices.get(a);if(!h)return Blast.throwError("Connected device is not a HID device.\nMake sure you are connecting the Streamdeck via webHID"),callback(),n.return();n.setCatchFinallyBlocks(2);return n.yield(StreamDeck.openDevice(h),4);case 4:g=n.yieldResult;
n.leaveTryBlock(3);break;case 2:m=n.enterCatchBlock();if("InvalidStateError"!=m.name)return Blast.throwError(m),callback(),n.return();h.close();return n.yield(StreamDeck.openDevice(h),6);case 6:g=n.yieldResult;case 3:for(l=0;l<b.length;l++)if(1===b.indexOf(l)){p=l;break}if(void 0===p)return callback(),n.return();g.on(c,function(q){if(q===p){Blast.Interrupted=!0;var t=new Interpreter("");t.stateStack[0].scope=Blast.Interpreter.globalScope;t.appendCode(d);var w=function(){try{t.step()?setTimeout(w,
5):Blast.Interrupted=!1}catch(z){Blast.throwError("Error executing program:\n "+e),console.error(z)}};w()}});Blast.cleanUpFunctions.push(function(){g.close();g.removeAllListeners()});n.jumpToEnd()}})};Blast.apiFunctions.push(["handleStreamdeck",handleStreamdeck]);/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <https://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
require=function(){function a(b,c,d){function h(p,l){if(!c[p]){if(!b[p]){var n="function"==typeof require&&require;if(!l&&n)return n(p,!0);if(g)return g(p,!0);l=Error("Cannot find module '"+p+"'");throw l.code="MODULE_NOT_FOUND",l;}l=c[p]={exports:{}};b[p][0].call(l.exports,function(q){return h(b[p][1][q]||q)},l,l.exports,a,b,c,d)}return c[p].exports}for(var g="function"==typeof require&&require,m=0;m<d.length;m++)h(d[m]);return h}return a}()({1:[function(a,b,c){function d(p){var l=p.length;if(0<
l%4)throw Error("Invalid string. Length must be a multiple of 4");p=p.indexOf("=");-1===p&&(p=l);return[p,p===l?0:4-p%4]}c.byteLength=function(p){p=d(p);var l=p[1];return 3*(p[0]+l)/4-l};c.toByteArray=function(p){var l=d(p);var n=l[0];l=l[1];var q=new m(3*(n+l)/4-l),t=0,w=0<l?n-4:n,z;for(z=0;z<w;z+=4)n=g[p.charCodeAt(z)]<<18|g[p.charCodeAt(z+1)]<<12|g[p.charCodeAt(z+2)]<<6|g[p.charCodeAt(z+3)],q[t++]=n>>16&255,q[t++]=n>>8&255,q[t++]=n&255;2===l&&(n=g[p.charCodeAt(z)]<<2|g[p.charCodeAt(z+1)]>>4,q[t++]=
n&255);1===l&&(n=g[p.charCodeAt(z)]<<10|g[p.charCodeAt(z+1)]<<4|g[p.charCodeAt(z+2)]>>2,q[t++]=n>>8&255,q[t++]=n&255);return q};c.fromByteArray=function(p){for(var l=p.length,n=l%3,q=[],t=0,w=l-n;t<w;t+=16383){for(var z=q,C=z.push,D,B=p,v=t+16383>w?w:t+16383,x=[],y=t;y<v;y+=3)D=(B[y]<<16&16711680)+(B[y+1]<<8&65280)+(B[y+2]&255),x.push(h[D>>18&63]+h[D>>12&63]+h[D>>6&63]+h[D&63]);D=x.join("");C.call(z,D)}1===n?(p=p[l-1],q.push(h[p>>2]+h[p<<4&63]+"==")):2===n&&(p=(p[l-2]<<8)+p[l-1],q.push(h[p>>10]+h[p>>
4&63]+h[p<<2&63]+"="));return q.join("")};var h=[],g=[],m="undefined"!==typeof Uint8Array?Uint8Array:Array;for(a=0;64>a;++a)h[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a],g["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;g[45]=62;g[95]=63},{}],2:[function(a,b,c){(function(d){(function(){function h(f){if(f>Q)throw new RangeError('The value "'+f+'" is invalid for option "size"');f=new Uint8Array(f);f.__proto__=g.prototype;return f}function g(f,
k,r){if("number"===typeof f){if("string"===typeof k)throw new TypeError('The "string" argument must be of type string. Received type number');return l(f)}return m(f,k,r)}function m(f,k,r){if("string"===typeof f){var u=k;if("string"!==typeof u||""===u)u="utf8";if(!g.isEncoding(u))throw new TypeError("Unknown encoding: "+u);k=w(f,u)|0;r=h(k);f=r.write(f,u);f!==k&&(r=r.slice(0,f));return r}if(ArrayBuffer.isView(f))return n(f);if(null==f)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+
typeof f);if(M(f,ArrayBuffer)||f&&M(f.buffer,ArrayBuffer)){if(0>k||f.byteLength<k)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<k+(r||0))throw new RangeError('"length" is outside of buffer bounds');f=void 0===k&&void 0===r?new Uint8Array(f):void 0===r?new Uint8Array(f,k):new Uint8Array(f,k,r);f.__proto__=g.prototype;return f}if("number"===typeof f)throw new TypeError('The "value" argument must not be of type number. Received type number');u=f.valueOf&&f.valueOf();if(null!=
u&&u!==f)return g.from(u,k,r);if(u=q(f))return u;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof f[Symbol.toPrimitive])return g.from(f[Symbol.toPrimitive]("string"),k,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);}function p(f){if("number"!==typeof f)throw new TypeError('"size" argument must be of type number');if(0>f)throw new RangeError('The value "'+f+'" is invalid for option "size"');
}function l(f){p(f);return h(0>f?0:t(f)|0)}function n(f){for(var k=0>f.length?0:t(f.length)|0,r=h(k),u=0;u<k;u+=1)r[u]=f[u]&255;return r}function q(f){if(g.isBuffer(f)){var k=t(f.length)|0,r=h(k);if(0===r.length)return r;f.copy(r,0,0,k);return r}if(void 0!==f.length)return(k="number"!==typeof f.length)||(k=f.length,k=k!==k),k?h(0):n(f);if("Buffer"===f.type&&Array.isArray(f.data))return n(f.data)}function t(f){if(f>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+
" bytes");return f|0}function w(f,k){if(g.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||M(f,ArrayBuffer))return f.byteLength;if("string"!==typeof f)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);var r=f.length,u=2<arguments.length&&!0===arguments[2];if(!u&&0===r)return 0;for(var A=!1;;)switch(k){case "ascii":case "latin1":case "binary":return r;case "utf8":case "utf-8":return L(f).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
r;case "hex":return r>>>1;case "base64":return S(f).length;default:if(A)return u?-1:L(f).length;k=(""+k).toLowerCase();A=!0}}function z(f,k,r){var u=!1;if(void 0===k||0>k)k=0;if(k>this.length)return"";if(void 0===r||r>this.length)r=this.length;if(0>=r)return"";r>>>=0;k>>>=0;if(r<=k)return"";for(f||(f="utf8");;)switch(f){case "hex":f=k;k=r;r=this.length;if(!f||0>f)f=0;if(!k||0>k||k>r)k=r;u="";for(r=f;r<k;++r)f=u,u=this[r],u=16>u?"0"+u.toString(16):u.toString(16),u=f+u;return u;case "utf8":case "utf-8":return v(this,
k,r);case "ascii":f="";for(r=Math.min(this.length,r);k<r;++k)f+=String.fromCharCode(this[k]&127);return f;case "latin1":case "binary":f="";for(r=Math.min(this.length,r);k<r;++k)f+=String.fromCharCode(this[k]);return f;case "base64":return k=0===k&&r===this.length?R.fromByteArray(this):R.fromByteArray(this.slice(k,r)),k;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":k=this.slice(k,r);r="";for(f=0;f<k.length;f+=2)r+=String.fromCharCode(k[f]+256*k[f+1]);return r;default:if(u)throw new TypeError("Unknown encoding: "+
f);f=(f+"").toLowerCase();u=!0}}function C(f,k,r){var u=f[k];f[k]=f[r];f[r]=u}function D(f,k,r,u,A){if(0===f.length)return-1;"string"===typeof r?(u=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648);r=+r;r!==r&&(r=A?0:f.length-1);0>r&&(r=f.length+r);if(r>=f.length){if(A)return-1;r=f.length-1}else if(0>r)if(A)r=0;else return-1;"string"===typeof k&&(k=g.from(k,u));if(g.isBuffer(k))return 0===k.length?-1:B(f,k,r,u,A);if("number"===typeof k)return k&=255,"function"===typeof Uint8Array.prototype.indexOf?
A?Uint8Array.prototype.indexOf.call(f,k,r):Uint8Array.prototype.lastIndexOf.call(f,k,r):B(f,[k],r,u,A);throw new TypeError("val must be string, number or Buffer");}function B(f,k,r,u,A){function F(O,T){return 1===I?O[T]:O.readUInt16BE(T*I)}var I=1,J=f.length,K=k.length;if(void 0!==u&&(u=String(u).toLowerCase(),"ucs2"===u||"ucs-2"===u||"utf16le"===u||"utf-16le"===u)){if(2>f.length||2>k.length)return-1;I=2;J/=2;K/=2;r/=2}if(A)for(u=-1;r<J;r++)if(F(f,r)===F(k,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===
K)return u*I}else-1!==u&&(r-=r-u),u=-1;else for(r+K>J&&(r=J-K);0<=r;r--){J=!0;for(u=0;u<K;u++)if(F(f,r+u)!==F(k,u)){J=!1;break}if(J)return r}return-1}function v(f,k,r){r=Math.min(f.length,r);for(var u=[];k<r;){var A=f[k],F=null,I=239<A?4:223<A?3:191<A?2:1;if(k+I<=r)switch(I){case 1:128>A&&(F=A);break;case 2:var J=f[k+1];128===(J&192)&&(A=(A&31)<<6|J&63,127<A&&(F=A));break;case 3:J=f[k+1];var K=f[k+2];128===(J&192)&&128===(K&192)&&(A=(A&15)<<12|(J&63)<<6|K&63,2047<A&&(55296>A||57343<A)&&(F=A));break;
case 4:J=f[k+1];K=f[k+2];var O=f[k+3];128===(J&192)&&128===(K&192)&&128===(O&192)&&(A=(A&15)<<18|(J&63)<<12|(K&63)<<6|O&63,65535<A&&1114112>A&&(F=A))}null===F?(F=65533,I=1):65535<F&&(F-=65536,u.push(F>>>10&1023|55296),F=56320|F&1023);u.push(F);k+=I}f=u.length;if(f<=U)u=String.fromCharCode.apply(String,u);else{r="";for(k=0;k<f;)r+=String.fromCharCode.apply(String,u.slice(k,k+=U));u=r}return u}function x(f,k,r){if(0!==f%1||0>f)throw new RangeError("offset is not uint");if(f+k>r)throw new RangeError("Trying to access beyond buffer length");
}function y(f,k,r,u,A,F){if(!g.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>A||k<F)throw new RangeError('"value" argument is out of bounds');if(r+u>f.length)throw new RangeError("Index out of range");}function E(f,k,r,u,A,F){if(r+u>f.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range");}function G(f,k,r,u,A){k=+k;r>>>=0;A||E(f,k,r,4,3.4028234663852886E38,-3.4028234663852886E38);N.write(f,k,r,u,23,4);return r+4}function H(f,
k,r,u,A){k=+k;r>>>=0;A||E(f,k,r,8,1.7976931348623157E308,-1.7976931348623157E308);N.write(f,k,r,u,52,8);return r+8}function L(f,k){k=k||Infinity;for(var r,u=f.length,A=null,F=[],I=0;I<u;++I){r=f.charCodeAt(I);if(55295<r&&57344>r){if(!A){if(56319<r){-1<(k-=3)&&F.push(239,191,189);continue}else if(I+1===u){-1<(k-=3)&&F.push(239,191,189);continue}A=r;continue}if(56320>r){-1<(k-=3)&&F.push(239,191,189);A=r;continue}r=(A-55296<<10|r-56320)+65536}else A&&-1<(k-=3)&&F.push(239,191,189);A=null;if(128>r){if(0>
--k)break;F.push(r)}else if(2048>r){if(0>(k-=2))break;F.push(r>>6|192,r&63|128)}else if(65536>r){if(0>(k-=3))break;F.push(r>>12|224,r>>6&63|128,r&63|128)}else if(1114112>r){if(0>(k-=4))break;F.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw Error("Invalid code point");}return F}function V(f){for(var k=[],r=0;r<f.length;++r)k.push(f.charCodeAt(r)&255);return k}function S(f){var k=R,r=k.toByteArray;f=f.split("=")[0];f=f.trim().replace(W,"");if(2>f.length)f="";else for(;0!==f.length%4;)f+=
"=";return r.call(k,f)}function P(f,k,r,u){for(var A=0;A<u&&!(A+r>=k.length||A>=f.length);++A)k[A+r]=f[A];return A}function M(f,k){return f instanceof k||null!=f&&null!=f.constructor&&null!=f.constructor.name&&f.constructor.name===k.name}var R=a("base64-js"),N=a("ieee754");c.Buffer=g;c.SlowBuffer=function(f){+f!=f&&(f=0);return g.alloc(+f)};c.INSPECT_MAX_BYTES=50;var Q=2147483647;c.kMaxLength=Q;g.TYPED_ARRAY_SUPPORT=function(){try{var f=new Uint8Array(1);f.__proto__={__proto__:Uint8Array.prototype,
foo:function(){return 42}};return 42===f.foo()}catch(k){return!1}}();g.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}});Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}});
"undefined"!==typeof Symbol&&null!=Symbol.species&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1});g.poolSize=8192;g.from=function(f,k,r){return m(f,k,r)};g.prototype.__proto__=Uint8Array.prototype;g.__proto__=Uint8Array;g.alloc=function(f,k,r){p(f);f=0>=f?h(f):void 0!==k?"string"===typeof r?h(f).fill(k,r):h(f).fill(k):h(f);return f};g.allocUnsafe=function(f){return l(f)};g.allocUnsafeSlow=function(f){return l(f)};g.isBuffer=function(f){return null!=
f&&!0===f._isBuffer&&f!==g.prototype};g.compare=function(f,k){M(f,Uint8Array)&&(f=g.from(f,f.offset,f.byteLength));M(k,Uint8Array)&&(k=g.from(k,k.offset,k.byteLength));if(!g.isBuffer(f)||!g.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===k)return 0;for(var r=f.length,u=k.length,A=0,F=Math.min(r,u);A<F;++A)if(f[A]!==k[A]){r=f[A];u=k[A];break}return r<u?-1:u<r?1:0};g.isEncoding=function(f){switch(String(f).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};g.concat=function(f,k){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(0===f.length)return g.alloc(0);var r;if(void 0===k)for(r=k=0;r<f.length;++r)k+=f[r].length;k=g.allocUnsafe(k);var u=0;for(r=0;r<f.length;++r){var A=f[r];M(A,Uint8Array)&&(A=g.from(A));if(!g.isBuffer(A))throw new TypeError('"list" argument must be an Array of Buffers');A.copy(k,u);u+=A.length}return k};g.byteLength=w;g.prototype._isBuffer=!0;g.prototype.swap16=function(){var f=
this.length;if(0!==f%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<f;k+=2)C(this,k,k+1);return this};g.prototype.swap32=function(){var f=this.length;if(0!==f%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<f;k+=4)C(this,k,k+3),C(this,k+1,k+2);return this};g.prototype.swap64=function(){var f=this.length;if(0!==f%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<f;k+=8)C(this,k,k+7),C(this,k+1,k+6),
C(this,k+2,k+5),C(this,k+3,k+4);return this};g.prototype.toString=function(){var f=this.length;return 0===f?"":0===arguments.length?v(this,0,f):z.apply(this,arguments)};g.prototype.toLocaleString=g.prototype.toString;g.prototype.equals=function(f){if(!g.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:0===g.compare(this,f)};g.prototype.inspect=function(){var f=c.INSPECT_MAX_BYTES;var k=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim();this.length>f&&(k+=" ... ");
return"<Buffer "+k+">"};g.prototype.compare=function(f,k,r,u,A){M(f,Uint8Array)&&(f=g.from(f,f.offset,f.byteLength));if(!g.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);void 0===k&&(k=0);void 0===r&&(r=f?f.length:0);void 0===u&&(u=0);void 0===A&&(A=this.length);if(0>k||r>f.length||0>u||A>this.length)throw new RangeError("out of range index");if(u>=A&&k>=r)return 0;if(u>=A)return-1;if(k>=r)return 1;k>>>=0;r>>>=0;u>>>=0;A>>>=
0;if(this===f)return 0;var F=A-u,I=r-k,J=Math.min(F,I);u=this.slice(u,A);f=f.slice(k,r);for(k=0;k<J;++k)if(u[k]!==f[k]){F=u[k];I=f[k];break}return F<I?-1:I<F?1:0};g.prototype.includes=function(f,k,r){return-1!==this.indexOf(f,k,r)};g.prototype.indexOf=function(f,k,r){return D(this,f,k,r,!0)};g.prototype.lastIndexOf=function(f,k,r){return D(this,f,k,r,!1)};g.prototype.write=function(f,k,r,u){if(void 0===k)u="utf8",r=this.length,k=0;else if(void 0===r&&"string"===typeof k)u=k,r=this.length,k=0;else if(isFinite(k))k>>>=
0,isFinite(r)?(r>>>=0,void 0===u&&(u="utf8")):(u=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var A=this.length-k;if(void 0===r||r>A)r=A;if(0<f.length&&(0>r||0>k)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");u||(u="utf8");for(A=!1;;)switch(u){case "hex":a:{k=Number(k)||0;u=this.length-k;r?(r=Number(r),r>u&&(r=u)):r=u;u=f.length;r>u/2&&(r=u/2);for(u=0;u<r;++u){A=parseInt(f.substr(2*u,2),16);if(A!==A){f=u;break a}this[k+
u]=A}f=u}return f;case "utf8":case "utf-8":return P(L(f,this.length-k),this,k,r);case "ascii":return P(V(f),this,k,r);case "latin1":case "binary":return P(V(f),this,k,r);case "base64":return P(S(f),this,k,r);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":u=f;A=this.length-k;for(var F=[],I=0;I<u.length&&!(0>(A-=2));++I){var J=u.charCodeAt(I);f=J>>8;J%=256;F.push(J);F.push(f)}return P(F,this,k,r);default:if(A)throw new TypeError("Unknown encoding: "+u);u=(""+u).toLowerCase();A=!0}};g.prototype.toJSON=
function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var U=4096;g.prototype.slice=function(f,k){var r=this.length;f=~~f;k=void 0===k?r:~~k;0>f?(f+=r,0>f&&(f=0)):f>r&&(f=r);0>k?(k+=r,0>k&&(k=0)):k>r&&(k=r);k<f&&(k=f);f=this.subarray(f,k);f.__proto__=g.prototype;return f};g.prototype.readUIntLE=function(f,k,r){f>>>=0;k>>>=0;r||x(f,k,this.length);r=this[f];for(var u=1,A=0;++A<k&&(u*=256);)r+=this[f+A]*u;return r};g.prototype.readUIntBE=function(f,k,r){f>>>=0;k>>>=0;r||
x(f,k,this.length);r=this[f+--k];for(var u=1;0<k&&(u*=256);)r+=this[f+--k]*u;return r};g.prototype.readUInt8=function(f,k){f>>>=0;k||x(f,1,this.length);return this[f]};g.prototype.readUInt16LE=function(f,k){f>>>=0;k||x(f,2,this.length);return this[f]|this[f+1]<<8};g.prototype.readUInt16BE=function(f,k){f>>>=0;k||x(f,2,this.length);return this[f]<<8|this[f+1]};g.prototype.readUInt32LE=function(f,k){f>>>=0;k||x(f,4,this.length);return(this[f]|this[f+1]<<8|this[f+2]<<16)+16777216*this[f+3]};g.prototype.readUInt32BE=
function(f,k){f>>>=0;k||x(f,4,this.length);return 16777216*this[f]+(this[f+1]<<16|this[f+2]<<8|this[f+3])};g.prototype.readIntLE=function(f,k,r){f>>>=0;k>>>=0;r||x(f,k,this.length);r=this[f];for(var u=1,A=0;++A<k&&(u*=256);)r+=this[f+A]*u;r>=128*u&&(r-=Math.pow(2,8*k));return r};g.prototype.readIntBE=function(f,k,r){f>>>=0;k>>>=0;r||x(f,k,this.length);r=k;for(var u=1,A=this[f+--r];0<r&&(u*=256);)A+=this[f+--r]*u;A>=128*u&&(A-=Math.pow(2,8*k));return A};g.prototype.readInt8=function(f,k){f>>>=0;k||
x(f,1,this.length);return this[f]&128?-1*(255-this[f]+1):this[f]};g.prototype.readInt16LE=function(f,k){f>>>=0;k||x(f,2,this.length);f=this[f]|this[f+1]<<8;return f&32768?f|4294901760:f};g.prototype.readInt16BE=function(f,k){f>>>=0;k||x(f,2,this.length);f=this[f+1]|this[f]<<8;return f&32768?f|4294901760:f};g.prototype.readInt32LE=function(f,k){f>>>=0;k||x(f,4,this.length);return this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24};g.prototype.readInt32BE=function(f,k){f>>>=0;k||x(f,4,this.length);return this[f]<<
24|this[f+1]<<16|this[f+2]<<8|this[f+3]};g.prototype.readFloatLE=function(f,k){f>>>=0;k||x(f,4,this.length);return N.read(this,f,!0,23,4)};g.prototype.readFloatBE=function(f,k){f>>>=0;k||x(f,4,this.length);return N.read(this,f,!1,23,4)};g.prototype.readDoubleLE=function(f,k){f>>>=0;k||x(f,8,this.length);return N.read(this,f,!0,52,8)};g.prototype.readDoubleBE=function(f,k){f>>>=0;k||x(f,8,this.length);return N.read(this,f,!1,52,8)};g.prototype.writeUIntLE=function(f,k,r,u){f=+f;k>>>=0;r>>>=0;u||y(this,
f,k,r,Math.pow(2,8*r)-1,0);u=1;var A=0;for(this[k]=f&255;++A<r&&(u*=256);)this[k+A]=f/u&255;return k+r};g.prototype.writeUIntBE=function(f,k,r,u){f=+f;k>>>=0;r>>>=0;u||y(this,f,k,r,Math.pow(2,8*r)-1,0);u=r-1;var A=1;for(this[k+u]=f&255;0<=--u&&(A*=256);)this[k+u]=f/A&255;return k+r};g.prototype.writeUInt8=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,1,255,0);this[k]=f&255;return k+1};g.prototype.writeUInt16LE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,2,65535,0);this[k]=f&255;this[k+1]=f>>>8;return k+
2};g.prototype.writeUInt16BE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,2,65535,0);this[k]=f>>>8;this[k+1]=f&255;return k+2};g.prototype.writeUInt32LE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,4,4294967295,0);this[k+3]=f>>>24;this[k+2]=f>>>16;this[k+1]=f>>>8;this[k]=f&255;return k+4};g.prototype.writeUInt32BE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,4,4294967295,0);this[k]=f>>>24;this[k+1]=f>>>16;this[k+2]=f>>>8;this[k+3]=f&255;return k+4};g.prototype.writeIntLE=function(f,k,r,u){f=+f;k>>>=0;u||(u=
Math.pow(2,8*r-1),y(this,f,k,r,u-1,-u));u=0;var A=1,F=0;for(this[k]=f&255;++u<r&&(A*=256);)0>f&&0===F&&0!==this[k+u-1]&&(F=1),this[k+u]=(f/A>>0)-F&255;return k+r};g.prototype.writeIntBE=function(f,k,r,u){f=+f;k>>>=0;u||(u=Math.pow(2,8*r-1),y(this,f,k,r,u-1,-u));u=r-1;var A=1,F=0;for(this[k+u]=f&255;0<=--u&&(A*=256);)0>f&&0===F&&0!==this[k+u+1]&&(F=1),this[k+u]=(f/A>>0)-F&255;return k+r};g.prototype.writeInt8=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,1,127,-128);0>f&&(f=255+f+1);this[k]=f&255;return k+
1};g.prototype.writeInt16LE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,2,32767,-32768);this[k]=f&255;this[k+1]=f>>>8;return k+2};g.prototype.writeInt16BE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,2,32767,-32768);this[k]=f>>>8;this[k+1]=f&255;return k+2};g.prototype.writeInt32LE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,4,2147483647,-2147483648);this[k]=f&255;this[k+1]=f>>>8;this[k+2]=f>>>16;this[k+3]=f>>>24;return k+4};g.prototype.writeInt32BE=function(f,k,r){f=+f;k>>>=0;r||y(this,f,k,4,2147483647,
-2147483648);0>f&&(f=4294967295+f+1);this[k]=f>>>24;this[k+1]=f>>>16;this[k+2]=f>>>8;this[k+3]=f&255;return k+4};g.prototype.writeFloatLE=function(f,k,r){return G(this,f,k,!0,r)};g.prototype.writeFloatBE=function(f,k,r){return G(this,f,k,!1,r)};g.prototype.writeDoubleLE=function(f,k,r){return H(this,f,k,!0,r)};g.prototype.writeDoubleBE=function(f,k,r){return H(this,f,k,!1,r)};g.prototype.copy=function(f,k,r,u){if(!g.isBuffer(f))throw new TypeError("argument should be a Buffer");r||(r=0);u||0===u||
(u=this.length);k>=f.length&&(k=f.length);k||(k=0);0<u&&u<r&&(u=r);if(u===r||0===f.length||0===this.length)return 0;if(0>k)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("Index out of range");if(0>u)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length);f.length-k<u-r&&(u=f.length-k+r);var A=u-r;if(this===f&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(k,r,u);else if(this===f&&r<k&&k<u)for(u=A-1;0<=u;--u)f[u+
k]=this[u+r];else Uint8Array.prototype.set.call(f,this.subarray(r,u),k);return A};g.prototype.fill=function(f,k,r,u){if("string"===typeof f){"string"===typeof k?(u=k,k=0,r=this.length):"string"===typeof r&&(u=r,r=this.length);if(void 0!==u&&"string"!==typeof u)throw new TypeError("encoding must be a string");if("string"===typeof u&&!g.isEncoding(u))throw new TypeError("Unknown encoding: "+u);if(1===f.length){var A=f.charCodeAt(0);if("utf8"===u&&128>A||"latin1"===u)f=A}}else"number"===typeof f&&(f&=
255);if(0>k||this.length<k||this.length<r)throw new RangeError("Out of range index");if(r<=k)return this;k>>>=0;r=void 0===r?this.length:r>>>0;f||(f=0);if("number"===typeof f)for(u=k;u<r;++u)this[u]=f;else{A=g.isBuffer(f)?f:g.from(f,u);var F=A.length;if(0===F)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(u=0;u<r-k;++u)this[u+k]=A[u%F]}return this};var W=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,a("buffer").Buffer)},{"base64-js":1,buffer:2,ieee754:4}],3:[function(a,
b,c){function d(){d.init.call(this)}function h(v){if("function"!==typeof v)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v);}function g(v,x,y,E){h(y);var G=v._events;if(void 0===G)G=v._events=Object.create(null),v._eventsCount=0;else{void 0!==G.newListener&&(v.emit("newListener",x,y.listener?y.listener:y),G=v._events);var H=G[x]}void 0===H?(G[x]=y,++v._eventsCount):("function"===typeof H?H=G[x]=E?[y,H]:[H,y]:E?H.unshift(y):H.push(y),y=void 0===v._maxListeners?
d.defaultMaxListeners:v._maxListeners,0<y&&H.length>y&&!H.warned&&(H.warned=!0,y=Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(x)+" listeners added. Use emitter.setMaxListeners() to increase limit"),y.name="MaxListenersExceededWarning",y.emitter=v,y.type=x,y.count=H.length,console&&console.warn&&console.warn(y)));return v}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):
this.listener.apply(this.target,arguments)}function p(v,x,y){v={fired:!1,wrapFn:void 0,target:v,type:x,listener:y};x=m.bind(v);x.listener=y;return v.wrapFn=x}function l(v,x,y){v=v._events;if(void 0===v)return[];x=v[x];if(void 0===x)return[];if("function"===typeof x)return y?[x.listener||x]:[x];if(y)for(y=Array(x.length),v=0;v<y.length;++v)y[v]=x[v].listener||x[v];else y=q(x,x.length);return y}function n(v){var x=this._events;if(void 0!==x){v=x[v];if("function"===typeof v)return 1;if(void 0!==v)return v.length}return 0}
function q(v,x){for(var y=Array(x),E=0;E<x;++E)y[E]=v[E];return y}function t(v,x,y){"function"===typeof v.on&&w(v,"error",x,y)}function w(v,x,y,E){if("function"===typeof v.on)if(E.once)v.once(x,y);else v.on(x,y);else if("function"===typeof v.addEventListener)v.addEventListener(x,function L(H){E.once&&v.removeEventListener(x,L);y(H)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v);}var z=(a="object"===typeof Reflect?Reflect:null)&&"function"===
typeof a.apply?a.apply:function(v,x,y){return Function.prototype.apply.call(v,x,y)};var C=a&&"function"===typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:function(v){return Object.getOwnPropertyNames(v)};var D=Number.isNaN||function(v){return v!==v};b.exports=d;b.exports.once=function(v,x){return new Promise(function(y,E){function G(L){v.removeListener(x,H);E(L)}function H(){"function"===typeof v.removeListener&&
v.removeListener("error",G);y([].slice.call(arguments))}w(v,x,H,{once:!0});"error"!==x&&t(v,G,{once:!0})})};d.EventEmitter=d;d.prototype._events=void 0;d.prototype._eventsCount=0;d.prototype._maxListeners=void 0;var B=10;Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return B},set:function(v){if("number"!==typeof v||0>v||D(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");B=v}});d.init=function(){if(void 0===
this._events||this._events===Object.getPrototypeOf(this)._events)this._events=Object.create(null),this._eventsCount=0;this._maxListeners=this._maxListeners||void 0};d.prototype.setMaxListeners=function(v){if("number"!==typeof v||0>v||D(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");this._maxListeners=v;return this};d.prototype.getMaxListeners=function(){return void 0===this._maxListeners?d.defaultMaxListeners:this._maxListeners};d.prototype.emit=
function(v){for(var x=[],y=1;y<arguments.length;y++)x.push(arguments[y]);y="error"===v;var E=this._events;if(void 0!==E)y=y&&void 0===E.error;else if(!y)return!1;if(y){var G;0<x.length&&(G=x[0]);if(G instanceof Error)throw G;x=Error("Unhandled error."+(G?" ("+G.message+")":""));x.context=G;throw x;}y=E[v];if(void 0===y)return!1;if("function"===typeof y)z(y,this,x);else for(G=y.length,E=q(y,G),y=0;y<G;++y)z(E[y],this,x);return!0};d.prototype.addListener=function(v,x){return g(this,v,x,!1)};d.prototype.on=
d.prototype.addListener;d.prototype.prependListener=function(v,x){return g(this,v,x,!0)};d.prototype.once=function(v,x){h(x);this.on(v,p(this,v,x));return this};d.prototype.prependOnceListener=function(v,x){h(x);this.prependListener(v,p(this,v,x));return this};d.prototype.removeListener=function(v,x){var y;h(x);var E=this._events;if(void 0===E)return this;var G=E[v];if(void 0===G)return this;if(G===x||G.listener===x)0===--this._eventsCount?this._events=Object.create(null):(delete E[v],E.removeListener&&
this.emit("removeListener",v,G.listener||x));else if("function"!==typeof G){var H=-1;for(y=G.length-1;0<=y;y--)if(G[y]===x||G[y].listener===x){var L=G[y].listener;H=y;break}if(0>H)return this;if(0===H)G.shift();else{for(;H+1<G.length;H++)G[H]=G[H+1];G.pop()}1===G.length&&(E[v]=G[0]);void 0!==E.removeListener&&this.emit("removeListener",v,L||x)}return this};d.prototype.off=d.prototype.removeListener;d.prototype.removeAllListeners=function(v){var x=this._events;if(void 0===x)return this;if(void 0===
x.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==x[v]&&(0===--this._eventsCount?this._events=Object.create(null):delete x[v]),this;if(0===arguments.length){var y=Object.keys(x);for(x=0;x<y.length;++x){var E=y[x];"removeListener"!==E&&this.removeAllListeners(E)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}y=x[v];if("function"===typeof y)this.removeListener(v,y);else if(void 0!==
y)for(x=y.length-1;0<=x;x--)this.removeListener(v,y[x]);return this};d.prototype.listeners=function(v){return l(this,v,!0)};d.prototype.rawListeners=function(v){return l(this,v,!1)};d.listenerCount=function(v,x){return"function"===typeof v.listenerCount?v.listenerCount(x):n.call(v,x)};d.prototype.listenerCount=n;d.prototype.eventNames=function(){return 0<this._eventsCount?C(this._events):[]}},{}],4:[function(a,b,c){c.read=function(d,h,g,m,p){var l=8*p-m-1;var n=(1<<l)-1,q=n>>1,t=-7;p=g?p-1:0;var w=
g?-1:1,z=d[h+p];p+=w;g=z&(1<<-t)-1;z>>=-t;for(t+=l;0<t;g=256*g+d[h+p],p+=w,t-=8);l=g&(1<<-t)-1;g>>=-t;for(t+=m;0<t;l=256*l+d[h+p],p+=w,t-=8);if(0===g)g=1-q;else{if(g===n)return l?NaN:Infinity*(z?-1:1);l+=Math.pow(2,m);g-=q}return(z?-1:1)*l*Math.pow(2,g-m)};c.write=function(d,h,g,m,p,l){var n,q=8*l-p-1,t=(1<<q)-1,w=t>>1,z=23===p?Math.pow(2,-24)-Math.pow(2,-77):0;l=m?0:l-1;var C=m?1:-1,D=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===h?(h=isNaN(h)?1:0,m=t):(m=Math.floor(Math.log(h)/Math.LN2),
1>h*(n=Math.pow(2,-m))&&(m--,n*=2),h=1<=m+w?h+z/n:h+z*Math.pow(2,1-w),2<=h*n&&(m++,n/=2),m+w>=t?(h=0,m=t):1<=m+w?(h=(h*n-1)*Math.pow(2,p),m+=w):(h=h*Math.pow(2,w-1)*Math.pow(2,p),m=0));for(;8<=p;d[g+l]=h&255,l+=C,h/=256,p-=8);m=m<<p|h;for(q+=p;0<q;d[g+l]=m&255,l+=C,m/=256,q-=8);d[g+l-C]|=128*D}},{}],5:[function(a,b,c){function d(){throw Error("setTimeout has not been defined");}function h(){throw Error("clearTimeout has not been defined");}function g(v){if(t===setTimeout)return setTimeout(v,0);if((t===
d||!t)&&setTimeout)return t=setTimeout,setTimeout(v,0);try{return t(v,0)}catch(x){try{return t.call(null,v,0)}catch(y){return t.call(this,v,0)}}}function m(v){if(w===clearTimeout)return clearTimeout(v);if((w===h||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(v);try{return w(v)}catch(x){try{return w.call(null,v)}catch(y){return w.call(this,v)}}}function p(){C&&D&&(C=!1,D.length?z=D.concat(z):B=-1,z.length&&l())}function l(){if(!C){var v=g(p);C=!0;for(var x=z.length;x;){D=z;for(z=[];++B<x;)D&&
D[B].run();B=-1;x=z.length}D=null;C=!1;m(v)}}function n(v,x){this.fun=v;this.array=x}function q(){}a=b.exports={};try{var t="function"===typeof setTimeout?setTimeout:d}catch(v){t=d}try{var w="function"===typeof clearTimeout?clearTimeout:h}catch(v){w=h}var z=[],C=!1,D,B=-1;a.nextTick=function(v){var x=Array(arguments.length-1);if(1<arguments.length)for(var y=1;y<arguments.length;y++)x[y-1]=arguments[y];z.push(new n(v,x));1!==z.length||C||g(l)};n.prototype.run=function(){this.fun.apply(null,this.array)};
a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=q;a.addListener=q;a.once=q;a.off=q;a.removeListener=q;a.removeAllListeners=q;a.emit=q;a.prependListener=q;a.prependOnceListener=q;a.listeners=function(v){return[]};a.binding=function(v){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(v){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],6:[function(a,b,c){(function(d){(function(){function h(v){return""!==
v&&D.reduce(function(x,y){var E=y[0];if(x)return x;x=y[1].exec(v);return!!x&&[E,x]},!1)}function g(v){var x=h(v);if(!x)return null;var y=x[0];x=x[1];if("searchbot"===y)return new w;var E=x[1]&&x[1].split(".").join("_").split("_").slice(0,3);if(E){if(3>E.length){x=l([],E,!0);E=3-E.length;for(var G=[],H=0;H<E;H++)G.push("0");E=l(x,G,!0)}}else E=[];x=E.join(".");E=m(v);return(v=C.exec(v))&&v[1]?new t(y,x,E,v[1]):new n(y,x,E)}function m(v){for(var x=0,y=B.length;x<y;x++){var E=B[x],G=E[0];if(E[1].exec(v))return G}return null}
function p(){return"undefined"!==typeof d&&d.version?new q(d.version.slice(1)):null}var l=this&&this.__spreadArray||function(v,x,y){if(y||2===arguments.length)for(var E=0,G=x.length,H;E<G;E++)!H&&E in x||(H||(H=Array.prototype.slice.call(x,0,E)),H[E]=x[E]);return v.concat(H||Array.prototype.slice.call(x))};Object.defineProperty(c,"__esModule",{value:!0});c.getNodeVersion=c.detectOS=c.parseUserAgent=c.browserName=c.detect=c.ReactNativeInfo=c.BotInfo=c.SearchBotDeviceInfo=c.NodeInfo=c.BrowserInfo=void 0;
var n=function(){return function(v,x,y){this.name=v;this.version=x;this.os=y;this.type="browser"}}();c.BrowserInfo=n;var q=function(){return function(v){this.version=v;this.name=this.type="node";this.os=d.platform}}();c.NodeInfo=q;var t=function(){return function(v,x,y,E){this.name=v;this.version=x;this.os=y;this.bot=E;this.type="bot-device"}}();c.SearchBotDeviceInfo=t;var w=function(){return function(){this.type="bot";this.bot=!0;this.name="bot";this.os=this.version=null}}();c.BotInfo=w;var z=function(){return function(){this.name=
this.type="react-native";this.os=this.version=null}}();c.ReactNativeInfo=z;var C=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/,D=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",
/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],
["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],
B=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",
/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];c.detect=function(v){return v?g(v):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new z:"undefined"!==typeof navigator?g(navigator.userAgent):p()};c.browserName=function(v){return(v=h(v))?v[0]:
null};c.parseUserAgent=g;c.detectOS=m;c.getNodeVersion=p}).call(this)}).call(this,a("_process"))},{_process:5}],7:[function(a,b,c){function d(){}function h(q,t,w){this.fn=q;this.context=t;this.once=w||!1}function g(q,t,w,z,C){if("function"!==typeof w)throw new TypeError("The listener must be a function");w=new h(w,z||q,C);t=n?n+t:t;q._events[t]?q._events[t].fn?q._events[t]=[q._events[t],w]:q._events[t].push(w):(q._events[t]=w,q._eventsCount++);return q}function m(q,t){0===--q._eventsCount?q._events=
new d:delete q._events[t]}function p(){this._events=new d;this._eventsCount=0}var l=Object.prototype.hasOwnProperty,n="~";Object.create&&(d.prototype=Object.create(null),(new d).__proto__||(n=!1));p.prototype.eventNames=function(){var q=[],t,w;if(0===this._eventsCount)return q;for(w in t=this._events)l.call(t,w)&&q.push(n?w.slice(1):w);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(t)):q};p.prototype.listeners=function(q){q=this._events[n?n+q:q];if(!q)return[];if(q.fn)return[q.fn];
for(var t=0,w=q.length,z=Array(w);t<w;t++)z[t]=q[t].fn;return z};p.prototype.listenerCount=function(q){return(q=this._events[n?n+q:q])?q.fn?1:q.length:0};p.prototype.emit=function(q,t,w,z,C,D){var B=n?n+q:q;if(!this._events[B])return!1;B=this._events[B];var v=arguments.length,x;if(B.fn){B.once&&this.removeListener(q,B.fn,void 0,!0);switch(v){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,t),!0;case 3:return B.fn.call(B.context,t,w),!0;case 4:return B.fn.call(B.context,t,w,
z),!0;case 5:return B.fn.call(B.context,t,w,z,C),!0;case 6:return B.fn.call(B.context,t,w,z,C,D),!0}var y=1;for(x=Array(v-1);y<v;y++)x[y-1]=arguments[y];B.fn.apply(B.context,x)}else{var E=B.length;for(y=0;y<E;y++)switch(B[y].once&&this.removeListener(q,B[y].fn,void 0,!0),v){case 1:B[y].fn.call(B[y].context);break;case 2:B[y].fn.call(B[y].context,t);break;case 3:B[y].fn.call(B[y].context,t,w);break;case 4:B[y].fn.call(B[y].context,t,w,z);break;default:if(!x){var G=1;for(x=Array(v-1);G<v;G++)x[G-1]=
arguments[G]}B[y].fn.apply(B[y].context,x)}}return!0};p.prototype.on=function(q,t,w){return g(this,q,t,w,!1)};p.prototype.once=function(q,t,w){return g(this,q,t,w,!0)};p.prototype.removeListener=function(q,t,w,z){q=n?n+q:q;if(!this._events[q])return this;if(!t)return m(this,q),this;var C=this._events[q];if(C.fn)C.fn!==t||z&&!C.once||w&&C.context!==w||m(this,q);else{for(var D=0,B=[],v=C.length;D<v;D++)(C[D].fn!==t||z&&!C[D].once||w&&C[D].context!==w)&&B.push(C[D]);B.length?this._events[q]=1===B.length?
B[0]:B:m(this,q)}return this};p.prototype.removeAllListeners=function(q){q?(q=n?n+q:q,this._events[q]&&m(this,q)):(this._events=new d,this._eventsCount=0);return this};p.prototype.off=p.prototype.removeListener;p.prototype.addListener=p.prototype.on;p.prefixed=n;p.EventEmitter=p;"undefined"!==typeof b&&(b.exports=p)},{}],8:[function(a,b,c){b.exports=function(d,h){h=h||function(){};return d.then(function(g){return(new Promise(function(m){m(h())})).then(function(){return g})},function(g){return(new Promise(function(m){m(h())})).then(function(){throw g;
})})}},{}],9:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var d=a("eventemitter3"),h=a("p-timeout"),g=a("./priority-queue"),m=function(){},p=new h.TimeoutError;a=function(l){var n,q,t,w;var z=d.call(this)||this;z._intervalCount=0;z._intervalEnd=0;z._pendingCount=0;z._resolveEmpty=m;z._resolveIdle=m;l=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Infinity,interval:0,concurrency:Infinity,autoStart:!0,queueClass:g.default},l);if(!("number"===typeof l.intervalCap&&1<=l.intervalCap))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `"+
(null!==(q=null===(n=l.intervalCap)||void 0===n?void 0:n.toString())&&void 0!==q?q:"")+"` ("+typeof l.intervalCap+")");if(void 0===l.interval||!(Number.isFinite(l.interval)&&0<=l.interval))throw new TypeError("Expected `interval` to be a finite number >= 0, got `"+(null!==(w=null===(t=l.interval)||void 0===t?void 0:t.toString())&&void 0!==w?w:"")+"` ("+typeof l.interval+")");z._carryoverConcurrencyCount=l.carryoverConcurrencyCount;z._isIntervalIgnored=Infinity===l.intervalCap||0===l.interval;z._intervalCap=
l.intervalCap;z._interval=l.interval;z._queue=new l.queueClass;z._queueClass=l.queueClass;z.concurrency=l.concurrency;z._timeout=l.timeout;z._throwOnTimeout=!0===l.throwOnTimeout;z._isPaused=!1===l.autoStart;return z};$jscomp.inherits(a,d);a.prototype._next=function(){this._pendingCount--;this._tryToStartAnother();this.emit("next")};a.prototype._resolvePromises=function(){this._resolveEmpty();this._resolveEmpty=m;0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=m,this.emit("idle"))};
a.prototype._onResumeInterval=function(){this._onInterval();this._initializeIntervalIfNeeded();this._timeoutId=void 0};a.prototype._isIntervalPaused=function(){var l=this,n=Date.now();if(void 0===this._intervalId)if(n=this._intervalEnd-n,0>n)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return void 0===this._timeoutId&&(this._timeoutId=setTimeout(function(){l._onResumeInterval()},n)),!0;return!1};a.prototype._tryToStartAnother=function(){if(0===this._queue.size)return this._intervalId&&
clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){var l=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){var n=this._queue.dequeue();if(!n)return!1;this.emit("active");n();l&&this._initializeIntervalIfNeeded();return!0}}return!1};a.prototype._initializeIntervalIfNeeded=function(){var l=this;this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(function(){l._onInterval()},
this._interval),this._intervalEnd=Date.now()+this._interval)};a.prototype._onInterval=function(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0);this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;this._processQueue()};a.prototype._processQueue=function(){for(;this._tryToStartAnother(););};a.prototype.add=function(l,n){n=void 0===n?{}:n;var q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){return t.return(new Promise(function(w,
z){q._queue.enqueue(function(){var C,D,B;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){switch(v.nextAddress){case 1:return q._pendingCount++,q._intervalCount++,v.setCatchFinallyBlocks(2),C=void 0===q._timeout&&void 0===n.timeout?l():h.default(Promise.resolve(l()),void 0===n.timeout?q._timeout:n.timeout,function(){(void 0===n.throwOnTimeout?q._throwOnTimeout:n.throwOnTimeout)&&z(p)}),D=w,v.yield(C,4);case 4:D(v.yieldResult);v.leaveTryBlock(3);break;case 2:B=v.enterCatchBlock(),z(B);
case 3:q._next(),v.jumpToEnd()}})},n);q._tryToStartAnother();q.emit("add")}))})};a.prototype.addAll=function(l,n){var q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){return t.return(Promise.all(l.map(function(w){return $jscomp.asyncExecutePromiseGeneratorProgram(function(z){return z.return(q.add(w,n))})})))})};a.prototype.start=function(){if(!this._isPaused)return this;this._isPaused=!1;this._processQueue();return this};a.prototype.pause=function(){this._isPaused=!0};a.prototype.clear=
function(){this._queue=new this._queueClass};a.prototype.onEmpty=function(){var l=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){return 0===l._queue.size?n.return():n.return(new Promise(function(q){var t=l._resolveEmpty;l._resolveEmpty=function(){t();q()}}))})};a.prototype.onIdle=function(){var l=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){return 0===l._pendingCount&&0===l._queue.size?n.return():n.return(new Promise(function(q){var t=l._resolveIdle;l._resolveIdle=
function(){t();q()}}))})};a.prototype.sizeBy=function(l){return this._queue.filter(l).length};$jscomp.global.Object.defineProperties(a.prototype,{_doesIntervalAllowAnother:{configurable:!0,enumerable:!0,get:function(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}},_doesConcurrentAllowAnother:{configurable:!0,enumerable:!0,get:function(){return this._pendingCount<this._concurrency}},concurrency:{configurable:!0,enumerable:!0,get:function(){return this._concurrency},set:function(l){if(!("number"===
typeof l&&1<=l))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `"+l+"` ("+typeof l+")");this._concurrency=l;this._processQueue()}},size:{configurable:!0,enumerable:!0,get:function(){return this._queue.size}},pending:{configurable:!0,enumerable:!0,get:function(){return this._pendingCount}},isPaused:{configurable:!0,enumerable:!0,get:function(){return this._isPaused}},timeout:{configurable:!0,enumerable:!0,get:function(){return this._timeout},set:function(l){this._timeout=
l}}});c.default=a},{"./priority-queue":11,eventemitter3:7,"p-timeout":12}],10:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.default=function(d,h,g){for(var m=0,p=d.length;0<p;){var l=p/2|0,n=m+l;0>=g(d[n],h)?(m=++n,p-=l+1):p=l}return m}},{}],11:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var d=a("./lower-bound");a=function(){this._queue=[]};a.prototype.enqueue=function(h,g){g=Object.assign({priority:0},g);h={priority:g.priority,run:h};this.size&&this._queue[this.size-
1].priority>=g.priority?this._queue.push(h):(g=d.default(this._queue,h,function(m,p){return p.priority-m.priority}),this._queue.splice(g,0,h))};a.prototype.dequeue=function(){var h=this._queue.shift();return null===h||void 0===h?void 0:h.run};a.prototype.filter=function(h){return this._queue.filter(function(g){return g.priority===h.priority}).map(function(g){return g.run})};$jscomp.global.Object.defineProperties(a.prototype,{size:{configurable:!0,enumerable:!0,get:function(){return this._queue.length}}});
c.default=a},{"./lower-bound":10}],12:[function(a,b,c){var d=a("p-finally"),h=function(g){g=Error.call(this,g);this.message=g.message;"stack"in g&&(this.stack=g.stack);this.name="TimeoutError"};$jscomp.inherits(h,Error);a=function(g,m,p){return new Promise(function(l,n){if("number"!==typeof m||0>m)throw new TypeError("Expected `milliseconds` to be a positive number");if(Infinity===m)l(g);else{var q=setTimeout(function(){if("function"===typeof p)try{l(p())}catch(w){n(w)}else{var t="string"===typeof p?
p:"Promise timed out after "+m+" milliseconds";t=p instanceof Error?p:new h(t);"function"===typeof g.cancel&&g.cancel();n(t)}},m);d(g.then(l,n),function(){clearTimeout(q)})}})};b.exports=a;b.exports.default=a;b.exports.TimeoutError=h},{"p-finally":8}],13:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.DEVICE_MODELS=c.VENDOR_ID=c.StreamDeckProxy=c.DeviceModelId=void 0;b=a("./models");var d=a("./models");Object.defineProperty(c,"DeviceModelId",{enumerable:!0,get:function(){return d.DeviceModelId}});
var h=a("./proxy");Object.defineProperty(c,"StreamDeckProxy",{enumerable:!0,get:function(){return h.StreamDeckProxy}});c.VENDOR_ID=4057;c.DEVICE_MODELS=[{id:b.DeviceModelId.ORIGINAL,productId:96,class:b.StreamDeckOriginal},{id:b.DeviceModelId.MINI,productId:99,class:b.StreamDeckMini},{id:b.DeviceModelId.XL,productId:108,class:b.StreamDeckXL},{id:b.DeviceModelId.ORIGINALV2,productId:109,class:b.StreamDeckOriginalV2},{id:b.DeviceModelId.ORIGINALMK2,productId:128,class:b.StreamDeckOriginalMK2}]},{"./models":17,
"./proxy":23}],14:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckGen2Base=void 0;var h=a("../util"),g=a("./base"),m=function(p,l,n){p=g.StreamDeckBase.call(this,p,l,n)||this;p.encodeJPEG=l.encodeJPEG;return p};$jscomp.inherits(m,g.StreamDeckBase);m.prototype.setBrightness=function(p){var l=this,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(0>p||100<p)throw new RangeError("Expected brightness percentage to be between 0 and 100");
n=d.from([3,8,p,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return q.yield(l.device.sendFeatureReport(n),0)})};m.prototype.resetToLogo=function(){var p=this,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){l=d.from([3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return n.yield(p.device.sendFeatureReport(l),0)})};m.prototype.getFirmwareVersion=function(){var p=this,l,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(1==q.nextAddress)return q.yield(p.device.getFeatureReport(5,
32),2);l=q.yieldResult;n=l.indexOf(0);return q.return(l.toString("ascii",6,-1===n?void 0:n))})};m.prototype.getSerialNumber=function(){var p=this,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.yield(p.device.getFeatureReport(6,32),2);l=n.yieldResult;return n.return(l.toString("ascii",2,14))})};m.prototype.transformKeyIndex=function(p){return p};m.prototype.getFillImageCommandHeaderLength=function(){return 8};m.prototype.writeFillImageCommandHeader=function(p,
l,n,q,t){p.writeUInt8(2,0);p.writeUInt8(7,1);p.writeUInt8(l,2);p.writeUInt8(q?1:0,3);p.writeUInt16LE(t,4);p.writeUInt16LE(n++,6)};m.prototype.getFillImagePacketLength=function(){return 1024};m.prototype.convertFillImage=function(p,l){p=h.imageToByteArray(p,l,0,this.transformCoordinates.bind(this),"rgba",this.ICON_SIZE);return this.encodeJPEG(p,this.ICON_SIZE,this.ICON_SIZE)};m.prototype.transformCoordinates=function(p,l){return{x:this.ICON_SIZE-p-1,y:this.ICON_SIZE-l-1}};c.StreamDeckGen2Base=m}).call(this)}).call(this,
a("buffer").Buffer)},{"../util":24,"./base":15,buffer:2}],15:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckBase=void 0;var h=a("eventemitter3"),g=function(m,p,l){var n=h.call(this)||this;n.deviceProperties=l;n.device=m;n.keyState=Array(n.NUM_KEYS).fill(!1);n.device.dataKeyOffset=l.KEY_DATA_OFFSET;n.device.on("input",function(q){for(var t=0;t<n.NUM_KEYS;t++){var w=!!q[t],z=n.transformKeyIndex(t);w!==n.keyState[z]&&((n.keyState[z]=w)?n.emit("down",
z):n.emit("up",z))}});n.device.on("error",function(q){n.emit("error",q)});return n};$jscomp.inherits(g,h);g.prototype.checkValidKeyIndex=function(m){if(0>m||m>=this.NUM_KEYS)throw new TypeError("Expected a valid keyIndex 0 - "+(this.NUM_KEYS-1));};g.prototype.close=function(){return this.device.close()};g.prototype.fillKeyColor=function(m,p,l,n){var q=this,t,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(z){q.checkValidKeyIndex(m);q.checkRGBValue(p);q.checkRGBValue(l);q.checkRGBValue(n);
t=d.alloc(q.ICON_BYTES,d.from([p,l,n]));w=q.transformKeyIndex(m);return z.yield(q.fillImageRange(w,t,{format:"rgb",offset:0,stride:3*q.ICON_SIZE}),0)})};g.prototype.fillKeyBuffer=function(m,p,l){var n=this,q,t,w,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(C){n.checkValidKeyIndex(m);t=null!==(q=null===l||void 0===l?void 0:l.format)&&void 0!==q?q:"rgb";n.checkSourceFormat(t);w=n.ICON_PIXELS*t.length;if(p.length!==w)throw new RangeError("Expected image buffer of length "+w+", got length "+
p.length);z=n.transformKeyIndex(m);return C.yield(n.fillImageRange(z,p,{format:t,offset:0,stride:n.ICON_SIZE*t.length}),0)})};g.prototype.fillPanelBuffer=function(m,p){var l=this,n,q,t,w,z,C,D,B,v,x,y;return $jscomp.asyncExecutePromiseGeneratorProgram(function(E){q=null!==(n=null===p||void 0===p?void 0:p.format)&&void 0!==n?n:"rgb";l.checkSourceFormat(q);t=l.ICON_PIXELS*q.length*l.NUM_KEYS;if(m.length!==t)throw new RangeError("Expected image buffer of length "+t+", got length "+m.length);w=l.ICON_SIZE*
q.length;z=w*l.KEY_COLUMNS;C=[];for(D=0;D<l.KEY_ROWS;D++)for(B=z*D*l.ICON_SIZE,v=0;v<l.KEY_COLUMNS;v++)x=D*l.KEY_COLUMNS,x="ltr"===l.deviceProperties.KEY_DIRECTION?x+v:x+(l.KEY_COLUMNS-v-1),y=v*w,C.push(l.fillImageRange(x,m,{format:q,offset:B+y,stride:z}));return E.yield(C,0)})};g.prototype.clearKey=function(m){var p=this,l,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){p.checkValidKeyIndex(m);l=d.alloc(p.ICON_BYTES,0);n=p.transformKeyIndex(m);return q.yield(p.fillImageRange(n,l,
{format:"rgb",offset:0,stride:3*p.ICON_SIZE}),0)})};g.prototype.clearPanel=function(){var m=this,p,l,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){p=d.alloc(m.ICON_BYTES,0);l=[];for(n=0;n<m.NUM_KEYS;n++)l.push(m.fillImageRange(n,p,{format:"rgb",offset:0,stride:3*m.ICON_SIZE}));return q.yield(Promise.all(l),0)})};g.prototype.setBrightness=function(m){var p=this,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(0>m||100<m)throw new RangeError("Expected brightness percentage to be between 0 and 100");
l=d.from([5,85,170,209,1,m,0,0,0,0,0,0,0,0,0,0,0]);return n.yield(p.device.sendFeatureReport(l),0)})};g.prototype.resetToLogo=function(){var m=this,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){p=d.from([11,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return l.yield(m.device.sendFeatureReport(p),0)})};g.prototype.getFirmwareVersion=function(){var m=this,p,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.yield(m.device.getFeatureReport(4,17),2);
p=n.yieldResult;l=p.indexOf(0);return n.return(p.toString("ascii",5,-1===l?void 0:l))})};g.prototype.getSerialNumber=function(){var m=this,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(m.device.getFeatureReport(3,17),2);p=l.yieldResult;return l.return(p.toString("ascii",5,17))})};g.prototype.getFillImageCommandHeaderLength=function(){return 16};g.prototype.writeFillImageCommandHeader=function(m,p,l,n,q){m.writeUInt8(2,0);m.writeUInt8(1,1);m.writeUInt16LE(l,
2);m.writeUInt8(n?1:0,4);m.writeUInt8(p+1,5)};g.prototype.generateFillImageWrites=function(m,p){for(var l=this.getFillImagePacketLength(),n=this.getFillImageCommandHeaderLength(),q=l-n,t=[],w=p.length,z=0;0<w;z++){var C=d.alloc(l),D=Math.min(w,q);this.writeFillImageCommandHeader(C,m,z,w<=q,D);var B=p.length-w;w-=D;p.copy(C,n,B,B+D);t.push(C)}return t};g.prototype.fillImageRange=function(m,p,l){var n=this,q,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){if(1==w.nextAddress)return n.checkValidKeyIndex(m),
w.yield(n.convertFillImage(p,l),2);q=w.yieldResult;t=n.generateFillImageWrites(m,q);return w.yield(n.device.sendReports(t),0)})};g.prototype.checkRGBValue=function(m){if(0>m||255<m)throw new TypeError("Expected a valid color RGB value 0 - 255");};g.prototype.checkSourceFormat=function(m){switch(m){case "rgb":case "rgba":case "bgr":case "bgra":break;default:throw new TypeError('Expected a known color format not "'+m+'"');}};$jscomp.global.Object.defineProperties(g.prototype,{NUM_KEYS:{configurable:!0,
enumerable:!0,get:function(){return this.KEY_COLUMNS*this.KEY_ROWS}},KEY_COLUMNS:{configurable:!0,enumerable:!0,get:function(){return this.deviceProperties.COLUMNS}},KEY_ROWS:{configurable:!0,enumerable:!0,get:function(){return this.deviceProperties.ROWS}},ICON_SIZE:{configurable:!0,enumerable:!0,get:function(){return this.deviceProperties.ICON_SIZE}},ICON_BYTES:{configurable:!0,enumerable:!0,get:function(){return 3*this.ICON_PIXELS}},ICON_PIXELS:{configurable:!0,enumerable:!0,get:function(){return this.ICON_SIZE*
this.ICON_SIZE}},MODEL:{configurable:!0,enumerable:!0,get:function(){return this.deviceProperties.MODEL}}});c.StreamDeckBase=g}).call(this)}).call(this,a("buffer").Buffer)},{buffer:2,eventemitter3:7}],16:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.DeviceModelId=void 0;a=c.DeviceModelId||(c.DeviceModelId={});a.ORIGINAL="original";a.ORIGINALV2="originalv2";a.ORIGINALMK2="original-mk2";a.MINI="mini";a.XL="xl"},{}],17:[function(a,b,c){var d=this&&this.__createBinding||(Object.create?
function(n,q,t,w){void 0===w&&(w=t);Object.defineProperty(n,w,{enumerable:!0,get:function(){return q[t]}})}:function(n,q,t,w){void 0===w&&(w=t);n[w]=q[t]});b=this&&this.__exportStar||function(n,q){for(var t in n)"default"===t||Object.prototype.hasOwnProperty.call(q,t)||d(q,n,t)};Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckOriginalMK2=c.StreamDeckOriginalV2=c.StreamDeckXL=c.StreamDeckMini=c.StreamDeckOriginal=void 0;b(a("./id"),c);var h=a("./original");Object.defineProperty(c,"StreamDeckOriginal",
{enumerable:!0,get:function(){return h.StreamDeckOriginal}});var g=a("./mini");Object.defineProperty(c,"StreamDeckMini",{enumerable:!0,get:function(){return g.StreamDeckMini}});var m=a("./xl");Object.defineProperty(c,"StreamDeckXL",{enumerable:!0,get:function(){return m.StreamDeckXL}});var p=a("./originalv2");Object.defineProperty(c,"StreamDeckOriginalV2",{enumerable:!0,get:function(){return p.StreamDeckOriginalV2}});var l=a("./original-mk2");Object.defineProperty(c,"StreamDeckOriginalMK2",{enumerable:!0,
get:function(){return l.StreamDeckOriginalMK2}})},{"./id":16,"./mini":18,"./original":20,"./original-mk2":19,"./originalv2":21,"./xl":22}],18:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckMini=void 0;var d=a("../util"),h=a("./base"),g={MODEL:a("./id").DeviceModelId.MINI,COLUMNS:3,ROWS:2,ICON_SIZE:80,KEY_DIRECTION:"ltr",KEY_DATA_OFFSET:1};a=function(m,p){return h.StreamDeckBase.call(this,m,p,g)||this};$jscomp.inherits(a,h.StreamDeckBase);a.prototype.transformKeyIndex=
function(m){return m};a.prototype.convertFillImage=function(m,p){m=d.imageToByteArray(m,p,d.BMP_HEADER_LENGTH,this.rotateCoordinates.bind(this),"bgr",this.ICON_SIZE);d.writeBMPHeader(m,this.ICON_SIZE,this.ICON_BYTES,2835);return Promise.resolve(m)};a.prototype.getFillImagePacketLength=function(){return 1024};a.prototype.rotateCoordinates=function(m,p){return{x:this.ICON_SIZE-p-1,y:m}};c.StreamDeckMini=a},{"../util":24,"./base":15,"./id":16}],19:[function(a,b,c){Object.defineProperty(c,"__esModule",
{value:!0});c.StreamDeckOriginalMK2=void 0;var d=a("./base-gen2"),h={MODEL:a("./id").DeviceModelId.ORIGINALMK2,COLUMNS:5,ROWS:3,ICON_SIZE:72,KEY_DIRECTION:"ltr",KEY_DATA_OFFSET:4};a=function(g,m){return d.StreamDeckGen2Base.call(this,g,m,h)||this};$jscomp.inherits(a,d.StreamDeckGen2Base);c.StreamDeckOriginalMK2=a},{"./base-gen2":14,"./id":16}],20:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckOriginal=void 0;var h=a("../util"),g=a("./base"),
m={MODEL:a("./id").DeviceModelId.ORIGINAL,COLUMNS:5,ROWS:3,ICON_SIZE:72,KEY_DIRECTION:"rtl",KEY_DATA_OFFSET:1},p=function(l,n){l=g.StreamDeckBase.call(this,l,n,m)||this;l.useOriginalKeyOrder=!!n.useOriginalKeyOrder;return l};$jscomp.inherits(p,g.StreamDeckBase);p.prototype.transformKeyIndex=function(l){if(this.useOriginalKeyOrder)return l;var n=(this.KEY_COLUMNS-1)/2;return l+(l%this.KEY_COLUMNS-n)*-n};p.prototype.getFillImagePacketLength=function(){return 8191};p.prototype.convertFillImage=function(l,
n){l=h.imageToByteArray(l,n,h.BMP_HEADER_LENGTH,this.flipCoordinates.bind(this),"bgr",this.ICON_SIZE);h.writeBMPHeader(l,this.ICON_SIZE,this.ICON_BYTES,3780);return Promise.resolve(l)};p.prototype.generateFillImageWrites=function(l,n){var q=this.getFillImagePacketLength(),t=this.getFillImageCommandHeaderLength(),w=n.length/2,z=d.alloc(q);this.writeFillImageCommandHeader(z,l,1,!1,w);n.copy(z,t,0,w);q=d.alloc(q);this.writeFillImageCommandHeader(q,l,2,!0,w);n.copy(q,t,w);return[z,q]};p.prototype.flipCoordinates=
function(l,n){return{x:this.ICON_SIZE-l-1,y:n}};c.StreamDeckOriginal=p}).call(this)}).call(this,a("buffer").Buffer)},{"../util":24,"./base":15,"./id":16,buffer:2}],21:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckOriginalV2=void 0;var d=a("./base-gen2"),h={MODEL:a("./id").DeviceModelId.ORIGINALV2,COLUMNS:5,ROWS:3,ICON_SIZE:72,KEY_DIRECTION:"ltr",KEY_DATA_OFFSET:4};a=function(g,m){return d.StreamDeckGen2Base.call(this,g,m,h)||this};$jscomp.inherits(a,d.StreamDeckGen2Base);
c.StreamDeckOriginalV2=a},{"./base-gen2":14,"./id":16}],22:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.StreamDeckXL=void 0;var d=a("./base-gen2"),h={MODEL:a("./id").DeviceModelId.XL,COLUMNS:8,ROWS:4,ICON_SIZE:96,KEY_DIRECTION:"ltr",KEY_DATA_OFFSET:4};a=function(g,m){return d.StreamDeckGen2Base.call(this,g,m,h)||this};$jscomp.inherits(a,d.StreamDeckGen2Base);c.StreamDeckXL=a},{"./base-gen2":14,"./id":16}],23:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});
c.StreamDeckProxy=void 0;a=function(d){this.device=d};a.prototype.checkValidKeyIndex=function(d){this.device.checkValidKeyIndex(d)};a.prototype.close=function(){return this.device.close()};a.prototype.fillKeyColor=function(d,h,g,m){return this.device.fillKeyColor(d,h,g,m)};a.prototype.fillKeyBuffer=function(d,h,g){return this.device.fillKeyBuffer(d,h,g)};a.prototype.fillPanelBuffer=function(d,h){return this.device.fillPanelBuffer(d,h)};a.prototype.clearKey=function(d){return this.device.clearKey(d)};
a.prototype.clearPanel=function(){return this.device.clearPanel()};a.prototype.setBrightness=function(d){return this.device.setBrightness(d)};a.prototype.resetToLogo=function(){return this.device.resetToLogo()};a.prototype.getFirmwareVersion=function(){return this.device.getFirmwareVersion()};a.prototype.getSerialNumber=function(){return this.device.getSerialNumber()};a.prototype.eventNames=function(){return this.device.eventNames()};a.prototype.listeners=function(d){return this.device.listeners(d)};
a.prototype.listenerCount=function(d){return this.device.listenerCount(d)};a.prototype.emit=function(d,h){for(var g=[],m=1;m<arguments.length;++m)g[m-1]=arguments[m];return this.device.emit.apply(this.device,[d].concat($jscomp.arrayFromIterable(g)))};a.prototype.on=function(d,h,g){this.device.on(d,h,g);return this};a.prototype.addListener=function(d,h,g){this.device.addListener(d,h,g);return this};a.prototype.once=function(d,h,g){this.device.once(d,h,g);return this};a.prototype.removeListener=function(d,
h,g,m){this.device.removeListener(d,h,g,m);return this};a.prototype.off=function(d,h,g,m){this.device.off(d,h,g,m);return this};a.prototype.removeAllListeners=function(d){this.device.removeAllListeners(d);return this};$jscomp.global.Object.defineProperties(a.prototype,{NUM_KEYS:{configurable:!0,enumerable:!0,get:function(){return this.device.NUM_KEYS}},KEY_COLUMNS:{configurable:!0,enumerable:!0,get:function(){return this.device.KEY_COLUMNS}},KEY_ROWS:{configurable:!0,enumerable:!0,get:function(){return this.device.KEY_ROWS}},
ICON_SIZE:{configurable:!0,enumerable:!0,get:function(){return this.device.ICON_SIZE}},ICON_BYTES:{configurable:!0,enumerable:!0,get:function(){return this.device.ICON_BYTES}},ICON_PIXELS:{configurable:!0,enumerable:!0,get:function(){return this.device.ICON_PIXELS}},MODEL:{configurable:!0,enumerable:!0,get:function(){return this.device.MODEL}}});c.StreamDeckProxy=a},{}],24:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,"__esModule",{value:!0});c.writeBMPHeader=c.BMP_HEADER_LENGTH=
c.imageToByteArray=void 0;c.imageToByteArray=function(h,g,m,p,l,n){for(var q=d.alloc(m+n*n*l.length),t=g.format.substring(0,3)!==l.substring(0,3),w=0;w<n;w++)for(var z=m+n*l.length*w,C=0;C<n;C++){var D=p(C,w),B=D.y*g.stride+g.offset+D.x*g.format.length;D=h.readUInt8(B);var v=h.readUInt8(B+1);B=h.readUInt8(B+2);var x=z+C*l.length;t?(q.writeUInt8(B,x),q.writeUInt8(v,x+1),q.writeUInt8(D,x+2)):(q.writeUInt8(D,x),q.writeUInt8(v,x+1),q.writeUInt8(B,x+2));4===l.length&&q.writeUInt8(255,x+3)}return q};c.BMP_HEADER_LENGTH=
54;c.writeBMPHeader=function(h,g,m,p){h.write("BM");h.writeUInt32LE(m+54,2);h.writeInt16LE(0,6);h.writeInt16LE(0,8);h.writeUInt32LE(54,10);h.writeUInt32LE(40,14);h.writeInt32LE(g,18);h.writeInt32LE(g,22);h.writeInt16LE(1,26);h.writeInt16LE(24,28);h.writeInt32LE(0,30);h.writeInt32LE(m,34);h.writeInt32LE(p,38);h.writeInt32LE(p,42);h.writeInt32LE(0,46);h.writeInt32LE(0,50)}}).call(this)}).call(this,a("buffer").Buffer)},{buffer:2}],25:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,
"__esModule",{value:!0});c.WebHIDDevice=void 0;var h=a("events"),g=a("p-queue"),m=function(p){var l=h.EventEmitter.call(this)||this;l.reportQueue=new g.default({concurrency:1});l.device=p;l.device.addEventListener("inputreport",function(n){if(1===n.reportId){n=new Uint8Array(n.data.buffer);var q=l.dataKeyOffset||1;n=Array.from(n).slice(q-1,n.length-1);l.emit("input",n)}});return l};$jscomp.inherits(m,h.EventEmitter);m.prototype.close=function(){return this.device.close()};m.prototype.sendFeatureReport=
function(p){return this.device.sendFeatureReport(p[0],new Uint8Array(p.slice(1)))};m.prototype.getFeatureReport=function(p,l){var n=this,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){if(1==t.nextAddress)return t.yield(n.device.receiveFeatureReport(p),2);q=t.yieldResult;return t.return(d.from(q.buffer))})};m.prototype.sendReports=function(p){var l=this;return this.reportQueue.add(function(){var n,q,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){1==w.nextAddress&&
(n=$jscomp.makeIterator(p),q=n.next());if(3!=w.nextAddress){if(q.done)return w.jumpTo(0);t=q.value;return w.yield(l.device.sendReport(t[0],new Uint8Array(t.slice(1))),3)}q=n.next();return w.jumpTo(2)})})};c.WebHIDDevice=m}).call(this)}).call(this,a("buffer").Buffer)},{buffer:2,events:3,"p-queue":9}],26:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,"__esModule",{value:!0});c.encodeJPEG=void 0;c.encodeJPEG=function(h,g,m){var p,l,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){return 1==
q.nextAddress?q.yield(new Promise(function(t,w){var z=document.createElement("canvas");z.width=g;z.height=m;var C=z.getContext("2d");if(C){var D=C.createImageData(g,m);D.data.set(h);C.putImageData(D,0,0);z.toBlob(function(B){B?t(B):w()},"image/jpeg",.9)}else w()}),2):3!=q.nextAddress?(p=q.yieldResult,l=d,n=l.from,q.yield(p.arrayBuffer(),3)):q.return(n.call(l,q.yieldResult))})}}).call(this)}).call(this,a("buffer").Buffer)},{buffer:2}],27:[function(a,b,c){(function(d){(function(){Object.defineProperty(c,
"__esModule",{value:!0});c.StreamDeckWeb=void 0;var h=a("@elgato-stream-deck/core"),g=function(m){return h.StreamDeckProxy.call(this,m)||this};$jscomp.inherits(g,h.StreamDeckProxy);g.prototype.fillKeyCanvas=function(m,p){this.checkValidKeyIndex(m);p=p.getContext("2d");if(!p)throw Error("Failed to get canvas context");p=p.getImageData(0,0,this.ICON_SIZE,this.ICON_SIZE);return this.device.fillKeyBuffer(m,d.from(p.data),{format:"rgba"})};g.prototype.fillPanelCanvas=function(m){m=m.getContext("2d");if(!m)throw Error("Failed to get canvas context");
m=m.getImageData(0,0,this.ICON_SIZE*this.KEY_COLUMNS,this.ICON_SIZE*this.KEY_ROWS);return this.device.fillPanelBuffer(d.from(m.data),{format:"rgba"})};c.StreamDeckWeb=g}).call(this)}).call(this,a("buffer").Buffer)},{"@elgato-stream-deck/core":13,buffer:2}],"@elgato-stream-deck/webhid":[function(a,b,c){function d(t,w){var z,C,D,B;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){if(1==v.nextAddress){z=g.DEVICE_MODELS.find(function(x){return x.productId===t.productId});if(!z)throw Error("Stream Deck is of unexpected type.");
if(z.id===g.DeviceModelId.ORIGINAL&&(C=h.detect())&&"Linux"===C.os)throw Error("This is not supported on linux");return v.yield(t.open(),2)}D=Object.assign({},{useOriginalKeyOrder:!1,encodeJPEG:p.encodeJPEG},w);B=new z.class(new m.WebHIDDevice(t),D||{});return v.return(new l.StreamDeckWeb(B))})}Object.defineProperty(c,"__esModule",{value:!0});c.openDevice=c.getStreamDecks=c.requestStreamDecks=c.StreamDeckWeb=c.DeviceModelId=void 0;var h=a("detect-browser"),g=a("@elgato-stream-deck/core"),m=a("./device"),
p=a("./jpeg"),l=a("./wrapper"),n=a("@elgato-stream-deck/core");Object.defineProperty(c,"DeviceModelId",{enumerable:!0,get:function(){return n.DeviceModelId}});var q=a("./wrapper");Object.defineProperty(c,"StreamDeckWeb",{enumerable:!0,get:function(){return q.StreamDeckWeb}});c.requestStreamDecks=function(t){return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){return w.return(navigator.hid.requestDevice({filters:[{vendorId:g.VENDOR_ID}]}).then(function(z){return $jscomp.asyncExecutePromiseGeneratorProgram(function(C){return C.return(Promise.all(z.map(function(D){return d(D,
t)})))})}))})};c.getStreamDecks=function(t){return $jscomp.asyncExecutePromiseGeneratorProgram(function(w){return w.return(navigator.hid.getDevices().then(function(z){return $jscomp.asyncExecutePromiseGeneratorProgram(function(C){return C.return(Promise.all(z.map(function(D){return d(D,t)})))})}))})};c.openDevice=d},{"./device":25,"./jpeg":26,"./wrapper":27,"@elgato-stream-deck/core":13,"detect-browser":6}]},{},[]);Blockly.Blocks.text_to_speech={init:function(){this.appendValueInput("text").appendField("Text to Speech").setCheck("String");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("");this.setHelpUrl("")}};Blast.Toolbox.addBlock("text_to_speech","actions");
Blockly.Blocks.web_speech={init:function(){this.appendDummyInput().appendField("speech to text");this.setOutput(!0,"String");this.setColour(0);this.setTooltip("outputs speech command from microphone as a string");this.setHelpUrl("");this.firstTime=!0;this.recognition=null},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,"webkitSpeechRecognition"in window?this.recognition=new webkitSpeechRecognition:(Blockly.alert('Web Speech API is not supported by this browser.\n        Upgrade to <a href="//www.google.com/chrome">Chrome</a>\n        version 25 or later.'),
this.dispose()))}};Blast.Toolbox.addBlock("web_speech","actions");Blockly.JavaScript.text_to_speech=function(a){return"textToSpeech("+Blockly.JavaScript.valueToCode(a,"text",Blockly.JavaScript.ORDER_ATOMIC)+");\n"};Blockly.JavaScript.web_speech=function(a){return["webSpeech('"+a.id+"')",Blockly.JavaScript.ORDER_NONE]};
var webSpeech=function(a,b){var c,d,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){c=Blast.workspace.getBlockById(a);d=c.recognition;d.continuous=!1;d.lang="en-US";h="";d.onresult=function(m){for(var p=m.resultIndex;p<m.results.length;++p)m.results[p].isFinal&&(h+=m.results[p][0].transcript)};d.onend=function(){b(h)};d.start();g.jumpToEnd()})};Blast.asyncApiFunctions.push(["webSpeech",webSpeech]);
var textToSpeech=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return c=new SpeechSynthesisUtterance,c.text=a,window.speechSynthesis.speak(c),d.yield(new Promise(function(h){c.onend=h}),2);b();d.jumpToEnd()})};Blast.asyncApiFunctions.push(["textToSpeech",textToSpeech]);Blockly.Blocks.read_mijia_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("get").appendField(new Blockly.FieldDropdown([["temperature","temperature"],["humidity","humidity"]]),"measurement").appendField("property of Xiaomi Mijia");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads the selected property of a Xiaomi Mijia Thermometer.");this.setHelpUrl("")}};Blast.Toolbox.addBlock("read_mijia_property","Properties");Blockly.JavaScript.read_mijia_property=function(a){var b=Blockly.JavaScript.quote_(a.getFieldValue("measurement"));a=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC);return["readMijiaProperty("+b+", "+a+")",Blockly.JavaScript.ORDER_NONE]};var XiaomiServiceUUID="ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6";Blast.Bluetooth.optionalServices.push(XiaomiServiceUUID);
var readMijiaProperty=function(a,b,c){b?Blast.Bluetooth.gatt_subscribe(b,XiaomiServiceUUID,"ebe0ccc1-7a0a-4b0c-8a1a-6ff2997da3a6",function(d){var h=d.target.value,g=h.getUint8(1)&128;d=(h.getUint8(1)&127)<<8|h.getUint8(0);g&&(d-=32767);d/=100;h=h.getUint8(2);"temperature"===a?c(d):"humidity"===a&&c(h)}):(Blast.throwError("No Thermometer is set."),c())};Blast.asyncApiFunctions.push(["readMijiaProperty",readMijiaProperty]);
