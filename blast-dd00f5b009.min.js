/*
 https://www.gnu.org/licenses/agpl-3.0.de.html AGPLv3
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];if(!(f in c))return;c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var f=a.split(".");a=1===f.length;d=f[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<f.length-1;h++){var g=f[h];if(!(g in d))return;d=d[g]}f=f[f.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[f]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,f,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[f]&&($jscomp.propertyToPolyfillSymbol[f]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(f):
$jscomp.POLYFILL_PREFIX+f),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[f],{configurable:!0,writable:!0,value:b})))};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(c){return{value:c,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var f=d.value}catch(h){return this.context_.yieldAllIterator_=null,this.context_.throw_(h),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,f){function h(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(h,f)}h(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,h){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:h})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(f){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(f||"")+"_"+c++,f)};return d},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(g){return g instanceof f?g:new f(function(l,k){l(g)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(g){if(null==this.batch_){this.batch_=[];var l=this;this.asyncExecuteFunction(function(){l.executeBatch_()})}this.batch_.push(g)};
var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(g){d(g,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var g=this.batch_;this.batch_=[];for(var l=0;l<g.length;++l){var k=g[l];g[l]=null;try{k()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};b.prototype.asyncThrow_=function(g){this.asyncExecuteFunction(function(){throw g;})};var f=function(g){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var l=this.createResolveAndReject_();
try{g(l.resolve,l.reject)}catch(k){l.reject(k)}};f.prototype.createResolveAndReject_=function(){function g(m){return function(n){k||(k=!0,m.call(l,n))}}var l=this,k=!1;return{resolve:g(this.resolveTo_),reject:g(this.reject_)}};f.prototype.resolveTo_=function(g){if(g===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof f)this.settleSameAsPromise_(g);else{a:switch(typeof g){case "object":var l=null!=g;break a;case "function":l=!0;break a;default:l=!1}l?this.resolveToNonPromiseObj_(g):
this.fulfill_(g)}};f.prototype.resolveToNonPromiseObj_=function(g){var l=void 0;try{l=g.then}catch(k){this.reject_(k);return}"function"==typeof l?this.settleSameAsThenable_(l,g):this.fulfill_(g)};f.prototype.reject_=function(g){this.settle_(2,g)};f.prototype.fulfill_=function(g){this.settle_(1,g)};f.prototype.settle_=function(g,l){if(0!=this.state_)throw Error("Cannot settle("+g+", "+l+"): Promise already settled in state"+this.state_);this.state_=g;this.result_=l;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};f.prototype.scheduleUnhandledRejectionCheck_=function(){var g=this;d(function(){if(g.notifyUnhandledRejection_()){var l=$jscomp.global.console;"undefined"!==typeof l&&l.error(g.result_)}},1)};f.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var g=$jscomp.global.CustomEvent,l=$jscomp.global.Event,k=$jscomp.global.dispatchEvent;if("undefined"===typeof k)return!0;"function"===typeof g?g=new g("unhandledrejection",{cancelable:!0}):
"function"===typeof l?g=new l("unhandledrejection",{cancelable:!0}):(g=$jscomp.global.document.createEvent("CustomEvent"),g.initCustomEvent("unhandledrejection",!1,!0,g));g.promise=this;g.reason=this.result_;return k(g)};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var g=0;g<this.onSettledCallbacks_.length;++g)h.asyncExecute(this.onSettledCallbacks_[g]);this.onSettledCallbacks_=null}};var h=new b;f.prototype.settleSameAsPromise_=function(g){var l=this.createResolveAndReject_();
g.callWhenSettled_(l.resolve,l.reject)};f.prototype.settleSameAsThenable_=function(g,l){var k=this.createResolveAndReject_();try{g.call(l,k.resolve,k.reject)}catch(m){k.reject(m)}};f.prototype.then=function(g,l){function k(q,r){return"function"==typeof q?function(t){try{m(q(t))}catch(v){n(v)}}:r}var m,n,p=new f(function(q,r){m=q;n=r});this.callWhenSettled_(k(g,m),k(l,n));return p};f.prototype.catch=function(g){return this.then(void 0,g)};f.prototype.callWhenSettled_=function(g,l){function k(){switch(m.state_){case 1:g(m.result_);
break;case 2:l(m.result_);break;default:throw Error("Unexpected state: "+m.state_);}}var m=this;null==this.onSettledCallbacks_?h.asyncExecute(k):this.onSettledCallbacks_.push(k);this.isRejectionHandled_=!0};f.resolve=c;f.reject=function(g){return new f(function(l,k){k(g)})};f.race=function(g){return new f(function(l,k){for(var m=$jscomp.makeIterator(g),n=m.next();!n.done;n=m.next())c(n.value).callWhenSettled_(l,k)})};f.all=function(g){var l=$jscomp.makeIterator(g),k=l.next();return k.done?c([]):new f(function(m,
n){function p(t){return function(v){q[t]=v;r--;0==r&&m(q)}}var q=[],r=0;do q.push(void 0),r++,c(k.value).callWhenSettled_(p(q.length-1),n),k=l.next();while(!k.done)})};return f},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,f=0;f<d;f++){var h=a[f];if(b.call(c,h,f,a))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,f){return c==a&&"q"==d&&f==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var m=Object.seal({}),n=Object.seal({}),p=new a([[m,2],[n,3]]);if(2!=p.get(m)||3!=p.get(n))return!1;p.delete(m);p.set(n,4);return!p.has(m)&&4==p.get(n)}catch(q){return!1}}function c(){}function d(m){var n=typeof m;return"object"===n&&null!==m||"function"===n}function f(m){if(!$jscomp.owns(m,g)){var n=new c;$jscomp.defineProperty(m,g,{value:n})}}function h(m){if(!$jscomp.ISOLATE_POLYFILLS){var n=Object[m];n&&(Object[m]=
function(p){if(p instanceof c)return p;Object.isExtensible(p)&&f(p);return n(p)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var g="$jscomp_hidden_"+Math.random();h("freeze");h("preventExtensions");h("seal");var l=0,k=function(m){this.id_=(l+=Math.random()+1).toString();if(m){m=$jscomp.makeIterator(m);for(var n;!(n=m.next()).done;)n=n.value,this.set(n[0],n[1])}};k.prototype.set=function(m,n){if(!d(m))throw Error("Invalid WeakMap key");
f(m);if(!$jscomp.owns(m,g))throw Error("WeakMap key fail: "+m);m[g][this.id_]=n;return this};k.prototype.get=function(m){return d(m)&&$jscomp.owns(m,g)?m[g][this.id_]:void 0};k.prototype.has=function(m){return d(m)&&$jscomp.owns(m,g)&&$jscomp.owns(m[g],this.id_)};k.prototype.delete=function(m){return d(m)&&$jscomp.owns(m,g)&&$jscomp.owns(m[g],this.id_)?delete m[g][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var k=Object.seal({x:4}),m=new a($jscomp.makeIterator([[k,"s"]]));if("s"!=m.get(k)||1!=m.size||m.get({x:4})||m.set({x:4},"t")!=m||2!=m.size)return!1;var n=m.entries(),p=n.next();if(p.done||p.value[0]!=k||"s"!=p.value[1])return!1;p=n.next();return p.done||4!=p.value[0].x||"t"!=p.value[1]||!n.next().done?!1:!0}catch(q){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var c=new WeakMap,d=function(k){this.data_={};this.head_=g();this.size=0;if(k){k=$jscomp.makeIterator(k);for(var m;!(m=k.next()).done;)m=m.value,this.set(m[0],m[1])}};d.prototype.set=function(k,m){k=0===k?0:k;var n=f(this,k);n.list||(n.list=this.data_[n.id]=[]);n.entry?n.entry.value=m:(n.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:k,value:m},n.list.push(n.entry),
this.head_.previous.next=n.entry,this.head_.previous=n.entry,this.size++);return this};d.prototype.delete=function(k){k=f(this,k);return k.entry&&k.list?(k.list.splice(k.index,1),k.list.length||delete this.data_[k.id],k.entry.previous.next=k.entry.next,k.entry.next.previous=k.entry.previous,k.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(k){return!!f(this,k).entry};d.prototype.get=function(k){return(k=
f(this,k).entry)&&k.value};d.prototype.entries=function(){return h(this,function(k){return[k.key,k.value]})};d.prototype.keys=function(){return h(this,function(k){return k.key})};d.prototype.values=function(){return h(this,function(k){return k.value})};d.prototype.forEach=function(k,m){for(var n=this.entries(),p;!(p=n.next()).done;)p=p.value,k.call(m,p[1],p[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var f=function(k,m){var n=m&&typeof m;"object"==n||"function"==n?c.has(m)?n=c.get(m):
(n=""+ ++l,c.set(m,n)):n="p_"+m;var p=k.data_[n];if(p&&$jscomp.owns(k.data_,n))for(k=0;k<p.length;k++){var q=p[k];if(m!==m&&q.key!==q.key||m===q.key)return{id:n,list:p,index:k,entry:q}}return{id:n,list:p,index:-1,entry:void 0}},h=function(k,m){var n=k.head_;return $jscomp.iteratorPrototype(function(){if(n){for(;n.head!=k.head_;)n=n.previous;for(;n.next!=n.head;)return n=n.next,{done:!1,value:m(n)};n=null}return{done:!0,value:void 0}})},g=function(){var k={};return k.previous=k.next=k.head=k},l=0;
return d},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var h=d[c];if(h===b||Object.is(h,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,f={next:function(){if(!d&&c<a.length){var h=c++;return{value:b(h,a[h]),done:!1}}d=!0;return{done:!0,value:void 0}}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).i}},"es6","es3");$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var f=d.length,h=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var g=0;g<h&&c<f;)if(d[c++]!=b[g++])return!1;return g>=h}},"es6","es3");
$jscomp.polyfill("Object.values",function(a){return a?a:function(b){var c=[],d;for(d in b)$jscomp.owns(b,d)&&c.push(b[d]);return c}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(b,c,d){var f=this.length||0;0>c&&(c=Math.max(0,f+c));if(null==d||d>f)d=f;d=Number(d);0>d&&(d=Math.max(0,f+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};
$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
var Blast={Toolbox:{}},module$contents$Blast$Toolbox_defaultToolbox={kind:"categoryToolbox",contents:[{kind:"CATEGORY",contents:[],name:"Things and Resources",custom:"THINGS",colour:"60"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[],name:"Properties",colour:"255"},{kind:"CATEGORY",contents:[],name:"Actions",colour:"0"},{kind:"CATEGORY",contents:[],name:"States and Events",custom:"STATES",colour:"180"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[],name:"Requests and Queries",colour:"0"},
{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"while_until"},{kind:"BLOCK",type:"break_continue"},{kind:"BLOCK",type:"conditional_statement"},{kind:"BLOCK",type:"controls_forEach"}],name:"Control Flow",colour:"120"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"logic_compare"},{kind:"BLOCK",type:"logic_operation"},{kind:"BLOCK",type:"logic_negate"}],name:"Boolean Expressions",colour:"210"},{kind:"CATEGORY",contents:[],name:"Functions",colour:"290",custom:"PROCEDURE"},{kind:"CATEGORY",
contents:[{kind:"BLOCK",type:"lists_create_empty"},{kind:"BLOCK",type:"lists_create_with"},{kind:"BLOCK",type:"lists_repeat"},{kind:"BLOCK",type:"lists_length"},{kind:"BLOCK",type:"lists_isEmpty"},{kind:"BLOCK",type:"lists_indexOf"},{kind:"BLOCK",type:"lists_getIndex"},{kind:"BLOCK",type:"lists_setIndex"},{kind:"BLOCK",type:"lists_getSublist"},{kind:"BLOCK",type:"lists_sort"},{kind:"BLOCK",type:"lists_split"},{kind:"BLOCK",type:"lists_reverse"}],name:"Lists",colour:"310"},{kind:"CATEGORY",contents:[],
name:"Variables",custom:"VARIABLE",colour:"330"},{kind:"sep",gap:"32"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"string"},{kind:"BLOCK",type:"string_multiline"},{kind:"BLOCK",type:"string_join"},{kind:"BLOCK",type:"string_length"},{kind:"BLOCK",type:"string_isEmpty"},{kind:"BLOCK",type:"string_indexOf"},{kind:"BLOCK",type:"string_charAt"},{kind:"BLOCK",type:"string_getSubstring"},{kind:"BLOCK",type:"string_changeCase"},{kind:"BLOCK",type:"string_trim"},{kind:"BLOCK",type:"string_count"},{kind:"BLOCK",
type:"string_replace"},{kind:"BLOCK",type:"string_reverse"},{kind:"BLOCK",type:"string_showPrompt"}],name:"Strings",colour:"160"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"number_value"},{kind:"BLOCK",type:"number_arithmetic"},{kind:"BLOCK",type:"number_single"},{kind:"BLOCK",type:"number_trig"},{kind:"BLOCK",type:"number_constant"},{kind:"BLOCK",type:"number_property"},{kind:"BLOCK",type:"number_round"},{kind:"BLOCK",type:"number_on_list"},{kind:"BLOCK",type:"number_modulo"},{kind:"BLOCK",type:"number_constrain"},
{kind:"BLOCK",type:"number_random"},{kind:"BLOCK",type:"number_random_float"},{kind:"BLOCK",type:"number_atan2"}],name:"Numbers",colour:"230"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"logic_boolean"}],name:"Booleans",colour:"210"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"colour_picker"},{kind:"BLOCK",type:"colour_random"}],name:"Colours",colour:"20"}]},module$contents$Blast$Toolbox_currentToolbox=module$contents$Blast$Toolbox_defaultToolbox;Blast.Toolbox.currentToolbox=module$contents$Blast$Toolbox_defaultToolbox;
var module$contents$Blast$Toolbox_getCategory=function(a){return module$contents$Blast$Toolbox_defaultToolbox.contents.find(function(b){return b.name?b.name.toLowerCase()===a.toLowerCase():!1})};Blast.Toolbox.getCategory=module$contents$Blast$Toolbox_getCategory;var module$contents$Blast$Toolbox_addBlock=function(a,b,c){a={kind:"BLOCK",type:a,blockxml:c};(b=module$contents$Blast$Toolbox_getCategory(b))&&b.contents.push(a)};Blast.Toolbox.addBlock=module$contents$Blast$Toolbox_addBlock;Blast.Interpreter={};var module$contents$Blast$Interpreter_interpreter=null;Blast.Interpreter.interpreter=module$contents$Blast$Interpreter_interpreter;var module$contents$Blast$Interpreter_getInterpreter=function(){return module$contents$Blast$Interpreter_interpreter};Blast.Interpreter.getInterpreter=module$contents$Blast$Interpreter_getInterpreter;var module$contents$Blast$Interpreter_apiFunctions=[];Blast.Interpreter.apiFunctions=module$contents$Blast$Interpreter_apiFunctions;
var module$contents$Blast$Interpreter_asyncApiFunctions=[];Blast.Interpreter.asyncApiFunctions=module$contents$Blast$Interpreter_asyncApiFunctions;var module$contents$Blast$Interpreter_interrupted=!1,module$contents$Blast$Interpreter_getInterrupted=function(){return module$contents$Blast$Interpreter_interrupted};Blast.Interpreter.getInterrupted=module$contents$Blast$Interpreter_getInterrupted;
var module$contents$Blast$Interpreter_setInterrupted=function(a){module$contents$Blast$Interpreter_interrupted=a};Blast.Interpreter.setInterrupted=module$contents$Blast$Interpreter_setInterrupted;module$contents$Blast$Interpreter_apiFunctions.push(["setInterrupted",module$contents$Blast$Interpreter_setInterrupted]);var module$contents$Blast$Interpreter_statusValues={READY:"ready",RUNNING:"running",STOPPED:"stopped",ERROR:"error"};Blast.Interpreter.statusValues=module$contents$Blast$Interpreter_statusValues;
var module$contents$Blast$Interpreter_status=module$contents$Blast$Interpreter_statusValues.READY,module$contents$Blast$Interpreter_onStatusChange={ready:[],running:[],stopped:[],error:[]};Blast.Interpreter.onStatusChange=module$contents$Blast$Interpreter_onStatusChange;
var module$contents$Blast$Interpreter_setStatus=function(a){if(module$contents$Blast$Interpreter_status!==a){module$contents$Blast$Interpreter_status=a;a=$jscomp.makeIterator(module$contents$Blast$Interpreter_onStatusChange[module$contents$Blast$Interpreter_status]);for(var b=a.next();!b.done;b=a.next())b=b.value,b()}},module$contents$Blast$Interpreter_latestCode="",module$contents$Blast$Interpreter_getLatestCode=function(){return module$contents$Blast$Interpreter_latestCode};
Blast.Interpreter.getLatestCode=module$contents$Blast$Interpreter_getLatestCode;var module$contents$Blast$Interpreter_runner_=null,module$contents$Blast$Interpreter_workspace=null,module$contents$Blast$Interpreter_getWorkspace=function(){return module$contents$Blast$Interpreter_workspace};Blast.Interpreter.getWorkspace=module$contents$Blast$Interpreter_getWorkspace;var module$contents$Blast$Interpreter_intervalEvents=[];Blast.Interpreter.intervalEvents=module$contents$Blast$Interpreter_intervalEvents;
var module$contents$Blast$Interpreter_eventsInWorkspace=[];Blast.Interpreter.eventsInWorkspace=module$contents$Blast$Interpreter_eventsInWorkspace;var module$contents$Blast$Interpreter_deviceEventHandlers=[];Blast.Interpreter.deviceEventHandlers=module$contents$Blast$Interpreter_deviceEventHandlers;var module$contents$Blast$Interpreter_cleanUpFunctions=[];Blast.Interpreter.cleanUpFunctions=module$contents$Blast$Interpreter_cleanUpFunctions;
var module$contents$Blast$Interpreter_statesInterpreterRunning=!1,module$contents$Blast$Interpreter_setStatesInterpreterRunning=function(a){module$contents$Blast$Interpreter_statesInterpreterRunning=a};Blast.Interpreter.setStatesInterpreterRunning=module$contents$Blast$Interpreter_setStatesInterpreterRunning;var module$contents$Blast$Interpreter_stdOut=prompt,module$contents$Blast$Interpreter_setStdOut=function(a){module$contents$Blast$Interpreter_stdOut=a};Blast.Interpreter.setStdOut=module$contents$Blast$Interpreter_setStdOut;
var module$contents$Blast$Interpreter_getStdOut=function(){return module$contents$Blast$Interpreter_stdOut};Blast.Interpreter.getStdOut=module$contents$Blast$Interpreter_getStdOut;var module$contents$Blast$Interpreter_stdInfo=prompt,module$contents$Blast$Interpreter_setStdInfo=function(a){module$contents$Blast$Interpreter_stdInfo=a};Blast.Interpreter.setStdInfo=module$contents$Blast$Interpreter_setStdInfo;var module$contents$Blast$Interpreter_getStdInfo=function(){return module$contents$Blast$Interpreter_stdInfo};
Blast.Interpreter.getStdInfo=module$contents$Blast$Interpreter_getStdInfo;var module$contents$Blast$Interpreter_stdErr=prompt,module$contents$Blast$Interpreter_setStdError=function(a){module$contents$Blast$Interpreter_stdErr=a};Blast.Interpreter.setStdError=module$contents$Blast$Interpreter_setStdError;var module$contents$Blast$Interpreter_getStdError=function(){return module$contents$Blast$Interpreter_stdErr};Blast.Interpreter.getStdError=module$contents$Blast$Interpreter_getStdError;
var module$contents$Blast$Interpreter_removeDeviceHandlers=function(){for(var a=$jscomp.makeIterator(module$contents$Blast$Interpreter_deviceEventHandlers),b=a.next();!b.done;b=a.next())b=b.value,b.device.removeEventListener(b.type,b.fn);module$contents$Blast$Interpreter_deviceEventHandlers=[]},module$contents$Blast$Interpreter_clearIntervalEvents=function(){for(var a=$jscomp.makeIterator(module$contents$Blast$Interpreter_intervalEvents),b=a.next();!b.done;b=a.next())clearInterval(b.value);module$contents$Blast$Interpreter_intervalEvents=
[]},module$contents$Blast$Interpreter_resetInterpreter=function(){module$contents$Blast$Interpreter_interpreter=null;module$contents$Blast$Interpreter_runner_&&(clearTimeout(module$contents$Blast$Interpreter_runner_),module$contents$Blast$Interpreter_runner_=null);Blast.Bluetooth.tearDown();module$contents$Blast$Interpreter_removeDeviceHandlers();module$contents$Blast$Interpreter_clearIntervalEvents();for(var a=$jscomp.makeIterator(module$contents$Blast$Interpreter_cleanUpFunctions),b=a.next();!b.done;b=
a.next())b=b.value,b()};Blast.Interpreter.resetInterpreter=module$contents$Blast$Interpreter_resetInterpreter;var module$contents$Blast$Interpreter_stopJS=function(){module$contents$Blast$Interpreter_resetInterpreter();module$contents$Blast$Interpreter_setStatus(module$contents$Blast$Interpreter_statusValues.STOPPED)};Blast.Interpreter.stopJS=module$contents$Blast$Interpreter_stopJS;
var module$contents$Blast$Interpreter_throwError=function(a){a||(a="Error executing program - See console for details.");module$contents$Blast$Interpreter_stdErr(a);module$contents$Blast$Interpreter_setStatus(module$contents$Blast$Interpreter_statusValues.ERROR);module$contents$Blast$Interpreter_resetInterpreter();module$contents$Blast$Interpreter_stdInfo("Execution stopped")};Blast.Interpreter.throwError=module$contents$Blast$Interpreter_throwError;
var module$contents$Blast$Interpreter_generateCode=function(){Blockly.JavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n";Blockly.JavaScript.addReservedWords("highlightBlock");module$contents$Blast$Interpreter_latestCode="";module$contents$Blast$Interpreter_latestCode=Blockly.JavaScript.workspaceToCode(module$contents$Blast$Interpreter_workspace)};
function module$contents$Blast$Interpreter_initApi(a,b){for(var c=$jscomp.makeIterator(module$contents$Blast$Interpreter_apiFunctions),d=c.next();!d.done;d=c.next())d=d.value,Blockly.JavaScript.addReservedWords(d[0]),a.setProperty(b,d[0],a.createNativeFunction(d[1]));c=$jscomp.makeIterator(module$contents$Blast$Interpreter_asyncApiFunctions);for(d=c.next();!d.done;d=c.next())d=d.value,a.setProperty(b,d[0],a.createAsyncFunction(d[1]))}
var module$contents$Blast$Interpreter_initInterpreter=function(){module$contents$Blast$Interpreter_workspace=Blockly.inject("content_workspace",{media:"media/",toolbox:module$contents$Blast$Toolbox_defaultToolbox,zoom:{controls:!0,wheel:!0}});module$contents$Blast$Interpreter_generateCode();module$contents$Blast$Interpreter_workspace.addChangeListener(function(a){a instanceof Blockly.Events.Ui||module$contents$Blast$Interpreter_generateCode()})};Blast.Interpreter.initInterpreter=module$contents$Blast$Interpreter_initInterpreter;
var module$contents$Blast$Interpreter_runJS=function(){module$contents$Blast$Interpreter_setStatus(module$contents$Blast$Interpreter_statusValues.RUNNING);module$contents$Blast$Interpreter_stdInfo("execution started");null==module$contents$Blast$Interpreter_interpreter&&(module$contents$Blast$Interpreter_interpreter=new Interpreter(module$contents$Blast$Interpreter_latestCode,module$contents$Blast$Interpreter_initApi),module$contents$Blast$Interpreter_runner_=function(){if(module$contents$Blast$Interpreter_interpreter)try{module$contents$Blast$Interpreter_interrupted?
setTimeout(module$contents$Blast$Interpreter_runner_,1):module$contents$Blast$Interpreter_interpreter.step()?setTimeout(module$contents$Blast$Interpreter_runner_,1):module$contents$Blast$Interpreter_statesInterpreterRunning||0<module$contents$Blast$Interpreter_eventsInWorkspace.length||(module$contents$Blast$Interpreter_setStatus(module$contents$Blast$Interpreter_statusValues.READY),module$contents$Blast$Interpreter_stdInfo("execution completed"),module$contents$Blast$Interpreter_resetInterpreter())}catch(a){module$contents$Blast$Interpreter_throwError(a),
module$contents$Blast$Interpreter_resetInterpreter(),console.error(a)}},module$contents$Blast$Interpreter_runner_())};Blast.Interpreter.runJS=module$contents$Blast$Interpreter_runJS;Blast.States={};var module$contents$Blast$States_StateBlock;Blast.States.StateBlock=module$contents$Blast$States_StateBlock;var module$contents$Blast$States_eventValues=new Map,module$contents$Blast$States_eventChecker=function(a,b){var c=module$contents$Blast$States_eventValues.get(a);module$contents$Blast$States_eventValues.set(a,b);return void 0!=c?!c&&b:!1};module$contents$Blast$Interpreter_apiFunctions.push(["eventChecker",module$contents$Blast$States_eventChecker]);
var module$contents$Blast$States_allStates=function(a){return a.getBlocksByType("state_definition",!1).map(function(b){return b.getStateDef()[0]})},module$contents$Blast$States_findLegalName=function(a,b){if(b.isInFlyout)return a;for(a=a||Blockly.Msg.UNNAMED_KEY||"unnamed";!module$contents$Blast$States_isLegalName_(a,b.workspace,b);){var c=a.match(/^(.*?)(\d+)$/);a=c?c[1]+(parseInt(c[2],10)+1):a+"2"}return a};Blast.States.findLegalName=module$contents$Blast$States_findLegalName;
var module$contents$Blast$States_isLegalName_=function(a,b,c){return!module$contents$Blast$States_isNameUsed(a,b,c)},module$contents$Blast$States_isNameUsed=function(a,b,c){b=b.getAllBlocks(!1);b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())if(d=d.value,d!=c&&d.getStateDef&&(d=d.getStateDef()[0],Blockly.Names.equals(d,a)))return!0;return!1},module$contents$Blast$States_rename=function(a){a=a.trim();var b=module$contents$Blast$States_findLegalName(a,this.getSourceBlock()),c=this.getValue();
if(c!=a&&c!=b){a=this.getSourceBlock().workspace.getAllBlocks(!1);a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,d.renameState&&d.renameState(c,b)}return b};Blast.States.rename=module$contents$Blast$States_rename;
var module$contents$Blast$States_flyoutCategory=function(a){var b=[],c=Blockly.utils.xml.createElement("block");c.setAttribute("type","event_every_minutes");b.push(c);if(Blockly.Blocks.state_definition){c=Blockly.utils.xml.createElement("block");c.setAttribute("type","state_definition");c.setAttribute("gap",16);var d=Blockly.utils.xml.createElement("field");d.setAttribute("name","NAME");d.appendChild(Blockly.utils.xml.createTextNode("state name"));c.appendChild(d);b.push(c)}b.length&&b[b.length-1].setAttribute("gap",
24);a=module$contents$Blast$States_allStates(a);0==a.length&&(c=Blockly.utils.xml.createElement("block"),c.setAttribute("type","event"),c.setAttribute("gap",16),c.setAttribute("disabled",!0),d=Blockly.utils.xml.createElement("mutation"),d.setAttribute("name","state name"),c.appendChild(d),b.push(c));a=$jscomp.makeIterator(a);for(c=a.next();!c.done;c=a.next()){c=c.value;d=Blockly.utils.xml.createElement("block");d.setAttribute("type","event");d.setAttribute("gap",16);var f=Blockly.utils.xml.createElement("mutation");
f.setAttribute("name",c);d.appendChild(f);b.push(d)}if(a=module$contents$Blast$Toolbox_getCategory("States and Events"))for(a=$jscomp.makeIterator(a.contents),c=a.next();!c.done;c=a.next())c=c.value,d=Blockly.utils.xml.createElement("block"),d.setAttribute("type",c.type),d.setAttribute("gap",16),b.push(d);return b};Blast.States.flyoutCategory=module$contents$Blast$States_flyoutCategory;
var module$contents$Blast$States_getDefinition=function(a,b){b=b.getTopBlocks(!1);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,c.getStateDef){var d=c.getStateDef()[0];if(d&&Blockly.Names.equals(d,a))return c}return null};Blast.States.getDefinition=module$contents$Blast$States_getDefinition;Blast.States.Interpreter={};var module$contents$Blast$States$Interpreter_stateInterpreter=null,module$contents$Blast$States$Interpreter_workspace=null,module$contents$Blast$States$Interpreter_runner_=null,module$contents$Blast$States$Interpreter_latestCode="",module$contents$Blast$States$Interpreter_eventCode=new Map,module$contents$Blast$States$Interpreter_addEventCode=function(a,b){module$contents$Blast$States$Interpreter_eventCode.set(a,b)};Blast.States.Interpreter.addEventCode=module$contents$Blast$States$Interpreter_addEventCode;
var module$contents$Blast$States$Interpreter_removeEventCode=function(a){module$contents$Blast$States$Interpreter_eventCode.delete(a)};Blast.States.Interpreter.removeEventCode=module$contents$Blast$States$Interpreter_removeEventCode;
var module$contents$Blast$States$Interpreter_generateCode=function(){for(var a="while (true) {\n \n}",b=module$contents$Blast$States$Interpreter_workspace.getBlocksByType("event",!1).map(function(h){return h.id}),c=$jscomp.makeIterator(module$contents$Blast$States$Interpreter_eventCode),d=c.next();!d.done;d=c.next()){var f=$jscomp.makeIterator(d.value);d=f.next().value;f=f.next().value;b.includes(d)&&(a=a.slice(0,-2)+f+"\n"+a.slice(-1))}module$contents$Blast$States$Interpreter_latestCode=Blockly.JavaScript.finish(a)};
Blast.States.Interpreter.generateEventCode=module$contents$Blast$States$Interpreter_generateCode;
var module$contents$Blast$States$Interpreter_startEventChecker=function(){module$contents$Blast$States$Interpreter_stateInterpreter=null;module$contents$Blast$States$Interpreter_stateInterpreter=new Interpreter("");module$contents$Blast$States$Interpreter_stateInterpreter.stateStack[0].scope=module$contents$Blast$Interpreter_getInterpreter().globalScope;module$contents$Blast$States$Interpreter_stateInterpreter.appendCode(module$contents$Blast$States$Interpreter_latestCode);module$contents$Blast$Interpreter_setStatesInterpreterRunning(!0);
module$contents$Blast$States$Interpreter_runner_=function(){if(module$contents$Blast$States$Interpreter_stateInterpreter)try{module$contents$Blast$States$Interpreter_stateInterpreter.step(),setTimeout(module$contents$Blast$States$Interpreter_runner_,1)}catch(a){module$contents$Blast$Interpreter_throwError("Error executing program:\n%e".replace("%e",a)),module$contents$Blast$Interpreter_resetInterpreter(),console.error(a)}};module$contents$Blast$States$Interpreter_runner_()};
module$contents$Blast$Interpreter_apiFunctions.push(["startEventChecker",module$contents$Blast$States$Interpreter_startEventChecker]);var module$contents$Blast$States$Interpreter_resetInterpreter=function(){clearTimeout(module$contents$Blast$States$Interpreter_runner_);module$contents$Blast$States$Interpreter_runner_=null;module$contents$Blast$Interpreter_setStatesInterpreterRunning(!1)};module$contents$Blast$Interpreter_onStatusChange.stopped.push(module$contents$Blast$States$Interpreter_resetInterpreter);
var module$contents$Blast$States$Interpreter_init=function(a){module$contents$Blast$States$Interpreter_workspace=a;module$contents$Blast$States$Interpreter_workspace.addChangeListener(function(b){b instanceof Blockly.Events.Ui||module$contents$Blast$States$Interpreter_generateCode()})};Blast.States.Interpreter.initStatesInterpreter=module$contents$Blast$States$Interpreter_init;Blast.Ui={};var module$contents$Blast$Ui_TABS_=["workspace","javascript","xml","deviceLogs"];Blast.Ui.TABS_=module$contents$Blast$Ui_TABS_;
var module$contents$Blast$Ui_selected_="workspace",module$contents$Blast$Ui_playIcon_='<span class="icon material-icons">play_arrow</span>',module$contents$Blast$Ui_stopIcon_='<span class="icon material-icons">stop</span>',module$contents$Blast$Ui_messageCounter_=0,module$contents$Blast$Ui_messageOutputContainer=null,module$contents$Blast$Ui_statusContainer=null,module$contents$Blast$Ui_runButton=null,module$contents$Blast$Ui_workspace=null,module$contents$Blast$Ui_bindClick=function(a,b){"string"==
typeof a&&(a=document.getElementById(a));a.addEventListener("click",b,!0);a.addEventListener("touchend",b,!0)};Blast.Ui.bindClick=module$contents$Blast$Ui_bindClick;
var module$contents$Blast$Ui_setStatus=function(a){if(a===module$contents$Blast$Interpreter_statusValues.RUNNING){var b=module$contents$Blast$Interpreter_stopJS;var c=module$contents$Blast$Ui_stopIcon_;var d="Stop the execution"}else b=module$contents$Blast$Interpreter_runJS,c=module$contents$Blast$Ui_playIcon_,d="Run block program";module$contents$Blast$Ui_runButton.onclick=b;module$contents$Blast$Ui_runButton.title=d;module$contents$Blast$Ui_runButton.innerHTML=c;module$contents$Blast$Ui_statusContainer.innerHTML=
a};module$contents$Blast$Interpreter_onStatusChange.stopped.push(function(){return module$contents$Blast$Ui_setStatus(module$contents$Blast$Interpreter_statusValues.STOPPED)});module$contents$Blast$Interpreter_onStatusChange.running.push(function(){return module$contents$Blast$Ui_setStatus(module$contents$Blast$Interpreter_statusValues.RUNNING)});var module$contents$Blast$Ui_resetUi=function(a){module$contents$Blast$Ui_workspace.highlightBlock(null);module$contents$Blast$Ui_setStatus(a)};module$contents$Blast$Interpreter_onStatusChange.stopped.push(function(){return module$contents$Blast$Ui_resetUi(module$contents$Blast$Interpreter_statusValues.STOPPED)});
module$contents$Blast$Interpreter_onStatusChange.running.push(function(){return module$contents$Blast$Ui_resetUi(module$contents$Blast$Interpreter_statusValues.RUNNING)});module$contents$Blast$Interpreter_onStatusChange.ready.push(function(){return module$contents$Blast$Ui_resetUi(module$contents$Blast$Interpreter_statusValues.READY)});module$contents$Blast$Interpreter_onStatusChange.error.push(function(){return module$contents$Blast$Ui_resetUi(module$contents$Blast$Interpreter_statusValues.ERROR)});
var module$contents$Blast$Ui_addElementToOutputContainer=function(a){100<module$contents$Blast$Ui_messageCounter_&&module$contents$Blast$Ui_messageOutputContainer.firstChild.remove();module$contents$Blast$Ui_messageOutputContainer.appendChild(a,module$contents$Blast$Ui_messageOutputContainer.firstChild);module$contents$Blast$Ui_messageOutputContainer.scrollTop=module$contents$Blast$Ui_messageOutputContainer.scrollHeight};Blast.Ui.addElementToOutputContainer=module$contents$Blast$Ui_addElementToOutputContainer;
var module$contents$Blast$Ui_addMessage=function(a,b){var c="media/logo-512x512.png";window.location.href.includes("mobile")&&(c="../"+c);document.hasFocus()||navigator.serviceWorker.ready.then(function(g){g.showNotification("Blast",{body:a,icon:c,vibrate:[200,100,200,100,200,100,200]})});var d=document.createElement("div");d.classList.add("message");b&&d.classList.add(b+"-message");d.id="message-"+module$contents$Blast$Ui_messageCounter_++;var f=document.createTextNode(a);d.appendChild(f);f=document.createElement("span");
f.classList.add("time");f.innerHTML=(new Date).toLocaleTimeString();d.appendChild(f);f=function(){document.getElementById("debugModal").style.display="block";var g=document.getElementById("debug-tbody");g.innerHTML="";var l=document.createElement("tr");l.innerHTML="<td>BLAST</td><td>"+rev+"</td>";g.appendChild(l);for(var k in navigator)if("string"===typeof navigator[k]){l=document.createElement("tr");var m=document.createElement("td"),n=document.createElement("td");m.innerHTML=k;n.innerHTML=navigator[k];
l.appendChild(m);l.appendChild(n);g.appendChild(l)}};if("error"===b){b=document.createElement("span");b.classList.add("debug-info");var h=document.createElement("a");h.innerHTML="show debug info";h.href="#";h.onclick=f;b.appendChild(h);d.appendChild(b)}module$contents$Blast$Ui_addElementToOutputContainer(d)};module$contents$Blast$Interpreter_setStdError(function(a){return module$contents$Blast$Ui_addMessage(a,"error")});
module$contents$Blast$Interpreter_setStdInfo(function(a){return module$contents$Blast$Ui_addMessage(a,"info")});module$contents$Blast$Interpreter_setStdOut(function(a){return module$contents$Blast$Ui_addMessage(a)});
var module$contents$Blast$Ui_tabClick_=function(a){for(var b=$jscomp.makeIterator(module$contents$Blast$Ui_TABS_),c=b.next();!c.done;c=b.next()){c=c.value;var d=document.getElementById("tab_"+c);d.classList.add("taboff");d.classList.remove("tabon");document.getElementById("content_"+c).style.visibility="hidden"}module$contents$Blast$Ui_selected_=a;b=document.getElementById("tab_"+a);b.classList.remove("taboff");b.classList.add("tabon");document.getElementById("content_"+a).style.visibility="visible";
Blockly.svgResize(module$contents$Blast$Ui_workspace)},module$contents$Blast$Ui_renderContent_=function(){var a=document.getElementById("content_xml"),b=Blockly.Xml.workspaceToDom(module$contents$Blast$Ui_workspace);b=Blockly.Xml.domToPrettyText(b);a.value=b;a.focus();a=document.getElementById("content_javascript");a.textContent=module$contents$Blast$Interpreter_getLatestCode().replace(/highlightBlock\('.*'\);\n/gm,"");a.className=a.className.replace("prettyprinted","");"object"==typeof PR&&PR.prettyPrint()},
module$contents$Blast$Ui_addToLog=function(a,b,c){var d=document.getElementById("content_deviceLogs"),f=document.createElement("div");f.className="logItem";if(b){var h=document.createElement("span");h.classList.add("log-adapter");"bluetooth"===b.toLowerCase()?(h.textContent="Bluetooth",h.classList.add("log-bluetooth")):"HID"===b.toUpperCase()?(h.textContent="HID",h.classList.add("log-hid")):"eddystone"===b.toLowerCase()?(h.textContent="Eddystone",h.classList.add("log-eddystone")):h.textContent=b;
f.appendChild(h)}c&&(b=document.createElement("span"),b.classList.add("log-device"),b.textContent=c,f.appendChild(b));c=new Date;c="["+(("0"+c.getHours()).slice(-2)+":"+("0"+c.getMinutes()).slice(-2)+":"+("0"+c.getSeconds()).slice(-2))+"] ";b=document.createElement("span");b.classList.add("log-timestamp");b.textContent=c;f.appendChild(b);c=document.createElement("span");c.classList.add("log-message");c.innerHTML=a;f.appendChild(c);d.appendChild(f);d.scrollTop=d.scrollHeight};Blast.Ui.addToLog=module$contents$Blast$Ui_addToLog;
var module$contents$Blast$Ui_ClearOutputContainer=function(){for(var a=module$contents$Blast$Ui_messageOutputContainer;"clearOutputButton"!==a.lastChild.id;)console.log(a.lastChild.id),a.removeChild(a.lastChild)},module$contents$Blast$Ui_ClearLog=function(){for(var a=document.getElementById("content_deviceLogs");"clearDeviceLogsButton"!==a.lastChild.id;)a.removeChild(a.lastChild)},module$contents$Blast$Ui_importPrettify=function(){var a=document.createElement("script");a.setAttribute("src","https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js");
document.head.appendChild(a)},module$contents$Blast$Ui_init=function(a){module$contents$Blast$Ui_workspace=a;module$contents$Blast$Ui_runButton=document.getElementById("runButton");module$contents$Blast$Ui_messageOutputContainer=document.getElementById("msgOutputContainer");module$contents$Blast$Ui_statusContainer=document.getElementById("statusContainer");if(!window.location.href.includes("mobile")){module$contents$Blast$Ui_tabClick_(module$contents$Blast$Ui_selected_);a=$jscomp.makeIterator(module$contents$Blast$Ui_TABS_);
for(var b=a.next();!b.done;b=a.next())b=b.value,module$contents$Blast$Ui_bindClick("tab_"+b,function(c){return function(){module$contents$Blast$Ui_tabClick_(c)}}(b));a=function(){for(var c=$jscomp.makeIterator(module$contents$Blast$Ui_TABS_),d=c.next();!d.done;d=c.next())d=document.getElementById("content_"+d.value),d.style.top="35px",d.style.left="0px",d.style.height=window.innerHeight-35+"px",d.style.width=window.innerWidth-450+"px";module$contents$Blast$Ui_workspace&&module$contents$Blast$Ui_workspace.getToolbox().width&&
(document.getElementById("tab_workspace").style.minWidth=module$contents$Blast$Ui_workspace.getToolbox().width-38+"px");Blockly.svgResize(module$contents$Blast$Ui_workspace)};window.addEventListener("resize",a,!1);a();Blockly.svgResize(module$contents$Blast$Ui_workspace);module$contents$Blast$Ui_workspace.addChangeListener(function(c){c instanceof Blockly.Events.Ui||module$contents$Blast$Ui_renderContent_()});module$contents$Blast$Ui_bindClick("saveButton",function(){link(!0)});module$contents$Blast$Ui_bindClick("clearDeviceLogsButton",
module$contents$Blast$Ui_ClearLog);module$contents$Blast$Ui_bindClick("clearOutputButton",module$contents$Blast$Ui_ClearOutputContainer);window.setTimeout(module$contents$Blast$Ui_importPrettify,1);module$contents$Blast$Ui_setStatus(module$contents$Blast$Interpreter_statusValues.READY)}};Blast.Ui.initUi=module$contents$Blast$Ui_init;Blast.Things={};var module$contents$Blast$Things_webBluetoothDevices=new Map,module$contents$Blast$Things_webHidNames=new Map,module$contents$Blast$Things_webHidDevices=new Map;Blast.Things.webHidDevices=module$contents$Blast$Things_webHidDevices;var module$contents$Blast$Things_resetThings=function(){module$contents$Blast$Things_webBluetoothDevices.clear();module$contents$Blast$Things_webHidNames.clear();module$contents$Blast$Things_webHidDevices.clear()};module$contents$Blast$Interpreter_cleanUpFunctions.push(module$contents$Blast$Things_resetThings);
var module$contents$Blast$Things_flyoutCategory=function(a){var b=[],c=document.createElement("label");c.setAttribute("text","WebBluetooth Blocks");b.push(c);c=document.createElement("button");c.setAttribute("text","pair via webBluetooth");c.setAttribute("callbackKey","CREATE_WEBBLUETOOTH");a.registerButtonCallback("CREATE_WEBBLUETOOTH",function(h){module$contents$Blast$Things_createWebBluetoothButtonHandler()});b.push(c);c=module$contents$Blast$Things_flyoutCategoryBlocksWB(a);b=b.concat(c);c=document.createElement("label");
c.setAttribute("text","WebHID Blocks");b.push(c);c=document.createElement("button");c.setAttribute("text","connect via webHID");c.setAttribute("callbackKey","CREATE_WEBHID");a.registerButtonCallback("CREATE_WEBHID",function(h){createWebHidButtonHandler()});b.push(c);a=module$contents$Blast$Things_flyoutCategoryBlocksWHid(a);b=b.concat(a);a=document.createElement("label");a.setAttribute("text","additional identifiers");b.push(a);a=Blockly.utils.xml.createElement("block");a.setAttribute("type","uri");
b.push(a);a=Blockly.utils.xml.createElement("block");a.setAttribute("type","uri_from_string");b.push(a);a=document.createElement("label");a.setAttribute("text","example audio URIs");b.push(a);a=$jscomp.makeIterator(["https://studio.code.org/blockly/media/skins/dance/win.mp3","https://studio.code.org/blockly/media/click.mp3","https://upload.wikimedia.org/wikipedia/commons/2/25/243020_plasterbrain_game-start.ogg","https://upload.wikimedia.org/wikipedia/commons/d/d9/Wilhelm_Scream.ogg"]);for(c=a.next();!c.done;c=
a.next()){c=c.value;var d=Blockly.utils.xml.createElement("block");d.setAttribute("type","uri");var f=Blockly.utils.xml.createElement("field");f.setAttribute("name","URI");f.textContent=c;d.appendChild(f);b.push(d)}return b};Blast.Things.flyoutCategory=module$contents$Blast$Things_flyoutCategory;
var module$contents$Blast$Things_flyoutCategoryBlocksWHid=function(){var a=[];if(0<module$contents$Blast$Things_webHidDevices.size&&Blockly.Blocks.things_webHID){var b=Blockly.utils.xml.createElement("block");b.setAttribute("type","things_webHID");b.setAttribute("gap",8);a.push(b)}return a},module$contents$Blast$Things_flyoutCategoryBlocksWB=function(){var a=[];if(0<module$contents$Blast$Things_webBluetoothDevices.size&&Blockly.Blocks.things_webBluetooth){var b=Blockly.utils.xml.createElement("block");
b.setAttribute("type","things_webBluetooth");b.setAttribute("gap",8);a.push(b)}return a},module$contents$Blast$Things_getWebBluetoothDevices=function(){var a=[].concat($jscomp.arrayFromIterable(module$contents$Blast$Things_webBluetoothDevices.keys())).sort();if(0===a.legnth)return[];var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=module$contents$Blast$Things_webBluetoothDevices.get(c);b.push([c,d])}return b};Blast.Things.getWebBluetoothDevices=module$contents$Blast$Things_getWebBluetoothDevices;
var module$contents$Blast$Things_getWebHIDDevices=function(){var a=[].concat($jscomp.arrayFromIterable(module$contents$Blast$Things_webHidNames.keys())).sort();if(0===a.legnth)return[];var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=module$contents$Blast$Things_webHidNames.get(c);b.push([c,d])}return b};Blast.Things.getWebHIDDevices=module$contents$Blast$Things_getWebHIDDevices;
var module$contents$Blast$Things_createWebBluetoothButtonHandler=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){return a.yield(Blast.Bluetooth.requestDevice(),0)})},module$contents$Blast$Things_addWebBluetoothDevice=function(a,b){var c=function(d,f){Blockly.Variables.promptName("Pair successful! Now give your device a name.",d,function(h){if(h)if(module$contents$Blast$Things_webBluetoothDevices.has(h)){var g="Name %1 already exists".replace("%1",h);Blockly.alert(g,function(){c(h,
f)})}else module$contents$Blast$Things_webBluetoothDevices.set(h,f);else Blockly.alert("Name cannot be empty",function(){c(h,f)})})};c(b,a)};Blast.Things.addWebBluetoothDevice=module$contents$Blast$Things_addWebBluetoothDevice;
createWebHidButtonHandler=function(){var a=module$contents$Blast$Interpreter_getWorkspace();module$contents$Blast$Ui_addToLog("Requesting webHID device...","HID");navigator.hid.requestDevice({filters:[]}).then(function(b){if(0===b.length)module$contents$Blast$Interpreter_throwError("Connection failed or cancelled by User.");else{var c=Date.now().toString(36)+Math.random().toString(36).substring(2);module$contents$Blast$Things_addWebHidDevice(c,b[0].productName,b[0]);a.refreshToolboxSelection();module$contents$Blast$Ui_addToLog("Connected",
"HID",b[0].productName)}}).catch(function(b){module$contents$Blast$Interpreter_throwError(b)})};
var module$contents$Blast$Things_addWebHidDevice=function(a,b,c){var d=function(f,h){Blockly.Variables.promptName("Connection established! Now give your device a name.",f,function(g){if(g)if(module$contents$Blast$Things_webHidNames.has(g)){var l="Name %1 already exists".replace("%1",g);Blockly.alert(l,function(){d(g,h)})}else module$contents$Blast$Things_webHidDevices.set(h,c),module$contents$Blast$Things_webHidNames.set(g,h);else Blockly.alert("Name cannot be empty",function(){d(g,h)})})};d(b,a)};
Blast.Things.addWebHidDevice=module$contents$Blast$Things_addWebHidDevice;Blast.Storage={};
var module$contents$Blast$Storage_HTTPREQUEST_ERROR="There was a problem with the request.\n",module$contents$Blast$Storage_LINK_ALERT="Load your blocks with this link:\n\n%1",module$contents$Blast$Storage_NOT_FOUND_ERROR='Sorry, couldn\'t find "%1".',module$contents$Blast$Storage_XML_ERROR="Could not load your saved file.\nPerhaps it was created with a different version of Blast?",module$contents$Blast$Storage_filename="BLAST.xml",module$contents$Blast$Storage_link=function(a){var b=Blockly.Xml.workspaceToDom(workspace,
!0);if(1==workspace.getTopBlocks(!1).length&&b.querySelector){var c=b.querySelector("block");c&&(c.removeAttribute("x"),c.removeAttribute("y"))}b=module$contents$Blast$Storage_removeDeviceId_(b);b=Blockly.Xml.domToPrettyText(b);!0===a?(b=new Blob([b],{type:"text/xml"}),saveAs(b,module$contents$Blast$Storage_filename)):((a=document.getElementById("loadWorkspace-input").value)&&0!=a.length||(a="storage/"+module$contents$Blast$Storage_generatePath()),b=Blockly.Xml.domToText(b),module$contents$Blast$Storage_saveXML_(a,
b))};Blast.Storage.link=module$contents$Blast$Storage_link;
var module$contents$Blast$Storage_removeDeviceId_=function(a){var b=a.querySelectorAll("block");b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next()){c=c.value;var d=c.getAttribute("type");if("things_webBluetooth"==d||"things_webHID"==d)if(c=c.firstElementChild){var f=c.textContent,h="things_webBluetooth"==d?module$contents$Blast$Things_getWebBluetoothDevices():module$contents$Blast$Things_getWebHIDDevices();d=void 0;h=$jscomp.makeIterator(h);for(var g=h.next();!g.done;g=h.next()){g=$jscomp.makeIterator(g.value);
var l=g.next().value;if(g.next().value===f){d=l;break}}c.textContent=d}}return a},module$contents$Blast$Storage_saveXML_=function(a,b){Blockly.hideChaff();fetch(a,{method:"PUT",body:b}).then(function(c){c.ok?(location.hash=a,Blockly.alert(module$contents$Blast$Storage_LINK_ALERT.replace("%1",window.location.href))):module$contents$Blast$Interpreter_throwError(module$contents$Blast$Storage_HTTPREQUEST_ERROR)})},module$contents$Blast$Storage_load=function(){var a=document.getElementById("loadWorkspace-input").value;
if(""==a)Blockly.alert("Enter a URI first.");else{var b=a.split("/").pop();-1<b.indexOf(".")&&(module$contents$Blast$Storage_filename=b);module$contents$Blast$Storage_retrieveXML_(a)}};Blast.Storage.load=module$contents$Blast$Storage_load;
var module$contents$Blast$Storage_loadXMLFromFile=function(a){return new Promise(function(b,c){var d=a.target.files[0].name;-1<d.indexOf(".")&&(module$contents$Blast$Storage_filename=d);d=new FileReader;d.onload=function(f){module$contents$Blast$Storage_loadXML(f.target.result);b()};d.onerror=function(f){c(f.target.error)};d.readAsText(a.target.files[0])})};Blast.Storage.loadXMLFromFile=module$contents$Blast$Storage_loadXMLFromFile;
var module$contents$Blast$Storage_resetFileInput=function(){var a=document.getElementById("file-selector");a&&(a.value="");module$contents$Blast$Storage_filename="BLAST.xml"},module$contents$Blast$Storage_retrieveXML_=function(a){return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){Blockly.hideChaff();module$contents$Blast$Interpreter_resetInterpreter();module$contents$Blast$Storage_resetFileInput();fetch(a).then(function(c){if(c.ok)return c.text();module$contents$Blast$Interpreter_throwError(module$contents$Blast$Storage_NOT_FOUND_ERROR.replace("%1",
a))}).then(module$contents$Blast$Storage_loadXML);b.jumpToEnd()})},module$contents$Blast$Storage_loadXML=function(a){var b=module$contents$Blast$Interpreter_getWorkspace();b.clear();try{var c=Blockly.Xml.textToDom(a)}catch(d){module$contents$Blast$Interpreter_throwError(module$contents$Blast$Storage_XML_ERROR+"\nXML: "+c);return}c.querySelector('block[type="things_webBluetooth"]')||c.querySelector('block[type="things_webHID"]')?(module$contents$Blast$Storage_generatePairButtons(c),document.getElementById("rcModal")&&
(document.getElementById("rcModal").style.display="block")):(Blockly.Xml.domToWorkspace(c,b),module$contents$Blast$Storage_monitorChanges_(b))},module$contents$Blast$Storage_generatePairButtons=function(a){window.location.href.includes("mobile")?(window.app.openReconnectDialog(),module$contents$Blast$Storage_generatePairButtonsMobile_(a)):module$contents$Blast$Storage_generatePairButtonsDesktop_(a)},module$contents$Blast$Storage_generatePairButtonsDesktop_=function(a){for(var b=a.querySelectorAll("block"),
c=document.getElementById("rc-tbody");c.firstChild;)c.removeChild(c.firstChild);var d=[],f={};b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;f={$jscomp$loop$prop$type$75:f.$jscomp$loop$prop$type$75,$jscomp$loop$prop$name$76:f.$jscomp$loop$prop$name$76,$jscomp$loop$prop$block$77:f.$jscomp$loop$prop$block$77},h=b.next()){f.$jscomp$loop$prop$block$77=h.value;f.$jscomp$loop$prop$type$75=f.$jscomp$loop$prop$block$77.getAttribute("type");if("things_webBluetooth"==f.$jscomp$loop$prop$type$75||"things_webHID"==
f.$jscomp$loop$prop$type$75){f.$jscomp$loop$prop$name$76=f.$jscomp$loop$prop$block$77.firstElementChild.textContent;if(d.includes(f.$jscomp$loop$prop$name$76))continue;h=document.createElement("tr");var g=document.createElement("td");g.appendChild(document.createTextNode(f.$jscomp$loop$prop$name$76));var l=document.createElement("td"),k=document.createElement("input");k.setAttribute("type","button");k.setAttribute("id","pairButton-"+f.$jscomp$loop$prop$name$76);k.setAttribute("value","Pair");var m=
document.createElement("td"),n=document.createElement("span");n.setAttribute("id","pairStatus-"+f.$jscomp$loop$prop$name$76);n.innerHTML="&#x2718;";n.style.color="red";n.style.fontSize="20px";n.style.fontWeight="bold";n.style.marginRight="10px";m.appendChild(n);k.addEventListener("click",function(p){return function(){var q,r;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){if(1==t.nextAddress)return"things_webBluetooth"!=p.$jscomp$loop$prop$type$75?("things_webHID"==p.$jscomp$loop$prop$type$75&&
(q=[],navigator.hid.requestDevice({filters:q}).then(function(v){0===v.length&&module$contents$Blast$Interpreter_throwError("Connection failed or cancelled by User.");var w=Date.now().toString(36)+Math.random().toString(36).substr(2);module$contents$Blast$Things_addWebHidDevice(w,p.$jscomp$loop$prop$name$76,v[0]);document.getElementById("pairStatus-"+p.$jscomp$loop$prop$name$76).innerHTML="&#x2714;";document.getElementById("pairStatus-"+p.$jscomp$loop$prop$name$76).style.color="green";p.$jscomp$loop$prop$block$77.firstElementChild.textContent=
w;module$contents$Blast$Storage_allConnectedDesktop_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").addEventListener("click",function(){return module$contents$Blast$Storage_reconnectDoneHandler_(a)}))}).catch(function(v){module$contents$Blast$Interpreter_throwError("Connection failed or cancelled by User.");console.error(v)})),t.jumpTo(0)):t.yield(Blast.Bluetooth.requestDevice(),3);r=t.yieldResult;document.getElementById("pairStatus-"+p.$jscomp$loop$prop$name$76).innerHTML=
"&#x2714;";document.getElementById("pairStatus-"+p.$jscomp$loop$prop$name$76).style.color="green";p.$jscomp$loop$prop$block$77.firstElementChild.textContent=r.id;module$contents$Blast$Storage_allConnectedDesktop_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").addEventListener("click",function(){return module$contents$Blast$Storage_reconnectDoneHandler_(a)}));t.jumpToEnd()})}}(f));l.appendChild(k);h.appendChild(g);h.appendChild(l);h.appendChild(m);c.appendChild(h);
d.push(f.$jscomp$loop$prop$name$76)}document.getElementById("rc-cancel").addEventListener("click",function(){return module$contents$Blast$Storage_reconnectCancelHandler_()})}},module$contents$Blast$Storage_generatePairButtonsMobile_=function(a){for(var b=a.querySelectorAll("block"),c=document.getElementById("rc-list");c.firstChild;)c.removeChild(c.firstChild);var d=[],f={};b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;f={$jscomp$loop$prop$type$79:f.$jscomp$loop$prop$type$79,$jscomp$loop$prop$name$80:f.$jscomp$loop$prop$name$80,
$jscomp$loop$prop$block$81:f.$jscomp$loop$prop$block$81},h=b.next())if(f.$jscomp$loop$prop$block$81=h.value,f.$jscomp$loop$prop$type$79=f.$jscomp$loop$prop$block$81.getAttribute("type"),"things_webBluetooth"==f.$jscomp$loop$prop$type$79||"things_webHID"==f.$jscomp$loop$prop$type$79)if(f.$jscomp$loop$prop$name$80=f.$jscomp$loop$prop$block$81.firstElementChild.textContent,!d.includes(f.$jscomp$loop$prop$name$80)){h=document.createElement("li");h.setAttribute("id","rc-item-"+f.$jscomp$loop$prop$name$80);
h.setAttribute("class","mdc-list-item");var g=document.createElement("span");g.setAttribute("id","rc-icon-"+f.$jscomp$loop$prop$name$80);g.setAttribute("class","mdc-list-item__graphic material-icons");g.setAttribute("aria-hidden","true");g.innerHTML="things_webBluetooth"==f.$jscomp$loop$prop$type$79?"bluetooth_disabled":"usb_off";h.appendChild(g);g=document.createElement("span");g.setAttribute("class","mdc-list-item__text");var l=document.createElement("span");l.setAttribute("class","mdc-list-item__primary-text");
l.innerHTML=f.$jscomp$loop$prop$name$80;g.appendChild(l);l=document.createElement("span");l.setAttribute("class","mdc-list-item__secondary-text");l.setAttribute("id","rc-status-"+f.$jscomp$loop$prop$name$80);l.innerHTML="disconnected";g.appendChild(l);h.appendChild(g);h.addEventListener("click",function(k){return function(){var m,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){if(1==p.nextAddress)return"things_webBluetooth"!=k.$jscomp$loop$prop$type$79?("things_webHID"==k.$jscomp$loop$prop$type$79&&
(m=[],navigator.hid.requestDevice({filters:m}).then(function(q){0===q.length&&module$contents$Blast$Interpreter_throwError("Connection failed or cancelled by User.");var r=Date.now().toString(36)+Math.random().toString(36).substr(2);module$contents$Blast$Things_addWebHidDevice(r,k.$jscomp$loop$prop$name$80,q[0]);document.getElementById("rc-status-"+k.$jscomp$loop$prop$name$80).innerHTML="connected";document.getElementById("rc-icon-"+k.$jscomp$loop$prop$name$80).innerHTML="usb";document.getElementById("rc-icon-"+
k.$jscomp$loop$prop$name$80).style.color="#0d30b1";k.$jscomp$loop$prop$block$81.firstElementChild.textContent=r;module$contents$Blast$Storage_allConnectedMobile_()&&(document.getElementById("rc-done").disabled=!1,document.getElementById("rc-done").addEventListener("click",function(){return module$contents$Blast$Storage_reconnectDoneHandler_(a)}))}).catch(function(q){module$contents$Blast$Interpreter_throwError("Connection failed or cancelled by User.");console.error(q)})),p.jumpTo(0)):p.yield(Blast.Bluetooth.requestDevice(),
3);n=p.yieldResult;module$contents$Blast$Things_addWebBluetoothDevice(n.id,k.$jscomp$loop$prop$name$80);document.getElementById("rc-status-"+k.$jscomp$loop$prop$name$80).innerHTML="connected";document.getElementById("rc-icon-"+k.$jscomp$loop$prop$name$80).innerHTML="bluetooth";document.getElementById("rc-icon-"+k.$jscomp$loop$prop$name$80).style.color="#0d30b1";k.$jscomp$loop$prop$block$81.firstElementChild.textContent=n.id;module$contents$Blast$Storage_allConnectedMobile_()&&(document.getElementById("rc-done").disabled=
!1,document.getElementById("rc-done").addEventListener("click",function(){return module$contents$Blast$Storage_reconnectDoneHandler_(a)}));p.jumpToEnd()})}}(f));c.appendChild(h);d.push(f.$jscomp$loop$prop$name$80)}window.app.initLists()},module$contents$Blast$Storage_allConnectedDesktop_=function(){var a=document.getElementById("rc-tbody").querySelectorAll("tr");a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if("\u2718"==document.getElementById("pairStatus-"+b.value.firstElementChild.textContent).innerHTML)return!1;
return!0},module$contents$Blast$Storage_allConnectedMobile_=function(){var a=document.getElementById("rc-list").querySelectorAll("[id=rc-status-]");a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if("disconnected"==document.getElementById("rc-status-"+b.value.textContent).innerHTML)return!1;return!0},module$contents$Blast$Storage_reconnectDoneHandler_=function(a){var b=module$contents$Blast$Interpreter_getWorkspace();window.location.href.includes("mobile")?document.getElementById("rc-dialog").style.display=
"none":document.getElementById("rcModal").style.display="none";var c=document.getElementById("rc-done"),d=c.cloneNode(!0);d.disabled=!0;c.parentNode.replaceChild(d,c);Blockly.Xml.domToWorkspace(a,b);module$contents$Blast$Storage_monitorChanges_(b)},module$contents$Blast$Storage_reconnectCancelHandler_=function(){document.getElementById("rcModal").style.display="none"},module$contents$Blast$Storage_monitorChanges_=function(a){function b(){var f=Blockly.Xml.workspaceToDom(a);f=Blockly.Xml.domToText(f);
d!=f&&(window.location.hash="",a.removeChangeListener(b))}var c=Blockly.Xml.workspaceToDom(a),d=Blockly.Xml.domToText(c);a.addChangeListener(b)},module$contents$Blast$Storage_generatePath=function(){for(var a=[],b=0;12>b;b++)a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())));return a.join("")};
window.addEventListener("load",function(){var a=window.location.hash;if(a){a=a.substring(1);try{module$contents$Blast$Storage_retrieveXML_(a)}catch(b){module$contents$Blast$Interpreter_throwError("Could not load file."),console.error(b)}}});var module$contents$Blast_init=function(){if(!window.location.href.includes("mobile")){module$contents$Blast$Interpreter_initInterpreter();var a=module$contents$Blast$Interpreter_getWorkspace();module$contents$Blast$States$Interpreter_init(a);module$contents$Blast$Ui_init(a);module$contents$Blast$Ui_bindClick("UriLoadButton",module$contents$Blast$Storage_load);module$contents$Blast$Ui_bindClick("UriSaveButton",module$contents$Blast$Storage_link);document.getElementById("loadWorkspace-input").addEventListener("keyup",
function(b){13===b.keyCode&&module$contents$Blast$Storage_load()});a.registerToolboxCategoryCallback("THINGS",module$contents$Blast$Things_flyoutCategory);a.registerToolboxCategoryCallback("STATES",module$contents$Blast$States_flyoutCategory);module$contents$Blast$Interpreter_getStdInfo()("Actionblock output will be displayed here")}},module$contents$Blast_highlightBlock=function(a){module$contents$Blast$Interpreter_getWorkspace().highlightBlock(a)};
module$contents$Blast$Interpreter_apiFunctions.push(["highlightBlock",module$contents$Blast_highlightBlock]);window.addEventListener("load",module$contents$Blast_init);Blast.Bluetooth={};Blast.Bluetooth.optionalServices=[];Blast.Bluetooth.scanBlocks=[];Blast.Bluetooth.LEScanResults={};Blast.Bluetooth.isLEScanRunning=!1;Blast.Bluetooth.eventListeners=[];Blast.Bluetooth.charEventListeners={};function hexStringToArrayBuffer(a){a=a.replace(/^0x/,"");0!=a.length%2&&(a="0"+a);var b=a.match(/[G-Z\s]/i);b&&console.log("WARNING: found non-hex characters",b);a=a.match(/[\dA-F]{2}/gi).map(function(c){return parseInt(c,16)});return(new Uint8Array(a)).buffer}
Blast.Bluetooth.requestDevice=function(a,b){var c,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress){module$contents$Blast$Ui_addToLog("Requesting device...","Bluetooth");if(!navigator.bluetooth)return h.jumpTo(0);a||(a={acceptAllDevices:!0},a.optionalServices=Blast.Bluetooth.optionalServices);h.setCatchFinallyBlocks(3);return h.yield(navigator.bluetooth.requestDevice(a),5)}if(3!=h.nextAddress)return c=h.yieldResult,module$contents$Blast$Ui_addToLog("Device paired",
"Bluetooth",c.id),d=b||c.name,module$contents$Blast$Things_addWebBluetoothDevice(c.id,d),module$contents$Blast$Interpreter_getWorkspace().refreshToolboxSelection(),h.return(c);f=h.enterCatchBlock();module$contents$Blast$Interpreter_throwError(f);h.jumpToEnd()})};
Blast.Bluetooth.getDeviceById=function(a){var b,c,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(navigator.bluetooth.getDevices(),2);b=h.yieldResult;c=$jscomp.makeIterator(b);for(d=c.next();!d.done;d=c.next())if(f=d.value,f.id==a)return h.return(f);module$contents$Blast$Interpreter_throwError("Bluetooth device "+a+" wasn't found in paired devices.");h.jumpToEnd()})};
Blast.Bluetooth.connect=function(a){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.setCatchFinallyBlocks(2),f.yield(Blast.Bluetooth.getDeviceById(a),4);case 4:return b=f.yieldResult,module$contents$Blast$Ui_addToLog("Connecting to <code>"+a+"</code>","Bluetooth"),f.yield(b.gatt.connect(),5);case 5:return c=f.yieldResult,module$contents$Blast$Ui_addToLog("Connected","Bluetooth",a),f.return(c);case 2:d=f.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Error connecting to Bluetooth device "+
a),console.error(d),f.jumpToEnd()}})};
Blast.Bluetooth.disconnect=function(a){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.setCatchFinallyBlocks(2),f.yield(Blast.Bluetooth.getDeviceById(a),4);case 4:return b=f.yieldResult,module$contents$Blast$Ui_addToLog("Disconnecting...","Bluetooth",a),f.yield(b.gatt.disconnect(),5);case 5:return c=f.yieldResult,module$contents$Blast$Ui_addToLog("Disconnected from <code>"+a+"</code>","Bluetooth"),f.return(c);case 2:d=f.enterCatchBlock(),
module$contents$Blast$Interpreter_throwError("Error disconnecting from Bluetooth device "+a),console.error(d),f.jumpToEnd()}})};
Blast.Bluetooth.gatt_writeWithoutResponse=function(a,b,c,d){var f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:f=g.yieldResult;if(!f)return g.return();"string"===typeof d&&(d=hexStringToArrayBuffer(d));g.setCatchFinallyBlocks(3);module$contents$Blast$Ui_addToLog("Invoke <code>WriteValueWithoutResponse</code> on characteristic <code>"+(c+"</code> with value <code>"+d.toString()+"</code>"),
"Bluetooth",a);return g.yield(f.writeValueWithoutResponse(d),5);case 5:module$contents$Blast$Ui_addToLog("Finished <code>WriteValueWithoutResponse</code> on characteristic <code>"+(c+"</code> with value <code>"+d.toString()+"</code>"),"Bluetooth",a);g.leaveTryBlock(0);break;case 3:h=g.enterCatchBlock(),console.error(h),module$contents$Blast$Interpreter_throwError("Error writing to Bluetooth device.\nMake sure the device is compatible with the connected block."),g.jumpToEnd()}})};
Blast.Bluetooth.gatt_writeWithResponse=function(a,b,c,d){var f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:f=g.yieldResult;if(!f)return g.return();"string"===typeof d&&(d=hexStringToArrayBuffer(d));g.setCatchFinallyBlocks(3);module$contents$Blast$Ui_addToLog("Invoke <code>WriteValueWithResponse</code> on characteristic <code>"+(c+"</code> with value <code>"+d.toString()+"</code>"),"Bluetooth",
a);return g.yield(f.writeValueWithResponse(d),5);case 5:module$contents$Blast$Ui_addToLog("Finished <code>WriteValueWithResponse</code> on characteristic <code>"+(c+"</code> with value <code>"+d.toString()+"</code>"),"Bluetooth",a);g.leaveTryBlock(0);break;case 3:h=g.enterCatchBlock(),console.error(h),module$contents$Blast$Interpreter_throwError("Error writing to Bluetooth device.\nMake sure the device is compatible with the connected block."),g.jumpToEnd()}})};
Blast.Bluetooth.getPrimaryService=function(a,b){var c,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:return h.yield(Blast.Bluetooth.connect(a),2);case 2:return c=h.yieldResult,h.setCatchFinallyBlocks(3),module$contents$Blast$Ui_addToLog("Getting primary service <code>"+b+"</code>","Bluetooth",a),h.yield(c.getPrimaryService(b),5);case 5:d=h.yieldResult;module$contents$Blast$Ui_addToLog("Got primary service <code>"+b+"</code>","Bluetooth",a);h.leaveTryBlock(4);
break;case 3:f=h.enterCatchBlock(),console.error(f),module$contents$Blast$Interpreter_throwError("The device is not compatible with the connected block.");case 4:return h.return(d)}})};
Blast.Bluetooth.getCharacteristic=function(a,b,c){var d,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.getPrimaryService(a,b),2);case 2:d=g.yieldResult;if(!d)return g.return();g.setCatchFinallyBlocks(3);module$contents$Blast$Ui_addToLog("Getting characteristic <code>"+c+"</code> from service <code>"+b+"</code>","Bluetooth",a);return g.yield(d.getCharacteristic(c),5);case 5:f=g.yieldResult;module$contents$Blast$Ui_addToLog("Got characteristic <code>"+
c+"</code> from service <code>"+b+"</code>","Bluetooth",a);g.leaveTryBlock(4);break;case 3:h=g.enterCatchBlock(),console.error(h),module$contents$Blast$Interpreter_throwError("The device is not compatible with the connected block.");case 4:return g.return(f)}})};
Blast.Bluetooth.gatt_read=function(a,b,c){var d,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:return d=g.yieldResult,g.setCatchFinallyBlocks(3),module$contents$Blast$Ui_addToLog("Invoke <code>ReadValue</code> on characteristic <code>"+c+"</code> from service <code>"+(b+"</code>"),"Bluetooth",a),g.yield(d.readValue(),5);case 5:return f=g.yieldResult,module$contents$Blast$Ui_addToLog("Finished <code>ReadValue</code> on characteristic <code>"+
c+"</code> from service <code>"+(b+"</code> - value: <code>"+f.toString()+"</code>"),"Bluetooth",a),g.return(f);case 3:h=g.enterCatchBlock(),console.error(h),module$contents$Blast$Interpreter_throwError("Error reading from Bluetooth device "+a),g.jumpToEnd()}})};Blast.Bluetooth.gatt_read_text=function(a,b,c){var d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=h.yieldResult;f=(new TextDecoder).decode(d);return h.return(f)})};
Blast.Bluetooth.gatt_read_number=function(a,b,c){var d,f,h,g,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=k.yieldResult;d instanceof DataView||(d=new DataView(value));f=new Uint8Array(d.buffer);h=f.length;g=buffer.Buffer.from(f);l=g.readUIntBE(0,h);return k.return(l)})};
Blast.Bluetooth.gatt_read_hex=function(a,b,c){var d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(Blast.Bluetooth.gatt_read(a,b,c),2);d=h.yieldResult;f=(new Uint8Array(d.buffer)).reduce(function(g,l){return g+("0"+l.toString(16)).slice(-2)},"");return h.return(f)})};
Blast.Bluetooth.gatt_subscribe=function(a,b,c,d){var f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(Blast.Bluetooth.getCharacteristic(a,b,c),2);case 2:return f=g.yieldResult,module$contents$Blast$Ui_addToLog("Add 'characteristicvaluechanged' listener to characteristic "+c+(" of service <code>"+b+"</code>"),"Bluetooth",a),f.addEventListener("characteristicvaluechanged",d),Blast.Bluetooth.charEventListeners[c]=[f,"characteristicvaluechanged",
d],g.setCatchFinallyBlocks(3),module$contents$Blast$Ui_addToLog("Invoke <code>startNotifications</code> on characteristic "+c+(" from service <code>"+b+"</code>"),"Bluetooth",a),g.yield(f.startNotifications(),5);case 5:module$contents$Blast$Ui_addToLog("Finished <code>startNotifications</code> on characteristic "+c+(" from service <code>"+b+"</code>"),"Bluetooth",a);g.leaveTryBlock(0);break;case 3:h=g.enterCatchBlock(),console.error(h),module$contents$Blast$Interpreter_throwError("Error subscribing to Bluetooth device "+
a),g.jumpToEnd()}})};
Blast.Bluetooth.startLEScan=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){if(Blast.Bluetooth.isLEScanRunning)return a.return();Blast.Bluetooth.cacheLEScanResults();Blast.Bluetooth.isLEScanRunning=!0;module$contents$Blast$Ui_addToLog("Requesting LE Scan","Bluetooth");Blockly.alert("Please click allow on the LE Scan prompt now, then close this dialog.",navigator.bluetooth.requestLEScan({acceptAllAdvertisements:!0,keepRepeatedDevices:!0}));setTimeout(Blast.Bluetooth.stopLEScan,3E4);
a.jumpToEnd()})};Blast.Bluetooth.stopLEScan=function(){Blast.Bluetooth.isLEScanRunning&&(module$contents$Blast$Ui_addToLog("Stopping LE Scan","Bluetooth"),navigator.bluetooth.stopLEScan(),Blast.Bluetooth.isLEScanRunning=!1)};Blast.Bluetooth.cacheLEScanResults=function(){Blast.Bluetooth.addEventListener("advertisementreceived",function(a){var b=a.device.id;Blast.Bluetooth.LEScanResults[b]||(Blast.Bluetooth.LEScanResults[b]=[]);Blast.Bluetooth.LEScanResults[b].unshift(a)})};
Blast.Bluetooth.addEventListener=function(a,b){Blast.Bluetooth.eventListeners.push([a,b]);navigator.bluetooth.addEventListener(a,b)};Blast.Bluetooth.removeEventListener=function(a,b){var c=Blast.Bluetooth.eventListeners.findIndex(function(d){return d[0]===a&&d[1]===b});-1!==c&&Blast.Bluetooth.eventListeners.splice(c,1);navigator.bluetooth.removeEventListener(a,b)};
Blast.Bluetooth.tearDown=function(){Blast.Bluetooth.isLEScanRunning&&(Blast.Bluetooth.isLEScanRunning=!1);if(Blast.Bluetooth.eventListeners){for(var a=$jscomp.makeIterator(Blast.Bluetooth.eventListeners),b=a.next();!b.done;b=a.next())b=b.value,Blast.Bluetooth.removeEventListener(b[0],b[1]);Blast.Bluetooth.eventListeners=[]}if(Blast.Bluetooth.charEventListeners){a=$jscomp.makeIterator(Object.keys(Blast.Bluetooth.charEventListeners));for(b=a.next();!b.done;b=a.next()){var c=Blast.Bluetooth.charEventListeners[b.value];
b=c[0];var d=c[1];c=c[2];b.stopNotifications();b.removeEventListener(d,c)}Blast.Bluetooth.charEventListeners={}}Blast.Bluetooth.LEScanResults={}};Blast.Bluetooth.Eddystone={};
Blast.Bluetooth.Eddystone.UUIDS={CONFIG_SERVICE:"a3c87500-8ed3-4bdf-8a39-a01bebede295",CAPABILITIES_CHARACTERISTIC:"a3c87501-8ed3-4bdf-8a39-a01bebede295",ACTIVE_SLOT_CHARACTERISTIC:"a3c87502-8ed3-4bdf-8a39-a01bebede295",ADVERTISING_INTERVAL_CHARACTERISTIC:"a3c87503-8ed3-4bdf-8a39-a01bebede295",RADIO_TX_POWER_CHARACTERISTIC:"a3c87504-8ed3-4bdf-8a39-a01bebede295",ADVERTISED_TX_POWER_CHARACTERISTIC:"a3c87505-8ed3-4bdf-8a39-a01bebede295",LOCK_STATE_CHARACTERISTIC:"a3c87506-8ed3-4bdf-8a39-a01bebede295",UNLOCK_STATE_CHARACTERISTIC:"a3c87507-8ed3-4bdf-8a39-a01bebede295",
PUBLIC_ECDH_KEY_CHARACTERISTIC:"a3c87508-8ed3-4bdf-8a39-a01bebede295",EID_IDENTITY_KEY_CHARACTERISTIC:"a3c87509-8ed3-4bdf-8a39-a01bebede295",ADV_SLOT_DATA_CHARACTERISTIC:"a3c8750a-8ed3-4bdf-8a39-a01bebede295",FACTORY_RESET_CHARACTERISTIC:"a3c8750b-8ed3-4bdf-8a39-a01bebede295",REMAIN_CONNECTABLE_CHARACTERISTIC:"a3c8750c-8ed3-4bdf-8a39-a01bebede295"};Blast.Bluetooth.optionalServices.push(Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE);
Blast.Bluetooth.Eddystone.getCapabilities=function(a){var b,c,d,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone capabilities...","Eddystone",a),g.yield(Blast.Bluetooth.gatt_read(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.CAPABILITIES_CHARACTERISTIC),2);b=g.yieldResult;b=new Int8Array(b.buffer);c=[];for(d=6;d<b.length&&!((f=c[c.length-1])&&f>=b[d]);d++)c.push(b[d]);
h={specVersion:b[0],maxSlots:b[1],maxEidPerSlot:b[2],isVarriableAdvIntervalSupported:0!==(b[3]&1),isVariableTxPowerSupported:0!==(b[3]&2),isUIDSupported:0!==(b[5]&1),isURLSupported:0!==(b[5]&2),isTLMSupported:0!==(b[5]&4),isEIDSupported:0!==(b[5]&8),supportedTxPowerLevels:c};module$contents$Blast$Ui_addToLog("Eddystone capabilities: <code>"+JSON.stringify(h)+"</code>","Eddystone",a);return g.return(h)})};
Blast.Bluetooth.Eddystone.getActiveSlot=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone active slot...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_number(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ACTIVE_SLOT_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone active slot: <code>"+b+"</code>","Eddystone",a);return c.return(b)})};
Blast.Bluetooth.Eddystone.setActiveSlot=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return module$contents$Blast$Ui_addToLog("Setting Eddystone active slot to <code>"+b+"</code>...","Eddystone",a),d.yield(Blast.Bluetooth.Eddystone.getCapabilities(a),2);if(3!=d.nextAddress)return c=d.yieldResult,(0>b||b>=c.maxSlots)&&module$contents$Blast$Interpreter_throwError("Eddystone slot is not valid.\n         On this device the slot must be between 0 and "+
(c.maxSlots-1)+"."),d.yield(Blast.Bluetooth.gatt_writeWithResponse(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ACTIVE_SLOT_CHARACTERISTIC,b.toString(16)),3);module$contents$Blast$Ui_addToLog("Eddystone active slot set to <code>"+b+"</code>","Eddystone",a);return d.return()})};
Blast.Bluetooth.Eddystone.getAdvertisingInterval=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone advertising interval...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_number(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADVERTISING_INTERVAL_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone advertising interval: <code>"+
b+"</code>","Eddystone",a);return c.return(b)})};
Blast.Bluetooth.Eddystone.setAdvertisingInterval=function(a,b){return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Setting Eddystone advertising interval to <code>"+b+"</code>...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_writeWithResponse(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADVERTISING_INTERVAL_CHARACTERISTIC,b.toString(16)),2);module$contents$Blast$Ui_addToLog("Eddystone advertising interval set to <code>"+b+
"</code>","Eddystone",a);return c.return()})};
Blast.Bluetooth.Eddystone.getTxPowerLevel=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone TX power level...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_number(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.RADIO_TX_POWER_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone TX power level: <code>"+b+"</code>","Eddystone",
a);return c.return(b)})};
Blast.Bluetooth.Eddystone.setTxPowerLevel=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return module$contents$Blast$Ui_addToLog("Setting Eddystone TX power level to <code>"+b+"</code>...","Eddystone",a),d.yield(Blast.Bluetooth.Eddystone.getCapabilities(a),2);if(3!=d.nextAddress)return c=d.yieldResult,-1===c.supportedTxPowerLevels.indexOf(b)?(module$contents$Blast$Interpreter_throwError("Eddystone TX power level is not valid.\n         On this device the TX power level must be one of "+c.supportedTxPowerLevels+
"."),d.return()):d.yield(Blast.Bluetooth.gatt_writeWithResponse(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.RADIO_TX_POWER_CHARACTERISTIC,b.toString(16)),3);module$contents$Blast$Ui_addToLog("Eddystone TX power level set to <code>"+b+"</code>","Eddystone",a);return d.return()})};
Blast.Bluetooth.Eddystone.getAdvertisedTxPower=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone advertised TX power...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_number(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADVERTISED_TX_POWER_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone advertised TX power: <code>"+
b+"</code>","Eddystone",a);return c.return(b)})};
Blast.Bluetooth.Eddystone.setAdvertisedTxPower=function(a,b){return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Setting Eddystone advertised TX power to <code>"+b+"</code>...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_writeWithResponse(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADVERTISED_TX_POWER_CHARACTERISTIC,b.toString(16)),2);module$contents$Blast$Ui_addToLog("Eddystone advertised TX power set to <code>"+b+
"</code>","Eddystone",a);return c.return()})};
Blast.Bluetooth.Eddystone.getLockState=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone lock state...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_number(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.LOCK_STATE_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone lock state: <code>"+b+"</code>","Eddystone",a);return c.return(b)})};
Blast.Bluetooth.Eddystone.getPublicECDHKey=function(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone public ECDH key...","Eddystone",a),c.yield(Blast.Bluetooth.gatt_read_hex(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.PUBLIC_ECDH_KEY_CHARACTERISTIC),2);b=c.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone public ECDH key: <code>"+b+"</code>","Eddystone",
a);return c.return(b)})};
Blast.Bluetooth.Eddystone.getAdvertisingData=function(a){var b,c,d,f,h,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return module$contents$Blast$Ui_addToLog("Reading Eddystone advertising data...","Eddystone",a),b=function(k){var m=parseInt(k.substring(2,4),16),n=k.substring(4,24);k=k.substring(25,37);return{frameType:"UID",txPower:m,namespace:n,instance:k}},c=function(k){var m=parseInt(k.substring(2,4),16);switch(k.substring(4,6)){case "00":var n="http://www.";
break;case "01":n="https://www.";break;case "02":n="http://";break;case "03":n="https://";break;default:module$contents$Blast$Interpreter_throwError("Eddystone URL scheme is not valid.");return}var p=".com/ .org/ .edu/ .net/ .info/ .biz/ .gov/ .com .org .edu .net .info .biz .gov".split(" ");k=k.substring(6,k.length);for(var q=0;q<k.length;q+=2){var r=parseInt(k.substring(q,q+2),16);n=r<p.length?n+p[r]:n+String.fromCharCode(r)}return{frameType:"URL",txPower:m,url:n}},d=function(k){var m=parseInt(k.substring(4,
8),16),n=parseInt(k.substring(8,10),16)+parseInt(k.substring(10,12),16)/100,p=parseInt(k.substring(12,20),16);k=parseInt(k.substring(20,28),16);return{frameType:"TLM",batteryVoltage:m,beaconTemperature:n,pduCount:p,timeSinceReboot:k}},l.yield(Blast.Bluetooth.gatt_read_hex(a,Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADV_SLOT_DATA_CHARACTERISTIC),2);f=l.yieldResult;module$contents$Blast$Ui_addToLog("Got Eddystone advertising data: <code>"+f+"</code>","Eddystone",
a);h=f.substring(0,2);switch(h){case "00":return g=b(f),l.return(g.namespace+g.instance);case "10":return g=c(f),l.return(g.url);case "20":return g=d(f),l.return(g.beaconTemperature);case "30":return module$contents$Blast$Interpreter_throwError("EID frame type is not supported by blast."),l.return();default:return module$contents$Blast$Interpreter_throwError("Eddystone frame type is not valid."),l.return()}})};
Blast.Bluetooth.Eddystone.setAdvertisingData=function(a,b,c){var d,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress){module$contents$Blast$Ui_addToLog("Set Eddystone advertising data...","Eddystone",a);d=function(l){for(var k=["http://www.","https://www.","http://","https://"],m=".com/ .org/ .edu/ .net/ .info/ .biz/ .gov/ .com .org .edu .net .info .biz .gov".split(" "),n=[],p=0,q=new TextEncoder("utf-8"),r=0;r<k.length;r++)if(l.startsWith(k[r])){n.push(r);p=k[r].length;
break}for(;p<l.length;){k=p;for(r=0;r<m.length;r++)if(l.startsWith(m[r],p)){n.push(r);p+=m[r].length;break}k===p&&(n.push(q.encode(l[p])[0]),p++)}if(18<n.length)module$contents$Blast$Interpreter_throwError("URL is too long.");else return n.splice(0,0,16),new Uint8Array(n)};if("URL"===b)f=d(c);else if("UID"===b){if(!/^[0-9A-Fa-f]{32}$/.test(c))return module$contents$Blast$Interpreter_throwError("Eddystone UID must be 32 hexadecimal characters."),g.return();f="0x00"+c}return g.yield(Blast.Bluetooth.gatt_writeWithResponse(a,
Blast.Bluetooth.Eddystone.UUIDS.CONFIG_SERVICE,Blast.Bluetooth.Eddystone.UUIDS.ADV_SLOT_DATA_CHARACTERISTIC,f),2)}h=g.yieldResult;module$contents$Blast$Ui_addToLog("Eddystone advertising data set to <code>"+c+"</code>","Eddystone",a);return g.return(h)})};var module$exports$Blast$blocks$colours={},module$contents$Blast$blocks$colours_COLOUR_RGB_XML='\n<block type="colour_rgb">\n    <value name="RED">\n        <block type="math_number">\n            <field name="NUM">100</field>\n        </block>\n    </value>\n    <value name="GREEN">\n        <block type="math_number">\n            <field name="NUM">50</field>\n        </block>\n    </value>\n    <value name="BLUE">\n        <block type="math_number">\n            <field name="NUM">0</field>\n        </block>\n    </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("colour_rgb","colours",module$contents$Blast$blocks$colours_COLOUR_RGB_XML);var module$contents$Blast$blocks$colours_COLOUR_BLEND_XML='\n<block type="colour_blend">\n    <value name="COLOUR1">\n        <block type="colour_picker">\n            <field name="COLOUR">#ff0000</field>\n        </block>\n    </value>\n    <value name="COLOUR2">\n        <block type="colour_picker">\n            <field name="COLOUR">#3333ff</field>\n        </block>\n    </value>\n    <value name="RATIO">\n        <block type="math_number">\n            <field name="NUM">50</field>\n        </block>\n    </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("colour_blend","colours",module$contents$Blast$blocks$colours_COLOUR_BLEND_XML);var module$exports$Blast$blocks$control_flow={};Blockly.Blocks.repeat=Blockly.Blocks.controls_repeat_ext;Blockly.Blocks["for"]=Blockly.Blocks.controls_for;Blockly.Blocks.while_until=Blockly.Blocks.controls_whileUntil;Blockly.Blocks.break_continue=Blockly.Blocks.controls_flow_statements;Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.push("repeat","while_until","for");var module$contents$Blast$blocks$control_flow_REPEAT_XML='\n<block type="repeat">\n  <value name="TIMES">\n    <block type="math_number">\n      <field name="NUM">10</field>\n    </block>\n  </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("repeat","Control Flow",module$contents$Blast$blocks$control_flow_REPEAT_XML);var module$contents$Blast$blocks$control_flow_FOR_XML='\n<block type="for">\n  <value name="FROM">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="TO">\n    <block type="math_number">\n      <field name="NUM">5</field>\n    </block>\n  </value>\n  <value name="BY">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("for","Control Flow",module$contents$Blast$blocks$control_flow_FOR_XML);
Blockly.Blocks.conditional_statement={init:function(){this.appendValueInput("IF0").appendField("%{BKY_CONTROLS_IF_MSG_IF}").setCheck("Boolean");this.appendStatementInput("DO0").appendField("%{BKY_CONTROLS_IF_MSG_THEN}");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setHelpUrl("%{BKY_CONTROLS_IF_HELPURL}");this.setColour(120);this.setMutator(new Blockly.Mutator(["controls_if_elseif","controls_if_else"]));this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&
this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return Blockly.Msg.CONTROLS_IF_TOOLTIP_4}else return Blockly.Msg.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))},elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var a=Blockly.utils.xml.createElement("mutation");this.elseifCount_&&a.setAttribute("elseif",
this.elseifCount_);this.elseCount_&&a.setAttribute("else",1);return a},domToMutation:function(a){this.elseifCount_=parseInt(a.getAttribute("elseif"),10)||0;this.elseCount_=parseInt(a.getAttribute("else"),10)||0;this.rebuildShape_()},decompose:function(a){var b=a.newBlock("controls_if_if");b.initSvg();for(var c=b.nextConnection,d=1;d<=this.elseifCount_;d++){var f=a.newBlock("controls_if_elseif");f.initSvg();c.connect(f.previousConnection);c=f.nextConnection}this.elseCount_&&(a=a.newBlock("controls_if_else"),
a.initSvg(),c.connect(a.previousConnection));return b},compose:function(a){a=a.nextConnection.targetBlock();this.elseCount_=this.elseifCount_=0;for(var b=[null],c=[null],d=null;a&&!a.isInsertionMarker();){switch(a.type){case "controls_if_elseif":this.elseifCount_++;b.push(a.valueConnection_);c.push(a.statementConnection_);break;case "controls_if_else":this.elseCount_++;d=a.statementConnection_;break;default:throw new TypeError("Unknown block type: "+a.type);}a=a.nextConnection&&a.nextConnection.targetBlock()}this.updateShape_();
this.reconnectChildBlocks_(b,c,d)},saveConnections:function(a){a=a.nextConnection.targetBlock();for(var b=1;a;){switch(a.type){case "controls_if_elseif":var c=this.getInput("IF"+b),d=this.getInput("DO"+b);a.valueConnection_=c&&c.connection.targetConnection;a.statementConnection_=d&&d.connection.targetConnection;b++;break;case "controls_if_else":d=this.getInput("ELSE");a.statementConnection_=d&&d.connection.targetConnection;break;default:throw new TypeError("Unknown block type: "+a.type);}a=a.nextConnection&&
a.nextConnection.targetBlock()}},rebuildShape_:function(){var a=[null],b=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(var d=1;this.getInput("IF"+d);){var f=this.getInput("IF"+d),h=this.getInput("DO"+d);a.push(f.connection.targetConnection);b.push(h.connection.targetConnection);d++}this.updateShape_();this.reconnectChildBlocks_(a,b,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var a=1;this.getInput("IF"+a);)this.removeInput("IF"+
a),this.removeInput("DO"+a),a++;for(a=1;a<=this.elseifCount_;a++)this.appendValueInput("IF"+a).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+a).appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(a,b,c){for(var d=1;d<=this.elseifCount_;d++)Blockly.Mutator.reconnect(a[d],this,"IF"+d),Blockly.Mutator.reconnect(b[d],this,"DO"+
d);Blockly.Mutator.reconnect(c,this,"ELSE")}};Blockly.Blocks.wait_seconds={init:function(){this.appendValueInput("SECONDS").appendField("wait").setCheck("Number");this.appendDummyInput().appendField("seconds");this.setColour(120);this.setTooltip("Wait x seconds before executing the next block.");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setHelpUrl("")}};var module$contents$Blast$blocks$control_flow_WAIT_SECONDS_XML='\n<block type="wait_seconds">\n  <value name="SECONDS">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>\n';
module$contents$Blast$Toolbox_addBlock("wait_seconds","Control Flow",module$contents$Blast$blocks$control_flow_WAIT_SECONDS_XML);Blockly.Blocks.controls_if_if={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_IF_TITLE_IF}");this.setNextStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_IF_TOOLTIP}")}};
Blockly.Blocks.controls_if_elseif={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}")}};Blockly.Blocks.controls_if_else={init:function(){this.appendDummyInput().appendField("%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}");this.setPreviousStatement(!0,null);this.contextMenu=!1;this.setColour(120);this.setTooltip("%{BKY_CONTROLS_IF_ELSE_TOOLTIP}")}};var module$exports$Blast$blocks$events={};
Blockly.Blocks.state_definition={init:function(){var a=module$contents$Blast$States_findLegalName("",this);a=new Blockly.FieldTextInput(a,module$contents$Blast$States_rename);a.setSpellcheck(!1);this.appendValueInput("state_condition").setCheck("Boolean").appendField("define state").appendField(a,"NAME").appendField("condition");this.setColour(180);this.setTooltip("");this.setHelpUrl("")},getStateDef:function(){var a=this.getFieldValue("state_condition");return[this.getFieldValue("NAME"),a]},getConditions:function(){return this.getFieldValue("state_condition")}};
Blockly.Blocks.event={init:function(){this.appendDummyInput().appendField("when blast").appendField(new Blockly.FieldDropdown([["enters","ENTERS"],["exits","EXITS"]]),"entersExits").appendField("state").appendField(new Blockly.FieldLabelSerializable(""),"NAME");this.appendStatementInput("statements").setCheck(null);this.setColour(180);this.setTooltip("");this.setHelpUrl("")},getStateName:function(){return this.getFieldValue("NAME")},renameState:function(a,b){Blockly.Names.equals(a,this.getStateName())&&
this.setFieldValue(b,"NAME")},mutationToDom:function(){var a=Blockly.utils.xml.createElement("mutation");a.setAttribute("name",this.getStateName());return a},domToMutation:function(a){a=a.getAttribute("name");this.renameState(this.getStateName(),a)},onchange:function(a){if(this.workspace&&!this.workspace.isFlyout&&a.recordUndo)if(a.type==Blockly.Events.BLOCK_CREATE&&-1!=a.ids.indexOf(this.id)){var b=this.getStateName();(b=module$contents$Blast$States_getDefinition(b,this.workspace))&&b.type!=this.defType_&&
(b=null);if(!b){Blockly.Events.setGroup(a.group);a=Blockly.utils.xml.createElement("xml");b=Blockly.utils.xml.createElement("block");b.setAttribute("type",this.defType_);var c=this.getRelativeToSurfaceXY(),d=c.y+2*Blockly.SNAP_RADIUS;b.setAttribute("x",c.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1));b.setAttribute("y",d);c=this.mutationToDom();b.appendChild(c);c=Blockly.utils.xml.createElement("field");c.setAttribute("name","NAME");d=this.getStateName();d||(d=module$contents$Blast$States_findLegalName("",
this),this.renameState("",d));c.appendChild(Blockly.utils.xml.createTextNode(d));b.appendChild(c);a.appendChild(b);Blockly.Xml.domToWorkspace(a,this.workspace);Blockly.Events.setGroup(!1)}}else a.type==Blockly.Events.BLOCK_DELETE?(b=this.getStateName(),module$contents$Blast$States_getDefinition(b,this.workspace)||(Blockly.Events.setGroup(a.group),this.dispose(!0),Blockly.Events.setGroup(!1))):a.type==Blockly.Events.CHANGE&&"disabled"==a.element&&(b=this.getStateName(),(b=module$contents$Blast$States_getDefinition(b,
this.workspace))&&b.id==a.blockId&&((b=Blockly.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),Blockly.Events.setGroup(a.group),a.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),Blockly.Events.setGroup(b)))},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==a.ids.indexOf(this.id)&&module$contents$Blast$States$Interpreter_removeEventCode(this.event.blockId)},
defType_:"state_definition"};
Blockly.Blocks.event_every_minutes={init:function(){this.appendValueInput("value").setCheck("Number").appendField("every");this.appendDummyInput("units").appendField(new Blockly.FieldDropdown([["seconds","seconds"],["minutes","minutes"],["hours","hours"]]),"units");this.appendStatementInput("statements").appendField("do");this.setColour(180);this.setTooltip("");this.setHelpUrl("")},addEvent:function(){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){module$contents$Blast$Interpreter_eventsInWorkspace.push(a.id);module$contents$Blast$Interpreter_getWorkspace().addChangeListener(function(c){return a.onDispose(c)});
b.jumpToEnd()})},onchange:function(){this.isInFlyout||this.requested||!this.rendered||this.addEvent()},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==a.ids.indexOf(this.id)&&this.removeFromEvents()},removeFromEvents:function(){var a=module$contents$Blast$Interpreter_eventsInWorkspace.indexOf(this.id);-1!==a&&module$contents$Blast$Interpreter_eventsInWorkspace.splice(a,1)}};var module$exports$Blast$blocks$functions={};
Blockly.Blocks.procedures_defeval={init:function(){var a=Blockly.Procedures.findLegalName("",this);a=new Blockly.FieldTextInput(a,Blockly.Procedures.rename);a.setSpellcheck(!1);this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(a,"NAME").appendField("","PARAMS");this.appendDummyInput().appendField(new Blockly.FieldMultilineInput("return 2 + 2;"),"STACK");this.setMutator(new Blockly.Mutator(["procedures_mutatorarg"]));(this.workspace.options.comments||this.workspace.options.parentWorkspace&&
this.workspace.options.parentWorkspace.options.comments)&&Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT);this.setStyle("procedure_blocks");this.setTooltip(Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP);this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.statementConnection_=null},updateParams_:Blockly.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:Blockly.Blocks.procedures_defnoreturn.mutationToDom,
domToMutation:function(a){this.arguments_=[];this.argumentVarModels_=[];for(var b=0,c;c=a.childNodes[b];b++)if("arg"==c.nodeName.toLowerCase()){var d=c.getAttribute("name");c=c.getAttribute("varid")||c.getAttribute("varId");this.arguments_.push(d);c=Blockly.Variables.getOrCreateVariablePackage(this.workspace,c,d,"");null!=c?this.argumentVarModels_.push(c):console.log("Failed to create a variable with name "+d+", ignoring.")}this.updateParams_();Blockly.Procedures.mutateCallers(this)},decompose:Blockly.Blocks.procedures_defnoreturn.decompose,
compose:function(a){this.arguments_=[];this.paramIds_=[];this.argumentVarModels_=[];for(a=a.getInputTargetBlock("STACK");a&&!a.isInsertionMarker();){var b=a.getFieldValue("NAME");this.arguments_.push(b);b=this.workspace.getVariable(b,"");this.argumentVarModels_.push(b);this.paramIds_.push(a.id);a=a.nextConnection&&a.nextConnection.targetBlock()}this.updateParams_();Blockly.Procedures.mutateCallers(this)},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:Blockly.Blocks.procedures_defnoreturn.getVars,
getVarModels:Blockly.Blocks.procedures_defnoreturn.getVarModels,renameVarById:Blockly.Blocks.procedures_defnoreturn.renameVarById,updateVarName:Blockly.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:Blockly.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:Blockly.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"};
Blockly.Blocks.procedures_calleval={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME");this.setOutput(!0);this.setStyle("procedure_blocks");this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.quarkConnections_={};this.quarkIds_=null;this.previousEnabledState_=!0},getProcedureCall:Blockly.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:Blockly.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:Blockly.Blocks.procedures_callnoreturn.setProcedureParameters_,
updateShape_:Blockly.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:Blockly.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_callnoreturn.domToMutation,getVars:Blockly.Blocks.procedures_callnoreturn.getVars,getVarModels:Blockly.Blocks.procedures_callnoreturn.getVarModels,onchange:Blockly.Blocks.procedures_callnoreturn.onchange,customContextMenu:Blockly.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defeval"};
Blockly.Procedures.allProcedures=function(a){var b=a.getBlocksByType("procedures_defnoreturn",!1).map(function(d){return d.getProcedureDef()}),c=a.getBlocksByType("procedures_defreturn",!1).map(function(d){return d.getProcedureDef()});a=a.getBlocksByType("procedures_defeval",!1).map(function(d){return d.getProcedureDef()});b.sort(Blockly.Procedures.procTupleComparator_);c.sort(Blockly.Procedures.procTupleComparator_);a.sort(Blockly.Procedures.procTupleComparator_);return[b,c,a]};
Blockly.Procedures.flyoutCategory=function(a){function b(h,g){h=$jscomp.makeIterator(h);for(var l=h.next();!l.done;l=h.next()){l=l.value;var k=l[0],m=l[1];l=Blockly.utils.xml.createElement("block");l.setAttribute("type",g);l.setAttribute("gap",16);var n=Blockly.utils.xml.createElement("mutation");n.setAttribute("name",k);l.appendChild(n);k=$jscomp.makeIterator(m);for(m=k.next();!m.done;m=k.next()){m=m.value;var p=Blockly.utils.xml.createElement("arg");p.setAttribute("name",m);n.appendChild(p)}c.push(l)}}
var c=[];if(Blockly.Blocks.procedures_defnoreturn){var d=Blockly.utils.xml.createElement("block");d.setAttribute("type","procedures_defnoreturn");d.setAttribute("gap",16);var f=Blockly.utils.xml.createElement("field");f.setAttribute("name","NAME");f.appendChild(Blockly.utils.xml.createTextNode(Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE));d.appendChild(f);c.push(d)}Blockly.Blocks.procedures_defreturn&&(d=Blockly.utils.xml.createElement("block"),d.setAttribute("type","procedures_defreturn"),d.setAttribute("gap",
16),f=Blockly.utils.xml.createElement("field"),f.setAttribute("name","NAME"),f.appendChild(Blockly.utils.xml.createTextNode(Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(f),c.push(d));Blockly.Blocks.procedures_ifreturn&&(d=Blockly.utils.xml.createElement("block"),d.setAttribute("type","procedures_ifreturn"),d.setAttribute("gap",16),c.push(d));Blockly.Blocks.procedures_defeval&&(d=Blockly.utils.xml.createElement("block"),d.setAttribute("type","procedures_defeval"),d.setAttribute("gap",
16),f=Blockly.utils.xml.createElement("field"),f.setAttribute("name","NAME"),f.appendChild(Blockly.utils.xml.createTextNode(Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(f),c.push(d));c.length&&c[c.length-1].setAttribute("gap",24);a=Blockly.Procedures.allProcedures(a);b(a[0],"procedures_callnoreturn");b(a[1],"procedures_callreturn");b(a[2],"procedures_calleval");return c};
Blockly.Procedures.getDefinition=function(a,b){b=b.getAllBlocks(!1);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,c.getProcedureDef){var d=c.getProcedureDef();if(d&&Blockly.Names.equals(d[0],a))return c}return null};Blockly.Blocks.procedures_ifreturn.FUNCTION_TYPES.push("procedures_defeval");var module$exports$Blast$blocks$identifiers={};Blockly.Blocks.mac={init:function(){this.appendDummyInput().appendField("mac").appendField(new Blockly.FieldTextInput("deadbeef"),"MAC");this.setOutput(!0,"mac");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};Blockly.Blocks.uri={init:function(){this.appendDummyInput().appendField("URI").appendField(new Blockly.FieldTextInput("https://example.com"),"URI");this.setOutput(!0,"URI");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};
Blockly.Blocks.uri_from_string={init:function(){this.appendValueInput("URI").setCheck("String").appendField("URI from string");this.setOutput(!0,"URI");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};var module$exports$Blast$blocks$lists={};Blockly.Themes.Classic.blockStyles.list_blocks.colourPrimary=310;var module$exports$Blast$blocks$numbers={};Blockly.Blocks.number_value=Blockly.Blocks.math_number;Blockly.Blocks.number_arithmetic=Blockly.Blocks.math_arithmetic;Blockly.Blocks.number_single=Blockly.Blocks.math_single;Blockly.Blocks.number_trig=Blockly.Blocks.math_trig;Blockly.Blocks.number_constant=Blockly.Blocks.math_constant;Blockly.Blocks.number_property=Blockly.Blocks.math_number_property;Blockly.Blocks.number_round=Blockly.Blocks.math_round;Blockly.Blocks.number_on_list=Blockly.Blocks.math_on_list;
Blockly.Blocks.number_modulo=Blockly.Blocks.math_modulo;Blockly.Blocks.number_constrain=Blockly.Blocks.math_constrain;Blockly.Blocks.number_random=Blockly.Blocks.math_random_int;Blockly.Blocks.number_random_float=Blockly.Blocks.math_random_float;Blockly.Blocks.number_atan2=Blockly.Blocks.math_atan2;var module$exports$Blast$blocks$strings={};Blockly.Blocks.string=Blockly.Blocks.text;Blockly.Blocks.string_multiline=Blockly.Blocks.text_multiline;Blockly.Blocks.string_join=Blockly.Blocks.text_join;Blockly.Blocks.string_length=Blockly.Blocks.text_length;Blockly.Blocks.string_isEmpty=Blockly.Blocks.text_isEmpty;Blockly.Blocks.string_indexOf=Blockly.Blocks.text_indexOf;Blockly.Blocks.string_charAt=Blockly.Blocks.text_charAt;Blockly.Blocks.string_getSubstring=Blockly.Blocks.text_getSubstring;
Blockly.Blocks.string_changeCase=Blockly.Blocks.text_changeCase;Blockly.Blocks.string_trim=Blockly.Blocks.text_trim;Blockly.Blocks.string_count=Blockly.Blocks.text_count;Blockly.Blocks.string_replace=Blockly.Blocks.text_replace;Blockly.Blocks.string_reverse=Blockly.Blocks.text_reverse;Blockly.Blocks.string_showPrompt=Blockly.Blocks.text_prompt_ext;Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH="concatenate text";var module$exports$Blast$blocks$things={};Blockly.Blocks.things_webBluetooth={init:function(){this.appendDummyInput().appendField("webBluetooth device").appendField(new Blockly.FieldDropdown(module$contents$Blast$Things_getWebBluetoothDevices),"id");this.setOutput(!0,"Thing");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};
Blockly.Blocks.things_webHID={init:function(){this.appendDummyInput().appendField("HID device").appendField(new Blockly.FieldDropdown(module$contents$Blast$Things_getWebHIDDevices),"id");this.setOutput(!0,"Thing");this.setColour(60);this.setTooltip("");this.setHelpUrl("")}};var module$exports$Blast$generators$control_flow={};Blockly.JavaScript.repeat=Blockly.JavaScript.controls_repeat_ext;Blockly.JavaScript.while_until=Blockly.JavaScript.controls_whileUntil;Blockly.JavaScript["for"]=Blockly.JavaScript.controls_for;Blockly.JavaScript.break_continue=Blockly.JavaScript.controls_flow_statements;Blockly.JavaScript.conditional_statement=Blockly.JavaScript.controls_if;
Blockly.JavaScript.wait_seconds=function(a){return"waitForSeconds("+(Blockly.JavaScript.valueToCode(a,"SECONDS",Blockly.JavaScript.ORDER_ATOMIC)||0)+");\n"};var module$contents$Blast$generators$control_flow_waitForSeconds=function(a,b){setTimeout(b,1E3*a)};module$contents$Blast$Interpreter_asyncApiFunctions.push(["waitForSeconds",module$contents$Blast$generators$control_flow_waitForSeconds]);var module$exports$Blast$generators$events={};Blockly.JavaScript.state_definition=function(a){return null};
Blockly.JavaScript.event=function(a){var b=a.getFieldValue("entersExits"),c=a.getFieldValue("NAME"),d=Blockly.JavaScript.statementToCode(a,"statements");Blockly.JavaScript.definitions_.eventChecker="startEventChecker()";if(c=module$contents$Blast$States_getDefinition(c,module$contents$Blast$Interpreter_getWorkspace()))c=Blockly.JavaScript.valueToCode(c,"state_condition",Blockly.JavaScript.ORDER_NONE),"ENTERS"!=b&&(c="!("+c+")"),module$contents$Blast$States$Interpreter_addEventCode(a.id,'if(eventChecker("'+
a.id+'", '+c+")) {\n        setInterrupted(true);\n        "+d+" \n        setInterrupted(false);\n      }");return null};Blockly.JavaScript.event_every_minutes=function(a){var b=Blockly.JavaScript.valueToCode(a,"value",Blockly.JavaScript.ORDER_NONE)||0,c=a.getFieldValue("units"),d=Blockly.JavaScript.quote_(Blockly.JavaScript.statementToCode(a,"statements")),f;"seconds"===c?f=b:"minutes"===c?f=60*b:"hours"===c&&(f=3600*b);Blockly.JavaScript.definitions_[a.id]="addIntervalEvent("+f+", "+d+");\n";return null};
var module$contents$Blast$generators$events_addIntervalEvent=function(a,b){void 0===a||"number"!==typeof a||0>=a?module$contents$Blast$Interpreter_throwError("Timed event interval must be a number greater than 0."):(a=setInterval(function(){module$contents$Blast$Interpreter_setInterrupted(!1);var c=new Interpreter("");c.stateStack[0].scope=module$contents$Blast$Interpreter_getInterpreter().globalScope;c.appendCode(b);var d=function(){try{c.step()?setTimeout(d,5):module$contents$Blast$Interpreter_setInterrupted(!1)}catch(f){module$contents$Blast$Interpreter_throwError("Error executing program:\n "+
e),console.error(f)}};d()},1E3*a),Blast.Interpreter.intervalEvents.push(a))};module$contents$Blast$Interpreter_apiFunctions.push(["addIntervalEvent",module$contents$Blast$generators$events_addIntervalEvent]);var module$exports$Blast$generators$functions={};
Blockly.JavaScript.procedures_defeval=function(a){var b=Blockly.JavaScript.variableDB_.getName(a.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),c="";Blockly.JavaScript.STATEMENT_PREFIX&&(c+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,a));Blockly.JavaScript.STATEMENT_SUFFIX&&(c+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,a));c&&(c=Blockly.JavaScript.prefixLines(c,Blockly.JavaScript.INDENT));var d="";Blockly.JavaScript.INFINITE_LOOP_TRAP&&(d=Blockly.JavaScript.prefixLines(Blockly.JavaScript.injectId(Blockly.JavaScript.INFINITE_LOOP_TRAP,
a),Blockly.JavaScript.INDENT));for(var f=a.getFieldValue("STACK")||"",h=[],g=a.getVars(),l=0;l<g.length;l++)h[l]=Blockly.JavaScript.variableDB_.getName(g[l],Blockly.VARIABLE_CATEGORY_NAME);c="function "+b+"("+h.join(", ")+") {\n"+c+d+f+"\n}";c=Blockly.JavaScript.scrub_(a,c);Blockly.JavaScript.definitions_["%"+b]=c;return null};Blockly.JavaScript.procedures_defnoreturn=Blockly.JavaScript.procedures_defreturn;
Blockly.JavaScript.procedures_calleval=function(a){for(var b=Blockly.JavaScript.variableDB_.getName(a.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),c=[],d=a.getVars(),f=0;f<d.length;f++)c[f]=Blockly.JavaScript.valueToCode(a,"ARG"+f,Blockly.JavaScript.ORDER_NONE)||"null";return[b+"("+c.join(", ")+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]};module$contents$Blast$Interpreter_apiFunctions.push(["log",console.log]);var module$exports$Blast$generators$identifiers={};Blockly.JavaScript.uri=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("URI")),Blockly.JavaScript.ORDER_NONE]};Blockly.JavaScript.uri_from_string=function(a){return["convertToUri("+Blockly.JavaScript.valueToCode(a,"URI",Blockly.JavaScript.ORDER_NONE)+")",Blockly.JavaScript.ORDER_NONE]};var module$contents$Blast$generators$identifiers_convertToUri=function(a){try{new URL(a)}catch(b){module$contents$Blast$Interpreter_throwError("The given string is not a valid URI.")}return a};
module$contents$Blast$Interpreter_apiFunctions.push(["convertToUri",module$contents$Blast$generators$identifiers_convertToUri]);Blockly.JavaScript.mac=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("MAC")),Blockly.JavaScript.ORDER_NONE]};var module$exports$Blast$generators$numbers={};Blockly.JavaScript.number_value=Blockly.JavaScript.math_number;Blockly.JavaScript.number_arithmetic=Blockly.JavaScript.math_arithmetic;Blockly.JavaScript.number_single=Blockly.JavaScript.math_single;Blockly.JavaScript.number_trig=Blockly.JavaScript.math_trig;Blockly.JavaScript.number_constant=Blockly.JavaScript.math_constant;Blockly.JavaScript.number_property=Blockly.JavaScript.math_number_property;Blockly.JavaScript.number_round=Blockly.JavaScript.math_round;
Blockly.JavaScript.number_on_list=Blockly.JavaScript.math_on_list;Blockly.JavaScript.number_modulo=Blockly.JavaScript.math_modulo;Blockly.JavaScript.number_constrain=Blockly.JavaScript.math_constrain;Blockly.JavaScript.number_random=Blockly.JavaScript.math_random_int;Blockly.JavaScript.number_random_float=Blockly.JavaScript.math_random_float;Blockly.JavaScript.number_atan2=Blockly.JavaScript.math_atan2;var module$exports$Blast$generators$strings={};Blockly.JavaScript.string=Blockly.JavaScript.text;Blockly.JavaScript.string_multiline=Blockly.JavaScript.text_multiline;Blockly.JavaScript.string_join=Blockly.JavaScript.text_join;Blockly.JavaScript.string_length=Blockly.JavaScript.text_length;Blockly.JavaScript.string_isEmpty=Blockly.JavaScript.text_isEmpty;Blockly.JavaScript.string_indexOf=Blockly.JavaScript.text_indexOf;Blockly.JavaScript.string_charAt=Blockly.JavaScript.text_charAt;
Blockly.JavaScript.string_getSubstring=Blockly.JavaScript.text_getSubstring;Blockly.JavaScript.string_changeCase=Blockly.JavaScript.text_changeCase;Blockly.JavaScript.string_trim=Blockly.JavaScript.text_trim;Blockly.JavaScript.string_count=Blockly.JavaScript.text_count;Blockly.JavaScript.string_replace=Blockly.JavaScript.text_replace;Blockly.JavaScript.string_reverse=Blockly.JavaScript.text_reverse;Blockly.JavaScript.string_showPrompt=Blockly.JavaScript.text_prompt;
module$contents$Blast$Interpreter_apiFunctions.push(["prompt",prompt]);var module$exports$Blast$generators$things={};Blockly.JavaScript.things_webBluetooth=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("id")),Blockly.JavaScript.ORDER_NONE]};Blockly.JavaScript.things_webHID=function(a){return[Blockly.JavaScript.quote_(a.getFieldValue("id")),Blockly.JavaScript.ORDER_NONE]};Blockly.Blocks.http_request={init:function(){this.appendValueInput("uri").appendField("send HTTP request to URI").setCheck("URI");this.appendDummyInput().appendField("output").appendField(new Blockly.FieldDropdown([["status","status"],["response","body"]]),"OUTPUT");this.appendDummyInput().appendField("method").appendField(new Blockly.FieldDropdown([["GET","GET"],["PUT","PUT"],["POST","POST"],["DELETE","DELETE"]],this.httpRequestValidator),"METHOD");this.appendValueInput("headers").appendField("headers").setCheck("String");
this.appendValueInput("body").appendField("body").setCheck("String").setVisible(!1);this.setOutput(!0,"String");this.setTooltip("Invokes a HTTP request.");this.setColour(0)},httpRequestValidator:function(a){this.getSourceBlock().updateInputs(a);return a},updateInputs:function(a){var b=this.getInput("body");"GET"==a?b.setVisible(!1):b.setVisible(!0)}};var HTTP_REQUEST_XML='\n<block type="http_request">\n  <value name="uri">\n    <block type="uri_from_string">\n      <value name="URI">\n        <block type="string">\n          <field name="TEXT">https://example.com</field>\n        </block>\n      </value>\n    </block>\n  </value>\n  <value name="headers">\n    <block type="string">\n      <field name="TEXT">"Content-Type": "application/json", "Accept": "application/json"</field>\n    </block>\n  </value>\n  <value name="body">\n    <block type="string_multiline">\n      <field name="TEXT">\n{\n  "object": {\n    "a": "b",\n    "c": "d",\n    "e": "f"\n  },\n  "array": [\n    1,\n    2\n  ],\n  "string": "Hello World"\n}\n      </field>\n    </block>\n  </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("http_request","Requests and Queries",HTTP_REQUEST_XML);
Blockly.Blocks.sparql_query={init:function(){this.appendValueInput("uri").appendField("run SPARQL Query from URI").setCheck("URI");this.appendDummyInput().appendField("resource format").appendField(new Blockly.FieldDropdown([["JSON-LD","application/ld+json"],["Turtle (TriG)","application/trig"],["N-Quads","application/n-quads"]]),"format");this.appendDummyInput().appendField(new Blockly.FieldMultilineInput("SELECT *\n       WHERE { \n         ?s ?p ?o\n       }"),"query");this.setInputsInline(!1);
this.setColour(0);this.setOutput(!0,"Array");this.setTooltip("Executes a sparql query")}};module$contents$Blast$Toolbox_addBlock("sparql_query","Requests and Queries");
Blockly.Blocks.sparql_ask={init:function(){this.appendValueInput("uri").appendField("run SPARQL ASK Query from URI").setCheck("URI");this.appendDummyInput().appendField("resource format").appendField(new Blockly.FieldDropdown([["JSON-LD","application/ld+json"],["Turtle (TriG)","application/trig"],["N-Quads","application/n-quads"]]),"format");this.appendDummyInput().appendField(new Blockly.FieldMultilineInput("PREFIX sosa: <http://www.w3.org/ns/sosa/>\n     ASK \n     WHERE {\n       ?node sosa:hasSimpleResult ?rssiValue \n       FILTER (?rssiValue > -40)\n     }"),
"query");this.setInputsInline(!1);this.setOutput(!0,"Boolean");this.setTooltip("executes a sparql ASK query");this.setColour(0)}};module$contents$Blast$Toolbox_addBlock("sparql_ask","Requests and Queries");
Blockly.Blocks.display_text={init:function(){this.appendValueInput("text").setCheck("String Number Boolean URI Thing Array".split(" ")).appendField("display text:");this.setColour(0);this.setTooltip("Add text output to the container on the right.");this.setHelpUrl("");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)}};module$contents$Blast$Toolbox_addBlock("display_text","Actions");
Blockly.Blocks.display_table={init:function(){this.appendValueInput("table").setCheck(["Array"]).appendField("display table:");this.setColour(0);this.setTooltip("Add data output to the container on the right.");this.setHelpUrl("");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)}};module$contents$Blast$Toolbox_addBlock("display_table","Actions");
Blockly.Blocks.play_audio={init:function(){this.appendValueInput("URI").appendField("play audio from URI").setCheck("URI");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("Plays an audio file from URI.");this.setHelpUrl("")}};module$contents$Blast$Toolbox_addBlock("play_audio","Actions");
Blockly.Blocks.capture_image={init:function(){this.appendDummyInput().appendField("capture image from camera");this.setOutput(!0,"Image");this.setColour(0);this.setTooltip("Captures an image from a camera.");this.setHelpUrl("")},onChange:function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this.setWarningText("Your browser does not support mediaDevices.")}};module$contents$Blast$Toolbox_addBlock("capture_image","Actions");
Blockly.Blocks.display_image={init:function(){this.appendValueInput("image").setCheck("Image").appendField("display image");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("Displays an image.");this.setHelpUrl("")}};module$contents$Blast$Toolbox_addBlock("display_image","Actions");
Blockly.Blocks.get_signal_strength_wb={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read signal-strength property of Bluetooth device");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads the strength of the signal (rssiValue property) sent by a BLE device, measured at the at the BLAST client.");this.setHelpUrl("");this.firstTime=!0;this.deviceId=""},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=
!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later."),this.dispose()))}};module$contents$Blast$Toolbox_addBlock("get_signal_strength_wb","Properties");
Blockly.Blocks.write_eddystone_property={init:function(){this.appendDummyInput("Property").appendField("write").appendField(new Blockly.FieldDropdown([["advertised tx power","advertisedTxPower"],["advertisement data","advertisementData"],["advertising interval","advertisingInterval"],["radio tx power","radioTxPower"]],this.propertyValidator),"Property").appendField("property at slot");this.appendValueInput("Slot").setCheck("Number");this.appendDummyInput("FrameType").appendField("frame type").appendField(new Blockly.FieldDropdown([["UID",
"UID"],["URL","URL"]],this.frameTypeValidator),"FrameType").setVisible(!1);this.appendValueInput("Value").appendField("value").setCheck("Number");this.appendValueInput("Thing").appendField("to Eddystone device").setCheck("Thing");this.setPreviousStatement(!0,null);this.setInputsInline(!0);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Writes a property to an Eddystone device.");this.setHelpUrl("https://github.com/google/eddystone/tree/master/configuration-service")},propertyValidator:function(a){var b=
this.getSourceBlock(),c=b.getInput("FrameType");c.setVisible(!1);"advertisementData"==a?c.setVisible(!0):b.getInput("Value").setCheck("Number")},frameTypeValidator:function(a){var b=this.getSourceBlock();"UID"===a?b.getInput("Value").setCheck("String"):"URL"===a&&b.getInput("Value").setCheck("URI")}};var WRITE_EDDYSTONE_PROPERTY_XML='\n<block type="write_eddystone_property">\n  <value name="Slot">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("write_eddystone_property","Properties",WRITE_EDDYSTONE_PROPERTY_XML);
Blockly.Blocks.read_eddystone_property={init:function(){this.appendDummyInput("Property").appendField("read").appendField(new Blockly.FieldDropdown([["advertised tx power","advertisedTxPower"],["advertisement data","advertisementData"],["advertising interval","advertisingInterval"],["lock state","lockState"],["public ECDH key","publicECDHKey"],["radio tx power","radioTxPower"]]),"Property").appendField("property");this.appendValueInput("Slot").setCheck("Number").appendField("at slot");this.appendValueInput("Thing").appendField("of Eddystone device").setCheck("Thing");
this.setOutput(!0,["String","Number"]);this.setColour(255);this.setInputsInline(!0);this.setTooltip("Reads a property from an Eddystone device.");this.setHelpUrl("https://github.com/google/eddystone/tree/master/configuration-service")}};var READ_EDDYSTONE_PROPERTY_XML='\n<block type="read_eddystone_property">\n  <value name="Slot">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n</block>';
module$contents$Blast$Toolbox_addBlock("read_eddystone_property","Properties",READ_EDDYSTONE_PROPERTY_XML);Blockly.JavaScript.http_request=function(a){var b=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE)||null,c=a.getFieldValue("METHOD"),d=Blockly.JavaScript.valueToCode(a,"header",Blockly.JavaScript.ORDER_NONE),f=a.getFieldValue("OUTPUT");a=Blockly.JavaScript.valueToCode(a,"body",Blockly.JavaScript.ORDER_NONE);return["sendHttpRequest("+b+",'"+c+"', \n      '{"+d+"}', "+a+", '"+f+"')\n",Blockly.JavaScript.ORDER_NONE]};
var sendHttpRequest=function(a,b,c,d,f,h){var g,l,k,m,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:return null!=a&&void 0!=a&&""!=a||module$contents$Blast$Interpreter_throwError("URI input of HttpRequest blocks must not be empty"),g=JSON.parse(c),l={method:b,headers:new Headers(g)},"GET"!==b&&d&&(l.body=d),p.setCatchFinallyBlocks(2),p.yield(fetch(a,l),4);case 4:return k=p.yieldResult,k.ok?"status"==f?(h(k.status),p.return()):p.yield(k.text(),5):(module$contents$Blast$Interpreter_throwError("Failed to get "+
a+", Error: "+k.status+" "+k.statusText),p.return());case 5:m=p.yieldResult;h(m);p.leaveTryBlock(0);break;case 2:n=p.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Failed to get "+a+", Error: "+n.message),p.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["sendHttpRequest",sendHttpRequest]);
Blockly.JavaScript.sparql_query=function(a){var b=a.getFieldValue("query"),c=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE);a=Blockly.JavaScript.quote_(a.getFieldValue("format"))||"";b=b.replace(/"/g,'\\"').replace(/[\n\r]/g," ");return["urdfQueryWrapper("+c+", "+a+", '"+b+"')",Blockly.JavaScript.ORDER_NONE]};
Blockly.JavaScript.sparql_ask=function(a){var b=a.getFieldValue("query"),c=Blockly.JavaScript.quote_(a.getFieldValue("format"))||"";a=Blockly.JavaScript.valueToCode(a,"uri",Blockly.JavaScript.ORDER_NONE);b=b.replace(/"/g,'\\"').replace(/[\n\r]/g," ");return["urdfQueryWrapper("+a+", "+c+", '"+b+"')",Blockly.JavaScript.ORDER_NONE]};
var urdfQueryWrapper=function(a,b,c,d){var f,h,g,l,k,m,n,p,q,r,t,v,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(u){switch(u.nextAddress){case 1:return u.setCatchFinallyBlocks(2),u.yield(fetch(a),4);case 4:return f=u.yieldResult,f.ok?u.yield(f.text(),5):(module$contents$Blast$Interpreter_throwError("Failed to get "+a+", Error: "+f.status+" "+f.statusText),u.return());case 5:return h=u.yieldResult,urdf.clear(),g={format:b},u.yield(urdf.load(h,g),6);case 6:return u.yield(urdf.query(c),
7);case 7:f=u.yieldResult;u.leaveTryBlock(3);break;case 2:l=u.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Failed to get "+a+", Error: "+l.message);case 3:if("boolean"===typeof f)return d(f),u.return();k=Array(f.length);m=$jscomp.makeIterator(f);for(n=m.next();!n.done;n=m.next()){p=n.value;q=Array(Object.keys(p).length);r=$jscomp.makeIterator(Object.values(p));for(t=r.next();!t.done;t=r.next())v=t.value,q.push(v.value);k.push(q)}w=module$contents$Blast$Interpreter_getInterpreter().nativeToPseudo(k);
d(w);u.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["urdfQueryWrapper",urdfQueryWrapper]);Blockly.JavaScript.display_text=function(a){return"displayText("+(Blockly.JavaScript.valueToCode(a,"text",Blockly.JavaScript.ORDER_NONE)||"''")+");\n"};var displayText=function(a){module$contents$Blast$Interpreter_getStdOut()(a)};module$contents$Blast$Interpreter_apiFunctions.push(["displayText",displayText]);
Blockly.JavaScript.display_table=function(a){return"displayTable("+Blockly.JavaScript.valueToCode(a,"table",Blockly.JavaScript.ORDER_NONE)+");\n"};
var displayTable=function(a){a=module$contents$Blast$Interpreter_getInterpreter().pseudoToNative(a);if(0==a.length)Blast.Interpreter.stdOut("empty table");else{var b=document.createElement("table");b.classList.add("output_table");a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){var d=c.value;c=document.createElement("tr");if(void 0!==d){d=$jscomp.makeIterator(d);for(var f=d.next();!f.done;f=d.next())if(f=f.value,void 0!==f){var h=document.createElement("td");h.innerHTML=f;c.appendChild(h)}b.appendChild(c)}}module$contents$Blast$Ui_addElementToOutputContainer(b)}};
module$contents$Blast$Interpreter_apiFunctions.push(["displayTable",displayTable]);Blockly.JavaScript.play_audio=function(a){return"playAudio("+Blockly.JavaScript.valueToCode(a,"URI",Blockly.JavaScript.ORDER_NONE)+");\n"};
var playAudio=function(a,b){return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(new Promise(function(d,f){var h=new Audio(a);h.preload="auto";h.autoplay=!0;h.onerror=function(g){module$contents$Blast$Interpreter_throwError("Error trying to play audio from \n"+a+"\n See console for details");console.error(g);f(g)};h.onended=d}),2);b();c.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["playAudio",playAudio]);
Blockly.JavaScript.capture_image=function(a){return["captureImage()",Blockly.JavaScript.ORDER_NONE]};
var captureImage=function(a){var b,c,d,f,h,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return b=document.createElement("video"),b.id="video",b.setAttribute("autoplay","autoplay"),b.setAttribute("muted",!0),b.style.display="none",document.body.appendChild(b),c={video:!0},l.yield(navigator.mediaDevices.getUserMedia(c),2);if(3!=l.nextAddress)return d=l.yieldResult,b.srcObject=d,f=document.createElement("canvas"),h=f.getContext("2d"),l.yield(new Promise(function(k,
m){b.onloadedmetadata=function(){f.width=b.videoWidth;f.height=b.videoHeight;h.drawImage(b,0,0,f.width,f.height);k()};video.onerror=function(n){module$contents$Blast$Interpreter_throwError("Error trying to capture image from camera. See console for details");console.error(n);m(n)}}),3);g=f.toDataURL("image/png");b.srcObject.getTracks().forEach(function(k){return k.stop()});b.remove();f.remove();a(g);l.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["captureImage",captureImage]);
Blockly.JavaScript.display_image=function(a){return"displayImage("+Blockly.JavaScript.valueToCode(a,"image",Blockly.JavaScript.ORDER_NONE)+");\n"};var displayImage=function(a){var b=document.createElement("img");b.src=a;b.classList.add("output_image");module$contents$Blast$Ui_addElementToOutputContainer(b)};module$contents$Blast$Interpreter_apiFunctions.push(["displayImage",displayImage]);
Blockly.JavaScript.get_signal_strength_wb=function(a){return["getRSSIWb("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)+")",Blockly.JavaScript.ORDER_NONE]};
var getRSSIWb=function(a,b){var c,d,f,h,g,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(navigator.bluetooth.getDevices(),2);c=k.yieldResult;d=null;f=$jscomp.makeIterator(c);for(h=f.next();!h.done;h=f.next())if(g=h.value,g.id===a){d=g;break}null==d&&module$contents$Blast$Interpreter_throwError("Error pairing with Bluetooth device.");l=new AbortController;d.addEventListener("advertisementreceived",function(m){return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){l.abort();
b(m.rssi);n.jumpToEnd()})});return k.yield(d.watchAdvertisements({signal:l.signal}),0)})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["getRSSIWb",getRSSIWb]);
Blockly.JavaScript.write_eddystone_property=function(a){var b=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)||null,c=Blockly.JavaScript.quote_(a.getFieldValue("Property")),d=Blockly.JavaScript.valueToCode(a,"Slot",Blockly.JavaScript.ORDER_NONE)||null,f=Blockly.JavaScript.valueToCode(a,"Value",Blockly.JavaScript.ORDER_NONE)||null;a=Blockly.JavaScript.quote_(a.getFieldValue("FrameType"));return"writeEddystoneProperty("+b+", "+d+", "+c+", "+a+", "+f+");\n"};
var eddystoneServiceUUID="a3c87500-8ed3-4bdf-8a39-a01bebede295";Blast.Bluetooth.optionalServices.push(eddystoneServiceUUID);
var writeEddystoneProperty=function(a,b,c,d,f,h){return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return a?null===b||void 0===b?(module$contents$Blast$Interpreter_throwError("No slot set."),h(),g.return()):c?g.yield(Blast.Bluetooth.Eddystone.setActiveSlot(a,b),2):(module$contents$Blast$Interpreter_throwError("No property set."),h(),g.return()):(module$contents$Blast$Interpreter_throwError("No bluetooth device set."),h(),g.return());case 2:switch(c){case "advertisedTxPower":return g.jumpTo(3);
case "advertisementData":return g.jumpTo(4);case "advertisingInterval":return g.jumpTo(5);case "radioTxPower":return g.jumpTo(6)}g.jumpTo(7);break;case 3:return g.yield(Blast.Bluetooth.Eddystone.setAdvertisedTxPower(a,f),8);case 8:g.jumpTo(7);break;case 4:return g.yield(Blast.Bluetooth.Eddystone.setAdvertisingData(a,d,f),9);case 9:g.jumpTo(7);break;case 5:return g.yield(Blast.Bluetooth.Eddystone.setAdvertisingInterval(a,f),10);case 10:g.jumpTo(7);break;case 6:return g.yield(Blast.Bluetooth.Eddystone.setTxPowerLevel(a,
f),11);case 11:g.jumpTo(7);break;case 7:h(),g.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["writeEddystoneProperty",writeEddystoneProperty]);Blockly.JavaScript.read_eddystone_property=function(a){var b=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)||null,c=Blockly.JavaScript.quote_(a.getFieldValue("Property"));a=Blockly.JavaScript.valueToCode(a,"Slot",Blockly.JavaScript.ORDER_NONE)||null;return["readEddystoneProperty("+b+", "+a+", "+c+")",Blockly.JavaScript.ORDER_NONE]};
var readEddystoneProperty=function(a,b,c,d){var f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:return a?null===b||void 0===b?(module$contents$Blast$Interpreter_throwError("No slot set."),d(),h.return()):c?h.yield(Blast.Bluetooth.Eddystone.setActiveSlot(a,b),2):(module$contents$Blast$Interpreter_throwError("No property set."),d(),h.return()):(module$contents$Blast$Interpreter_throwError("No bluetooth device set."),d(),h.return());case 2:f=null;switch(c){case "advertisedTxPower":return h.jumpTo(3);
case "advertisementData":return h.jumpTo(4);case "advertisingInterval":return h.jumpTo(5);case "lockState":return h.jumpTo(6);case "publicECDHKey":return h.jumpTo(7);case "radioTxPower":return h.jumpTo(8)}h.jumpTo(9);break;case 3:return h.yield(Blast.Bluetooth.Eddystone.getAdvertisedTxPower(a),10);case 10:f=h.yieldResult;h.jumpTo(9);break;case 4:return h.yield(Blast.Bluetooth.Eddystone.getAdvertisingData(a),11);case 11:f=h.yieldResult;h.jumpTo(9);break;case 5:return h.yield(Blast.Bluetooth.Eddystone.getAdvertisingInterval(a),
12);case 12:f=h.yieldResult;h.jumpTo(9);break;case 6:return h.yield(Blast.Bluetooth.Eddystone.getLockState(a),13);case 13:f=h.yieldResult;h.jumpTo(9);break;case 7:return h.yield(Blast.Bluetooth.Eddystone.getPublicECDHKey(a),14);case 14:f=h.yieldResult;h.jumpTo(9);break;case 8:return h.yield(Blast.Bluetooth.Eddystone.getTxPowerLevel(a),15);case 15:f=h.yieldResult;h.jumpTo(9);break;case 9:d(f),h.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["readEddystoneProperty",readEddystoneProperty]);Blockly.Blocks.switch_lights_rgb={init:function(){this.appendValueInput("colour").setCheck("Colour").appendField("write colour property");this.appendValueInput("thing").setCheck("Thing").appendField("to LED controller");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Switches checked lights on and unchecked ones off.");this.setHelpUrl("");this.firstTime=!0},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&
(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later and enable Experimental Web Platform features."),this.dispose()))}};var SWITCH_LIGHTS_RGB_XML='\n<block type="switch_lights_rgb">\n  <value name="colour">\n    <block type="colour_picker">\n      <field name="COLOUR">#ff0000</field>\n    </block>\n  </value>\n</block>';module$contents$Blast$Toolbox_addBlock("switch_lights_rgb","Properties",SWITCH_LIGHTS_RGB_XML);Blockly.JavaScript.switch_lights_rgb=function(a){var b=Blockly.JavaScript.valueToCode(a,"colour",Blockly.JavaScript.ORDER_ATOMIC)||Blockly.JavaScript.quote_("#000000");return"switchLights("+(Blockly.JavaScript.valueToCode(a,"thing",Blockly.JavaScript.ORDER_NONE)||"null")+", "+b+");\n"};var LEDServiceUUID="0000fff0-0000-1000-8000-00805f9b34fb";Blast.Bluetooth.optionalServices.push(LEDServiceUUID);
var switchLights=function(a,b,c){var d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress){if(!a)return module$contents$Blast$Interpreter_throwError("No LED Controller is set."),c(),f.return();d="7e000503"+b.substring(1,7)+"00ef";return f.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,LEDServiceUUID,"0000fff3-0000-1000-8000-00805f9b34fb",d),2)}c();f.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["switchLights",switchLights]);Blockly.Blocks.huskylens_choose_algo={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("write algorithm property").appendField(new Blockly.FieldDropdown([["Face Recognition","face_recognition"],["Object Tracking","object_tracking"],["Object Recognition","object_recognition"],["Line Tracking","line_tracking"],["Color Recognition","color_recognition"],["Tag Recognition","tag_recognition"],["Object Classification","object_classification"]]),"Algorithms").appendField("to Huskyduino");
this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Choose the algorithm of a HuskyDuino");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};module$contents$Blast$Toolbox_addBlock("huskylens_choose_algo","Properties");
Blockly.Blocks.huskylens_write_id={init:function(){this.appendValueInput("ID").setCheck("Number").appendField("write ID property");this.appendValueInput("Thing").setCheck("Thing").appendField("to HuskyDuino");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Sets the ID of the object currently on camera. ID shoud be a value between 1 and 255");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&
(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};var HUSKYLENS_WRITE_ID_XML='\n<block type="huskylens_write_id">\n  <value name="ID">\n    <block type="math_number">\n      <field name="NUM">1</field>\n    </block>\n  </value>\n</block>\n';module$contents$Blast$Toolbox_addBlock("huskylens_write_id","Properties",HUSKYLENS_WRITE_ID_XML);
Blockly.Blocks.huskylens_write_forget_flag={init:function(){this.appendValueInput("forgetFlag").setCheck("Boolean").appendField("write forget flag property");this.appendValueInput("Thing").setCheck("Thing").appendField("to HuskyDuino");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("forget all values of the currently selected algorithm");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&
(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),this.dispose()))}};var HUSKYLENS_FORGET_FLAG_XML='\n<block type="huskylens_write_forget_flag">\n  <value name="forgetFlag">\n    <block type="logic_boolean">\n      <field name="BOOL">TRUE</field>\n    </block>\n  </value>\n</block>\n';module$contents$Blast$Toolbox_addBlock("huskylens_write_forget_flag","Properties",HUSKYLENS_FORGET_FLAG_XML);
Blockly.Blocks.huskylens_read_id={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read ID property of HuskyDuino");this.setOutput(!0,"String");this.setColour(255);this.setTooltip("returns up to 5 IDs of the objects currently visible to the HuskyLens");this.setHelpUrl("")},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n                Upgrade to Chrome version 85 or later."),
this.dispose()))}};module$contents$Blast$Toolbox_addBlock("huskylens_read_id","Properties");Blockly.JavaScript.huskylens_choose_algo=function(a){var b=a.getFieldValue("Algorithms");return"chooseAlgo("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '"+{face_recognition:"0x01",object_tracking:"0x02",object_recognition:"0x03",line_tracking:"0x04",color_recognition:"0x05",tag_recognition:"0x06",object_classification:"0x07"}[b]+"');\n"};
Blockly.JavaScript.huskylens_write_id=function(a){var b=Blockly.JavaScript.valueToCode(a,"ID",Blockly.JavaScript.ORDER_ATOMIC);b="0x"+parseInt(b).toString(16);return"learnID("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '"+b+"');\n"};
Blockly.JavaScript.huskylens_write_forget_flag=function(a){var b=Blockly.JavaScript.valueToCode(a,"forgetFlag",Blockly.JavaScript.ORDER_ATOMIC);return"forgetAll("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+", '0x"+(b?"01":"00")+"');\n"};Blockly.JavaScript.huskylens_read_id=function(a){return["readID("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC)+")",Blockly.JavaScript.ORDER_NONE]};var HuskyServiceUUID="5be35d20-f9b0-11eb-9a03-0242ac130003";
Blast.Bluetooth.optionalServices.push(HuskyServiceUUID);var chooseAlgo=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be35d26-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["chooseAlgo",chooseAlgo]);
var learnID=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be35eca-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["learnID",learnID]);
var forgetAll=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_writeWithoutResponse(a,HuskyServiceUUID,"5be361b8-f9b0-11eb-9a03-0242ac130003",b),2);c();d.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["forgetAll",forgetAll]);
var readID=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Blast.Bluetooth.gatt_read_text(a,HuskyServiceUUID,"5be3628a-f9b0-11eb-9a03-0242ac130003"),2);c=d.yieldResult;b(c);d.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["readID",readID]);Blockly.Blocks.joycon_read_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read").appendField(new Blockly.FieldDropdown([["accelerometers","accelerometers"],["actual accelerometer","actualAccelerometer"],["actual gyroscope","actualGyroscope"],["actual orientation","actualOrientation"],["actual orientation quaternion","actualOrientationQuaternion"],["gyroscopes","gyroscopes"],["quaternion","quaternion"]],this.propertyValidator),"property").appendField("property of Nintendo JoyCon");
this.setInputsInline(!1);this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads a property of a Nintendo JoyCon controller.");this.setHelpUrl("");this.firstTime=!0},propertyValidator:function(a){this.getSourceBlock().updateInputs(a);return a},updateInputs:function(a){this.removeInput("propertySubValue",!0);this.removeInput("propertySubValue2",!0);this.removeInput("propertySubValue3",!0);"accelerometers"===a&&(this.appendDummyInput("propertySubValue").appendField("accelerometer").appendField(new Blockly.FieldDropdown([["0",
"0"],["1","1"],["2","2"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue2"));"actualAccelerometer"===a&&this.appendDummyInput("propertySubValue").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue");"actualGyroscope"===a&&(this.appendDummyInput("propertySubValue").appendField("unit").appendField(new Blockly.FieldDropdown([["rps",
"rps"],["dps","dps"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","x"],["y","y"],["z","z"]]),"propertySubValue2"));"actualOrientation"===a&&this.appendDummyInput("propertySubValue").appendField("degrees").appendField(new Blockly.FieldDropdown([["alpa","alpha"],["beta","beta"],["gamma","gamma"]]),"propertySubValue");"actualOrientationQuaternion"===a&&this.appendDummyInput("propertySubValue").appendField("degrees").appendField(new Blockly.FieldDropdown([["alpa",
"alpha"],["beta","beta"],["gamma","gamma"]]),"propertySubValue");"gyroscopes"===a&&(this.appendDummyInput("propertySubValue").appendField("gyroscope").appendField(new Blockly.FieldDropdown([["0","0"],["1","1"],["2","2"]]),"propertySubValue"),this.appendDummyInput("propertySubValue2").appendField("axis").appendField(new Blockly.FieldDropdown([["x","0"],["y","1"],["z","2"]]),"propertySubValue2"),this.appendDummyInput("propertySubValue3").appendField("unit").appendField(new Blockly.FieldDropdown([["dps",
"dps"],["rps","rps"]]),"propertySubValue3"));"quaternion"===a&&this.appendDummyInput("propertySubValue").appendField("axis").appendField(new Blockly.FieldDropdown([["w","w"],["x","x"],["y","y"],["z","z"]]),"propertySubValue")}};module$contents$Blast$Toolbox_addBlock("joycon_read_property","Properties");
Blockly.Blocks.joycon_button_events={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("Nintendo JoyCon");this.appendDummyInput().appendField("when").appendField(new Blockly.FieldDropdown([["A","a"],["B","b"],["X","x"],["Y","y"],["up","up"],["left","left"],["down","down"],["right","right"],["R","r"],["L","l"],["ZR","zr"],["ZL","zl"]]),"button").appendField("pressed");this.appendStatementInput("statements").setCheck(null);this.setInputsInline(!1);this.setColour(180);this.setTooltip("");
this.setHelpUrl("");this.requested=!1},addEvent:function(){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){module$contents$Blast$Interpreter_eventsInWorkspace.push(a.id);module$contents$Blast$Interpreter_getWorkspace().addChangeListener(function(c){return a.onDispose(c)});b.jumpToEnd()})},onchange:function(){this.isInFlyout||this.requested||!this.rendered||this.addEvent()},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==
a.ids.indexOf(this.id)&&this.removeFromEvents()},removeFromEvents:function(){var a=module$contents$Blast$Interpreter_eventsInWorkspace.indexOf(this.id);-1!==a&&module$contents$Blast$Interpreter_eventsInWorkspace.splice(a,1)}};module$contents$Blast$Toolbox_addBlock("joycon_button_events","States and Events");Blockly.JavaScript.joycon_read_property=function(a){var b=a.getFieldValue("property"),c=a.getFieldValue("propertySubValue")||"",d=a.getFieldValue("propertySubValue2")||"",f=a.getFieldValue("propertySubValue3")||"";return["readJoyConProperty("+Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE)+", '"+b+"', '"+c+"', '"+d+"', '"+f+"')",Blockly.JavaScript.ORDER_NONE]};
var readJoyConProperty=function(a,b,c,d,f,h){var g,l,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){switch(m.nextAddress){case 1:if(!a)return module$contents$Blast$Interpreter_throwError("No Joy-Con block set."),h(),m.return();g=module$contents$Blast$Things_webHidDevices.get(a);if(!g)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the JoyCon via webHID"),h(),m.return();if(g.opened){m.jumpTo(2);break}m.setCatchFinallyBlocks(3);
return m.yield(g.open(),5);case 5:m.leaveTryBlock(2);break;case 3:m.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(1406!==g.vendorId||8198!==g.productId&&8199!==g.productId)return module$contents$Blast$Interpreter_throwError("The connected device is not a Joy-Con."),h(),m.return();8198===g.productId?l=new JoyConLeft(g):8199===g.productId&&(l=new JoyConRight(g));return m.yield(l.open(),6);case 6:return m.yield(l.enableStandardFullMode(),
7);case 7:return m.yield(l.enableIMUMode(),8);case 8:k=function(n){var p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){p=n.detail;if(!p||!p.actualOrientation)return q.return();module$contents$Blast$Ui_addToLog("Received <code>hidinput</code> event from Joy-Con: <code>"+JSON.stringify(p)+"</code>","hid",g.productname);module$contents$Blast$Ui_addToLog("Removing <code>hidinput</code> event listener","hid",g.productname);l.removeEventListener("hidinput",k);""!==d?"accelerometers"===
b?h(p[b][c][d].acc):"gyroscopes"===b?h(p[b][c][d][f]):h(p[b][c][d]):h(p[b][c]);q.jumpToEnd()})};if(l.eventListenerAttached){m.jumpTo(0);break}return m.yield(l.open(),10);case 10:return m.yield(l.enableStandardFullMode(),11);case 11:return m.yield(l.enableIMUMode(),12);case 12:return m.yield(l.enableVibration(),13);case 13:module$contents$Blast$Ui_addToLog("Adding <code>hidinput</code> event listener","hid",g.productname),l.addEventListener("hidinput",k),l.eventListenerAttached=!0,m.jumpToEnd()}})};
module$contents$Blast$Interpreter_asyncApiFunctions.push(["readJoyConProperty",readJoyConProperty]);
Blockly.JavaScript.joycon_button_events=function(a){var b=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_NONE),c=Blockly.JavaScript.quote_(a.getFieldValue("button"));a=Blockly.JavaScript.quote_(Blockly.JavaScript.statementToCode(a,"statements"));Blockly.JavaScript.definitions_.eventHandlers=(Blockly.JavaScript.definitions_.eventHandlers||"")+("handleJoyConButtons("+b+", "+c+", "+a+");\n");return""};
var handleJoyConButtons=function(a,b,c,d){var f,h,g,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:if(!a)return module$contents$Blast$Interpreter_throwError("No Joy-Con block set."),d(),k.return();f=module$contents$Blast$Things_webHidDevices.get(a);if(!f)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the JoyCon via webHID"),d(),k.return();if(f.opened){k.jumpTo(2);break}k.setCatchFinallyBlocks(3);
return k.yield(f.open(),5);case 5:k.leaveTryBlock(2);break;case 3:k.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(1406!==f.vendorId||8198!==f.productId&&8199!==f.productId)return module$contents$Blast$Interpreter_throwError("The connected device is not a Joy-Con."),d(),k.return();8198===f.productId?h=new JoyConLeft(f):8199===f.productId&&(h=new JoyConRight(f));return k.yield(h.open(),6);case 6:return k.yield(h.enableStandardFullMode(),
7);case 7:return k.yield(h.enableIMUMode(),8);case 8:g=!1;l=function(m){var n,p,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){n=m.detail;if(!n||!n.actualOrientation)return r.return();module$contents$Blast$Ui_addToLog("Received <code>hidinput</code> event from Joy-Con: <code>"+JSON.stringify(n)+"</code>","hid",f.productName);n.buttonStatus[b]?g||(g=!0,module$contents$Blast$Interpreter_setInterrupted(!1),p=new Interpreter(""),p.stateStack[0].scope=module$contents$Blast$Interpreter_getInterpreter().globalScope,
p.appendCode(c),q=function(){try{p.step()?setTimeout(q,5):module$contents$Blast$Interpreter_setInterrupted(!1)}catch(t){module$contents$Blast$Interpreter_throwError("Error executing program:\n "+e),console.error(t)}},q()):g=!1;r.jumpToEnd()})};Blast.Interpreter.deviceEventHandlers.push({device:h,type:"hidinput",fn:l});if(h.eventListenerAttached){k.jumpTo(0);break}return k.yield(h.open(),10);case 10:return k.yield(h.enableStandardFullMode(),11);case 11:return k.yield(h.enableIMUMode(),12);case 12:return k.yield(h.enableVibration(),
13);case 13:module$contents$Blast$Ui_addToLog("Adding <code>hidinput</code> event listener","hid",f.productName),h.addEventListener("hidinput",l),h.eventListenerAttached=!0,k.jumpToEnd()}})};module$contents$Blast$Interpreter_apiFunctions.push(["handleJoyConButtons",handleJoyConButtons]);Blockly.Blocks.blinkstick_set_colors={init:function(){this.appendValueInput("COLOUR").setCheck("Colour").appendField("write colour property");this.appendValueInput("index").setCheck("Number").appendField("of LED #");this.appendValueInput("thing").setCheck("Thing").appendField("to BlinkStick");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("Set the color properties of a tulogic BlinkStick.");this.setHelpUrl("https://www.blinkstick.com/")}};
var BLINKSTICK_SET_COLORS_XML='\n<block type="blinkstick_set_colors">\n  <value name="index">\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n  </value>\n  <value name="COLOUR">\n    <block type="colour_picker">\n      <field name="COLOUR">#00ff00</field>\n    </block>\n  </value>\n</block>\n';module$contents$Blast$Toolbox_addBlock("blinkstick_set_colors","Properties",BLINKSTICK_SET_COLORS_XML);Blockly.JavaScript.blinkstick_set_colors=function(a){var b=Blockly.JavaScript.valueToCode(a,"COLOUR",Blockly.JavaScript.ORDER_ATOMIC)||Blockly.JavaScript.quote_("#000000"),c=Blockly.JavaScript.valueToCode(a,"index",Blockly.JavaScript.ORDER_ATOMIC)||"0";return"blinkstickSetColors("+(Blockly.JavaScript.valueToCode(a,"thing",Blockly.JavaScript.ORDER_ATOMIC)||"''")+", "+c+", "+b+")\n;"};
var blinkstickSetColors=function(a,b,c,d){var f,h,g,l,k,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:if(0>b||7<b)return module$contents$Blast$Interpreter_throwError("BlinkStick index must be between 0 and 7."),d(),n.return();if(!a)return module$contents$Blast$Interpreter_throwError("No BlinkStick block set."),d(),n.return();f=module$contents$Blast$Things_webHidDevices.get(a);if(!f)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the Blinkstick via webHID."),
d(),n.return();if(f.opened){n.jumpTo(2);break}n.setCatchFinallyBlocks(3);return n.yield(f.open(),5);case 5:n.leaveTryBlock(2);break;case 3:n.enterCatchBlock(),module$contents$Blast$Interpreter_throwError("Failed to open device, your browser or OS probably doesn't support webHID.");case 2:if(8352!==f.vendorId||16869!==f.productId)return module$contents$Blast$Interpreter_throwError("The connected device is not a BlinkStick."),d(),n.return();h=parseInt(c.substring(1,3),16);g=parseInt(c.substring(3,5),
16);l=parseInt(c.substring(5,7),16);k=Int8Array.from([5,b,h,g,l]);m=function(p){var q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){if(1==r.nextAddress)return r.setCatchFinallyBlocks(2),module$contents$Blast$Ui_addToLog("Invoke <code>sendFeatureReport</code> with value <code>"+k+"</code>","hid",f.productName),r.yield(f.sendFeatureReport(5,k),4);if(2!=r.nextAddress)return module$contents$Blast$Ui_addToLog("Finished <code>sendFeatureReport</code> with value <code>"+k+"</code>","hid",
f.productName),r.leaveTryBlock(0);q=r.enterCatchBlock();return 0<p?r.yield(m(--p),0):(console.error(q),module$contents$Blast$Interpreter_throwError("Failed to set BlinkStick colors, please check its connection."),r.jumpTo(0))})};return n.yield(m(5),6);case 6:d(),n.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["blinkstickSetColors",blinkstickSetColors]);Blockly.Blocks.mirobot_pickup={init:function(){this.appendDummyInput().appendField("robot-arm, pick up").appendField(new Blockly.FieldDropdown([["blue","BLUE"],["red","RED"],["yellow","YELLOW"],["green","GREEN"]]),"box").appendField("box");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("Invokes pick-up action for the selected box.");this.setHelpUrl("")}};Blockly.JavaScript.mirobot_pickup=function(a){return"mirobotPickUpBox("+Blockly.JavaScript.quote_(a.getFieldValue("box").toLowerCase())+");\n"};
var mirobotPickUp=function(a,b){var c,d,f,h,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return c="https://bot.rapidthings.eu/thing/action/grab_"+a.toLowerCase(),d={"Content-Type":"application/json",Accept:"application/json"},f={method:"POST",headers:new Headers(d)},l.setCatchFinallyBlocks(2),l.yield(fetch(c,f),4);if(2!=l.nextAddress){h=l.yieldResult;if(!h.ok)return module$contents$Blast$Interpreter_throwError("Failed to get "+c+", Error: "+h.status+" "+h.statusText),
l.return();b(h.status);return l.leaveTryBlock(0)}g=l.enterCatchBlock();module$contents$Blast$Interpreter_throwError("Failed to get "+c+", Error: "+g);l.jumpToEnd()})};Blockly.Blocks.text_to_speech={init:function(){this.appendValueInput("text").appendField("Text to Speech").setCheck("String");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(0);this.setTooltip("");this.setHelpUrl("")}};module$contents$Blast$Toolbox_addBlock("text_to_speech","actions");
Blockly.Blocks.web_speech={init:function(){this.appendDummyInput().appendField("speech to text");this.setOutput(!0,"String");this.setColour(0);this.setTooltip("outputs speech command from microphone as a string");this.setHelpUrl("");this.firstTime=!0;this.recognition=null},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,"webkitSpeechRecognition"in window?this.recognition=new webkitSpeechRecognition:(Blockly.alert('Web Speech API is not supported by this browser.\n        Upgrade to <a href="//www.google.com/chrome">Chrome</a>\n        version 25 or later.'),
this.dispose()))}};module$contents$Blast$Toolbox_addBlock("web_speech","actions");Blockly.JavaScript.text_to_speech=function(a){return"textToSpeech("+Blockly.JavaScript.valueToCode(a,"text",Blockly.JavaScript.ORDER_ATOMIC)+");\n"};Blockly.JavaScript.web_speech=function(a){return["webSpeech('"+a.id+"')",Blockly.JavaScript.ORDER_NONE]};
var webSpeech=function(a,b){var c,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){c=module$contents$Blast$Interpreter_getWorkspace().getBlockById(a);d=c.recognition;d.continuous=!1;d.lang="en-US";f="";d.onresult=function(g){for(var l=g.resultIndex;l<g.results.length;++l)g.results[l].isFinal&&(f+=g.results[l][0].transcript)};d.onend=function(){b(f)};d.start();h.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["webSpeech",webSpeech]);
var textToSpeech=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return c=new SpeechSynthesisUtterance,c.text=a,window.speechSynthesis.speak(c),d.yield(new Promise(function(f){c.onend=f}),2);b();d.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["textToSpeech",textToSpeech]);Blockly.Blocks.read_ruuvi_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read").appendField(new Blockly.FieldDropdown([["temperature","temperature"],["humidity","humidity"],["pressure","pressure"],["acceleration X","accelerationX"],["acceleration Y","accelerationY"],["acceleration Z","accelerationZ"],["battery voltage","batteryVoltage"],["txPower","txPower"],["movement counter","movementCounter"],["measurement sequence number","measurementSequenceNumber"]]),
"measurement").appendField("property of RuuviTag");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads a property of a Ruuvi Tag.");this.setHelpUrl("");this.firstTime=!0},onchange:function(){!this.isInFlyout&&this.firstTime&&this.rendered&&(this.firstTime=!1,navigator.bluetooth||(Blockly.alert("Webbluetooth is not supported by this browser.\n\n        Upgrade to Chrome version 85 or later."),this.dispose()))}};
module$contents$Blast$Toolbox_addBlock("read_ruuvi_property","Properties");Blast.Bluetooth.scanBlocks.push("read_ruuvi_property");Blockly.JavaScript.read_ruuvi_property=function(a){var b=Blockly.JavaScript.quote_(a.getFieldValue("measurement"));a=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC);return["getRuuviProperty("+b+", "+a+")",Blockly.JavaScript.ORDER_NONE]};
var getRuuviProperty=function(a,b,c){var d,f,h,g,l,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress)return d=function(n){var p={},q=n[0]&255,r=n[1]<<8|n[2]&255;32767<r&&(r-=65535);var t=((n[3]&255)<<8|n[4]&255)/400,v=((n[5]&255)<<8|n[6]&255)+5E4,w=(n[7]<<8|n[8]&255)/1E3,u=(n[9]<<8|n[10]&255)/1E3,y=(n[11]<<8|n[12]&255)/1E3,x=(n[13]&255)<<8|n[14]&255,z=n[15]&255;n=(n[16]&255)<<8|n[17]&255;p.destination_endpoint=q;p.temperature=r/200;p.humidity=t;p.pressure=v;p.accelerationX=
w;p.accelerationY=u;p.accelerationZ=y;p.batteryVoltage=(x>>>5)/1E3+1.6;p.txPower=2*(x&31)-40;p.movementCounter=z;p.measurementSequenceNumber=n;return p},f=function(n){if(30>n){var p=Blast.Bluetooth.LEScanResults[b];if(p){p=$jscomp.makeIterator(p);for(var q=p.next();!q.done;q=p.next())if((q=q.value.manufacturerData.get(1177))&&5==q.getUint8(0))return q}return new Promise(function(r){setTimeout(function(){r(f(n+1))},1E3)})}},Blast.Bluetooth.startLEScan(b),m.yield(f(0),2);(h=m.yieldResult)||module$contents$Blast$Interpreter_throwError("Timed out. No BLE advertising data found for "+
b);g=[];for(l=0;l<h.byteLength;l++)g.push("0x"+("00"+h.getUint8(l).toString(16)).slice(-2));k=d(g);c(k[a]);m.jumpToEnd()})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["getRuuviProperty",getRuuviProperty]);Blockly.Blocks.streamdeck_button_event={init:function(){var a=this;this.appendValueInput("id").setCheck("Thing").appendField("Stream Deck Mini");this.appendDummyInput().appendField("on button").appendField(new Blockly.FieldDropdown([["up","up"],["down","down"]]),"upDown");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button1")}),"button1").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,
"button2")}),"button2").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button3")}),"button3");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button4")}),"button4").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,"button5")}),"button5").appendField(new Blockly.FieldCheckbox("FALSE",function(b){return a.uncheckAllOtherCheckboxes(b,
"button6")}),"button6");this.appendDummyInput().appendField("do");this.appendStatementInput("statements").setCheck(null);this.setColour(180);this.setTooltip("");this.setHelpUrl("");this.requested=!1;this.keyState=Array(6).fill(!1)},uncheckAllOtherCheckboxes:function(a,b){if("TRUE"===a)for(a=1;6>=a;a++)"button"+a!=b&&this.setFieldValue("FALSE","button"+a)},addEvent:function(){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){module$contents$Blast$Interpreter_eventsInWorkspace.push(a.id);
module$contents$Blast$Interpreter_getWorkspace().addChangeListener(function(c){return a.onDispose(c)});b.jumpToEnd()})},onchange:function(){this.isInFlyout||this.requested||!this.rendered||this.addEvent()},onDispose:function(a){a.type===Blockly.Events.BLOCK_DELETE&&a.type===Blockly.Events.BLOCK_DELETE&&-1!==a.ids.indexOf(this.id)&&this.removeFromEvents()},removeFromEvents:function(){var a=module$contents$Blast$Interpreter_eventsInWorkspace.indexOf(this.id);-1!==a&&module$contents$Blast$Interpreter_eventsInWorkspace.splice(a,
1)}};module$contents$Blast$Toolbox_addBlock("streamdeck_button_event","States and Events");
Blockly.Blocks.streamdeck_color_buttons={init:function(){this.appendValueInput("color").setCheck("Colour").appendField("write color");this.appendDummyInput().appendField("to display property of button(s)");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE"),"button1").appendField(new Blockly.FieldCheckbox("FALSE"),"button2").appendField(new Blockly.FieldCheckbox("FALSE"),"button3");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE"),
"button4").appendField(new Blockly.FieldCheckbox("FALSE"),"button5").appendField(new Blockly.FieldCheckbox("FALSE"),"button6");this.appendValueInput("id").setCheck("Thing").appendField("of Stream Deck Mini");this.setColour(255);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setTooltip("");this.setHelpUrl("");this.requested=!1;this.keyState=Array(6).fill(!1)}};var STREAMDECK_COLOR_BUTTONS_XML='\n<block type="streamdeck_color_buttons">\n  <value name="color">\n    <block type="colour_picker">\n      <field name="COLOUR">#ffff00</field>\n    </block>\n  </value>\n</block>\n';
module$contents$Blast$Toolbox_addBlock("streamdeck_color_buttons","Properties",STREAMDECK_COLOR_BUTTONS_XML);
Blockly.Blocks.streamdeck_write_on_buttons={init:function(){this.appendValueInput("value").setCheck(["String","Number","Boolean"]).appendField("write Number/String/Boolean");this.appendDummyInput().appendField("to display property of button(s)");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE"),"button1").appendField(new Blockly.FieldCheckbox("FALSE"),"button2").appendField(new Blockly.FieldCheckbox("FALSE"),"button3");this.appendDummyInput().setAlign(Blockly.ALIGN_CENTRE).appendField(new Blockly.FieldCheckbox("FALSE"),
"button4").appendField(new Blockly.FieldCheckbox("FALSE"),"button5").appendField(new Blockly.FieldCheckbox("FALSE"),"button6");this.appendValueInput("id").setCheck("Thing").appendField("of Stream Deck Mini");this.setColour(255);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setTooltip("");this.setHelpUrl("");this.requested=!1;this.keyState=Array(6).fill(!1)}};module$contents$Blast$Toolbox_addBlock("streamdeck_write_on_buttons","Properties");
Blockly.Blocks.streamdeck_set_brightness={init:function(){this.appendValueInput("value").setCheck("Number").appendField("write brightness property");this.appendValueInput("id").setCheck("Thing").appendField("to Stream Deck Mini");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(255);this.setTooltip("");this.setHelpUrl("")}};var STREAMDECK_SET_BRIGHTNESS_XML='\n<block type="streamdeck_set_brightness">\n  <value name="value">\n    <block type="math_number">\n      <field name="NUM">100</field>\n    </block>\n  </value>\n</block>\n';
module$contents$Blast$Toolbox_addBlock("streamdeck_set_brightness","Properties",STREAMDECK_SET_BRIGHTNESS_XML);Blockly.JavaScript.streamdeck_button_event=function(a){var b="TRUE"==a.getFieldValue("button1")?1:0,c="TRUE"==a.getFieldValue("button2")?1:0,d="TRUE"==a.getFieldValue("button3")?1:0,f="TRUE"==a.getFieldValue("button4")?1:0,h="TRUE"==a.getFieldValue("button5")?1:0,g="TRUE"==a.getFieldValue("button6")?1:0,l=Blockly.JavaScript.quote_(a.getFieldValue("upDown")),k=Blockly.JavaScript.valueToCode(a,"id",Blockly.JavaScript.ORDER_NONE)||null;b=Blockly.JavaScript.quote_(""+b+c+d+f+h+g);a=Blockly.JavaScript.quote_(Blockly.JavaScript.statementToCode(a,
"statements"));Blockly.JavaScript.definitions_.eventHandlers=(Blockly.JavaScript.definitions_.eventHandlers||"")+("handleStreamdeck("+k+", "+b+", "+l+", "+a+");\n");return""};
Blockly.JavaScript.streamdeck_color_buttons=function(a){var b="TRUE"==a.getFieldValue("button1")?1:0,c="TRUE"==a.getFieldValue("button2")?1:0,d="TRUE"==a.getFieldValue("button3")?1:0,f="TRUE"==a.getFieldValue("button4")?1:0,h="TRUE"==a.getFieldValue("button5")?1:0,g="TRUE"==a.getFieldValue("button6")?1:0,l=Blockly.JavaScript.valueToCode(a,"color",Blockly.JavaScript.ORDER_NONE)||Blockly.JavaScript.quote_("#000000");a=Blockly.JavaScript.valueToCode(a,"id",Blockly.JavaScript.ORDER_NONE)||null;b=Blockly.JavaScript.quote_(""+
b+c+d+f+h+g);return"streamdeckColorButtons("+a+", "+b+", "+l+");\n"};
var handleStreamdeck=function(a,b,c,d){var f,h,g,l,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){switch(m.nextAddress){case 1:if(null===a)return module$contents$Blast$Interpreter_throwError("No streamdeck block set."),m.return();f=module$contents$Blast$Things_webHidDevices.get(a);console.log(f);if(!f)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the Streamdeck via webHID"),m.return();m.setCatchFinallyBlocks(2);
return m.yield(StreamDeck.openDevice(f),4);case 4:h=m.yieldResult;m.leaveTryBlock(3);break;case 2:g=m.enterCatchBlock();if("InvalidStateError"!=g.name)return module$contents$Blast$Interpreter_throwError(g),m.return();f.close();return m.yield(StreamDeck.openDevice(f),6);case 6:h=m.yieldResult;case 3:for(k=0;k<b.length;k++)if("1"===b.charAt(k)){l=k;break}if(void 0===l)return m.return();h.on(c,function(n){module$contents$Blast$Ui_addToLog("Received <code>"+c+"</code> event on button <code>"+n+"</code>",
"hid",f.productName);if(n===l){module$contents$Blast$Interpreter_setInterrupted(!0);var p=new Interpreter("");p.stateStack[0].scope=module$contents$Blast$Interpreter_getInterpreter().globalScope;p.appendCode(d);var q=function(){try{p.step()?setTimeout(q,5):module$contents$Blast$Interpreter_setInterrupted(!1)}catch(r){module$contents$Blast$Interpreter_throwError("Error executing program:\n "+e),console.error(r)}};q()}});module$contents$Blast$Interpreter_cleanUpFunctions.push(function(){module$contents$Blast$Ui_addToLog("Removing all listeners",
"hid",f.productName);h.close();h.removeAllListeners()});m.jumpToEnd()}})};module$contents$Blast$Interpreter_apiFunctions.push(["handleStreamdeck",handleStreamdeck]);
var streamdeckColorButtons=function(a,b,c,d){var f,h,g,l,k,m,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:if(null===a)return module$contents$Blast$Interpreter_throwError("No streamdeck block set."),d(),p.return();f=module$contents$Blast$Things_webHidDevices.get(a);if(!f)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the Streamdeck via webHID"),d(),p.return();p.setCatchFinallyBlocks(2);
return p.yield(StreamDeck.openDevice(f),4);case 4:h=p.yieldResult;p.leaveTryBlock(3);break;case 2:g=p.enterCatchBlock();if("InvalidStateError"!=g.name)return module$contents$Blast$Interpreter_throwError(g),d(),p.return();f.close();return p.yield(StreamDeck.openDevice(f),6);case 6:h=p.yieldResult;case 3:l=parseInt(c.substring(1,3),16),k=parseInt(c.substring(3,5),16),m=parseInt(c.substring(5,7),16),n=0;case 7:if(!(n<b.length)){p.jumpTo(9);break}if("1"!==b.charAt(n)){p.jumpTo(8);break}module$contents$Blast$Ui_addToLog("Invoke <code>fillKeyColor</code> with value <code>"+
[n,l,k,m].toString()+"</code>","hid",f.productName);return p.yield(h.fillKeyColor(n,l,k,m),11);case 11:module$contents$Blast$Ui_addToLog("Finished <code>fillKeyColor</code>","hid",f.productName);case 8:n++;p.jumpTo(7);break;case 9:d(),p.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["streamdeckColorButtons",streamdeckColorButtons]);
Blockly.JavaScript.streamdeck_write_on_buttons=function(a){var b="TRUE"==a.getFieldValue("button1")?1:0,c="TRUE"==a.getFieldValue("button2")?1:0,d="TRUE"==a.getFieldValue("button3")?1:0,f="TRUE"==a.getFieldValue("button4")?1:0,h="TRUE"==a.getFieldValue("button5")?1:0,g="TRUE"==a.getFieldValue("button6")?1:0,l=Blockly.JavaScript.valueToCode(a,"value",Blockly.JavaScript.ORDER_NONE)||Blockly.JavaScript.quote_("");a=Blockly.JavaScript.valueToCode(a,"id",Blockly.JavaScript.ORDER_NONE)||null;b=Blockly.JavaScript.quote_(""+
b+c+d+f+h+g);return"streamdeckWriteOnButtons("+a+", "+b+", "+l+");\n"};
var streamdeckWriteOnButtons=function(a,b,c,d){var f,h,g,l,k,m,n,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){switch(q.nextAddress){case 1:if(null===a)return module$contents$Blast$Interpreter_throwError("No streamdeck block set."),d(),q.return();f=module$contents$Blast$Things_webHidDevices.get(a);if(!f)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the Streamdeck via webHID"),d(),q.return();q.setCatchFinallyBlocks(2);
return q.yield(StreamDeck.openDevice(f),4);case 4:h=q.yieldResult;q.leaveTryBlock(3);break;case 2:g=q.enterCatchBlock();if("InvalidStateError"!=g.name)return module$contents$Blast$Interpreter_throwError(g),d(),q.return();f.close();return q.yield(StreamDeck.openDevice(f),6);case 6:h=q.yieldResult;case 3:l=[];k=document.createElement("canvas");k.width=h.ICON_SIZE;k.height=h.ICON_SIZE;m=k.getContext("2d");m.save();m.clearRect(0,0,k.width,k.height);m.font=.8*k.height+"px Arial";m.strokeStyle="blue";m.lineWidth=
1;m.strokeText(c.toString(),8,60,.8*k.width);m.fillStyle="white";m.fillText(c.toString(),8,60,.8*k.width);n=m.getImageData(0,0,k.width,k.height);for(p=0;p<b.length;p++)"1"===b.charAt(p)&&(module$contents$Blast$Ui_addToLog("Invoke <code>fillKeyImageData</code> with value <code>"+[p,n].toString()+"</code>","hid",f.productName),l.push(h.fillKeyBuffer(p,buffer.Buffer.from(n.data),{format:"rgba"})),module$contents$Blast$Ui_addToLog("Finished <code>fillKeyImageData</code>","hid",f.productName));m.restore();
return q.yield(Promise.all(l),7);case 7:d(),q.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["streamdeckWriteOnButtons",streamdeckWriteOnButtons]);Blockly.JavaScript.streamdeck_set_brightness=function(a){var b=Blockly.JavaScript.valueToCode(a,"value",Blockly.JavaScript.ORDER_NONE)||Blockly.JavaScript.quote_("100");return"streamdeckSetBrightness("+(Blockly.JavaScript.valueToCode(a,"id",Blockly.JavaScript.ORDER_NONE)||null)+", "+b+");\n"};
var streamdeckSetBrightness=function(a,b,c){var d,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:if(null===a)return module$contents$Blast$Interpreter_throwError("No streamdeck block set."),c(),g.return();if(1>b||100<b)return module$contents$Blast$Interpreter_throwError("Brightness must be between 1 and 100."),c(),g.return();d=module$contents$Blast$Things_webHidDevices.get(a);if(!d)return module$contents$Blast$Interpreter_throwError("Connected device is not a HID device.\nMake sure you are connecting the Streamdeck via webHID"),
c(),g.return();g.setCatchFinallyBlocks(2);return g.yield(StreamDeck.openDevice(d),4);case 4:f=g.yieldResult;g.leaveTryBlock(3);break;case 2:h=g.enterCatchBlock();if("InvalidStateError"!=h.name)return module$contents$Blast$Interpreter_throwError(h),c(),g.return();d.close();return g.yield(StreamDeck.openDevice(d),6);case 6:f=g.yieldResult;case 3:return module$contents$Blast$Ui_addToLog("Invoke <code>setBrightness</code> with value <code>"+b+"</code>","hid",d.productName),g.yield(f.setBrightness(b),
7);case 7:module$contents$Blast$Ui_addToLog("Finished <code>setBrightness</code>","hid",d.productName),c(),g.jumpToEnd()}})};module$contents$Blast$Interpreter_asyncApiFunctions.push(["streamdeckSetBrightness",streamdeckSetBrightness]);Blockly.Blocks.read_mijia_property={init:function(){this.appendValueInput("Thing").setCheck("Thing").appendField("read").appendField(new Blockly.FieldDropdown([["temperature","temperature"],["humidity","humidity"]]),"measurement").appendField("property of Xiaomi Mijia");this.setOutput(!0,["String","Number"]);this.setColour(255);this.setTooltip("Reads the selected property of a Xiaomi Mijia Thermometer.");this.setHelpUrl("")}};module$contents$Blast$Toolbox_addBlock("read_mijia_property","Properties");Blockly.JavaScript.read_mijia_property=function(a){var b=Blockly.JavaScript.quote_(a.getFieldValue("measurement"));a=Blockly.JavaScript.valueToCode(a,"Thing",Blockly.JavaScript.ORDER_ATOMIC);return["readMijiaProperty("+b+", "+a+")",Blockly.JavaScript.ORDER_NONE]};var XiaomiServiceUUID="ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6";Blast.Bluetooth.optionalServices.push(XiaomiServiceUUID);
var readMijiaProperty=function(a,b,c){b?Blast.Bluetooth.gatt_subscribe(b,XiaomiServiceUUID,"ebe0ccc1-7a0a-4b0c-8a1a-6ff2997da3a6",function(d){var f=d.target.value,h=f.getUint8(1)&128;d=(f.getUint8(1)&127)<<8|f.getUint8(0);h&&(d-=32767);d/=100;f=f.getUint8(2);"temperature"===a?c(d):"humidity"===a&&c(f)}):(module$contents$Blast$Interpreter_throwError("No Thermometer is set."),c())};module$contents$Blast$Interpreter_asyncApiFunctions.push(["readMijiaProperty",readMijiaProperty]);
